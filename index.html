<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="index : ">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>index</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/raisinpearl">View on GitHub</a>

          <h1 id="project_title">index</h1>
          <h2 id="project_tagline"></h2>

        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <p>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "<a href="http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd%22%3E">http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;</a>

</p>



<p>
&lt;meta name="copyright" content="
TiddlyWiki created by Jeremy Ruston, (jeremy [at] osmosoft [dot] com)</p>

<p>Copyright (c) Jeremy Ruston 2004-2007
Copyright (c) UnaMesa Association 2007-2012</p>

<p>Redistribution and use in source and binary forms, with or without modification,
are permitted provided that the following conditions are met:</p>

<p>Redistributions of source code must retain the above copyright notice, this
list of conditions and the following disclaimer.</p>

<p>Redistributions in binary form must reproduce the above copyright notice, this
list of conditions and the following disclaimer in the documentation and/or other
materials provided with the distribution.</p>

<p>Neither the name of the UnaMesa Association nor the names of its contributors may be
used to endorse or promote products derived from this software without specific
prior written permission.</p>

<p>THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS' AND ANY
EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT
SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH
DAMAGE.</p>

<p>" /&gt;</p>





<p>
</p>





<p></p>
迪伦 - 如果命运是条孤独的河流，谁会是你灵魂的摆渡者



#saveTest {display:none;}
#messageArea {display:none;}
#copyright {display:none;}
#storeArea {display:none;}
#storeArea div {padding:0.5em; margin:1em 0em 0em 0em; border-color:#fff #666 #444 #ddd; border-style:solid; border-width:2px; overflow:auto;}
#shadowArea {display:none;}
#javascriptWarning {width:100%; text-align:center; font-weight:bold; background-color:#dd1100; color:#fff; padding:1em 0em;}







<p>
</p>





<div id="copyright">
Welcome to TiddlyWiki created by Jeremy Ruston; Copyright © 2004-2007 Jeremy Ruston, Copyright © 2007-2011 UnaMesa Association
</div>



<div id="javascriptWarning">
This page requires JavaScript to function properly.<br><br>
If you do not use JavaScript you may still <a href="/tiddlers">browse
the content of this wiki</a>.
</div>



<div id="saveTest"></div>

<div id="backstageCloak"></div>

<div id="backstageButton"></div>

<div id="backstageArea"><div id="backstageToolbar"></div></div>

<div id="backstage">
    <div id="backstagePanel"></div>
</div>

<div id="contentWrapper"></div>

<div id="contentStash"></div>

<div id="shadowArea">
<div title="ColorPalette">
<pre>Background: #fff
Foreground: #000
PrimaryPale: #8cf
PrimaryLight: #18f
PrimaryMid: #04b
PrimaryDark: #014
SecondaryPale: #ffc
SecondaryLight: #fe8
SecondaryMid: #db4
SecondaryDark: #841
TertiaryPale: #eee
TertiaryLight: #ccc
TertiaryMid: #999
TertiaryDark: #666
Error: #f88
</pre>
</div>

<div title="EditTemplate">
<pre>&lt;!--{{{--&gt;
&lt;div class='toolbar' macro='toolbar [[ToolbarCommands::EditToolbar]]'&gt;&lt;/div&gt;
&lt;div class='title' macro='view title'&gt;&lt;/div&gt;
&lt;div class='editor' macro='edit title'&gt;&lt;/div&gt;
&lt;div macro='annotations'&gt;&lt;/div&gt;
&lt;div class='editor' macro='edit text'&gt;&lt;/div&gt;
&lt;div class='editor' macro='edit tags'&gt;&lt;/div&gt;&lt;div class='editorFooter'&gt;&lt;span macro='message views.editor.tagPrompt'&gt;&lt;/span&gt;&lt;span macro='tagChooser excludeLists'&gt;&lt;/span&gt;&lt;/div&gt;
&lt;!--}}}--&gt;
</pre>
</div>

<div title="GettingStarted">
<pre>To get started with this blank [[TiddlyWiki]], you'll need to modify the following tiddlers:
* [[SiteTitle]] &amp; [[SiteSubtitle]]: The title and subtitle of the site, as shown above (after saving, they will also appear in the browser title bar)
* [[MainMenu]]: The menu (usually on the left)
* [[DefaultTiddlers]]: Contains the names of the tiddlers that you want to appear when the TiddlyWiki is opened
You'll also need to enter your username for signing your edits: &lt;&lt;option txtUserName&gt;&gt;
</pre>
</div>

<div title="ImportTiddlers">
<pre>&lt;&lt;importTiddlers&gt;&gt;
</pre>
</div>

<div title="MarkupPreHead">
<pre>&lt;!--{{{--&gt;
&lt;link rel='alternate' type='application/rss+xml' title='RSS' href='index.xml' /&gt;
&lt;!--}}}--&gt;
</pre>
</div>

<div title="OptionsPanel">
<pre>These [[InterfaceOptions]] for customising [[TiddlyWiki]] are saved in your browser

Your username for signing your edits. Write it as a [[WikiWord]] (eg [[JoeBloggs]])

&lt;&lt;option txtUserName&gt;&gt;
&lt;&lt;option chkSaveBackups&gt;&gt; [[SaveBackups]]
&lt;&lt;option chkAutoSave&gt;&gt; [[AutoSave]]
&lt;&lt;option chkRegExpSearch&gt;&gt; [[RegExpSearch]]
&lt;&lt;option chkCaseSensitiveSearch&gt;&gt; [[CaseSensitiveSearch]]
&lt;&lt;option chkAnimate&gt;&gt; [[EnableAnimations]]

----
Also see [[AdvancedOptions]]
</pre>
</div>

<div title="PageTemplate">
<pre>&lt;!--{{{--&gt;
&lt;div class='header' role='banner' macro='gradient vert [[ColorPalette::PrimaryLight]] [[ColorPalette::PrimaryMid]]'&gt;
&lt;div class='headerShadow'&gt;
&lt;span class='siteTitle' refresh='content' tiddler='SiteTitle'&gt;&lt;/span&gt;&amp;nbsp;
&lt;span class='siteSubtitle' refresh='content' tiddler='SiteSubtitle'&gt;&lt;/span&gt;
&lt;/div&gt;
&lt;div class='headerForeground'&gt;
&lt;span class='siteTitle' refresh='content' tiddler='SiteTitle'&gt;&lt;/span&gt;&amp;nbsp;
&lt;span class='siteSubtitle' refresh='content' tiddler='SiteSubtitle'&gt;&lt;/span&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id='mainMenu' role='navigation' refresh='content' tiddler='MainMenu'&gt;&lt;/div&gt;
&lt;div id='sidebar'&gt;
&lt;div id='sidebarOptions' role='navigation' refresh='content' tiddler='SideBarOptions'&gt;&lt;/div&gt;
&lt;div id='sidebarTabs' role='complementary' refresh='content' force='true' tiddler='SideBarTabs'&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div id='displayArea' role='main'&gt;
&lt;div id='messageArea'&gt;&lt;/div&gt;
&lt;div id='tiddlerDisplay'&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!--}}}--&gt;
</pre>
</div>

<div title="StyleSheetColors">
<pre>/*{{{*/
body {background:[[ColorPalette::Background]]; color:[[ColorPalette::Foreground]];}

a {color:[[ColorPalette::PrimaryMid]];}
a:hover {background-color:[[ColorPalette::PrimaryMid]]; color:[[ColorPalette::Background]];}
a img {border:0;}

h1,h2,h3,h4,h5,h6 {color:[[ColorPalette::SecondaryDark]]; background:transparent;}
h1 {border-bottom:2px solid [[ColorPalette::TertiaryLight]];}
h2,h3 {border-bottom:1px solid [[ColorPalette::TertiaryLight]];}

.button {color:[[ColorPalette::PrimaryDark]]; border:1px solid [[ColorPalette::Background]];}
.button:hover {color:[[ColorPalette::PrimaryDark]]; background:[[ColorPalette::SecondaryLight]]; border-color:[[ColorPalette::SecondaryMid]];}
.button:active {color:[[ColorPalette::Background]]; background:[[ColorPalette::SecondaryMid]]; border:1px solid [[ColorPalette::SecondaryDark]];}

.header {background:[[ColorPalette::PrimaryMid]];}
.headerShadow {color:[[ColorPalette::Foreground]];}
.headerShadow a {font-weight:normal; color:[[ColorPalette::Foreground]];}
.headerForeground {color:[[ColorPalette::Background]];}
.headerForeground a {font-weight:normal; color:[[ColorPalette::PrimaryPale]];}

.tabSelected {color:[[ColorPalette::PrimaryDark]];
    background:[[ColorPalette::TertiaryPale]];
    border-left:1px solid [[ColorPalette::TertiaryLight]];
    border-top:1px solid [[ColorPalette::TertiaryLight]];
    border-right:1px solid [[ColorPalette::TertiaryLight]];
}
.tabUnselected {color:[[ColorPalette::Background]]; background:[[ColorPalette::TertiaryMid]];}
.tabContents {color:[[ColorPalette::PrimaryDark]]; background:[[ColorPalette::TertiaryPale]]; border:1px solid [[ColorPalette::TertiaryLight]];}
.tabContents .button {border:0;}

#sidebar {}
#sidebarOptions input {border:1px solid [[ColorPalette::PrimaryMid]];}
#sidebarOptions .sliderPanel {background:[[ColorPalette::PrimaryPale]];}
#sidebarOptions .sliderPanel a {border:none;color:[[ColorPalette::PrimaryMid]];}
#sidebarOptions .sliderPanel a:hover {color:[[ColorPalette::Background]]; background:[[ColorPalette::PrimaryMid]];}
#sidebarOptions .sliderPanel a:active {color:[[ColorPalette::PrimaryMid]]; background:[[ColorPalette::Background]];}

.wizard {background:[[ColorPalette::PrimaryPale]]; border:1px solid [[ColorPalette::PrimaryMid]];}
.wizard h1 {color:[[ColorPalette::PrimaryDark]]; border:none;}
.wizard h2 {color:[[ColorPalette::Foreground]]; border:none;}
.wizardStep {background:[[ColorPalette::Background]]; color:[[ColorPalette::Foreground]];
    border:1px solid [[ColorPalette::PrimaryMid]];}
.wizardStep.wizardStepDone {background:[[ColorPalette::TertiaryLight]];}
.wizardFooter {background:[[ColorPalette::PrimaryPale]];}
.wizardFooter .status {background:[[ColorPalette::PrimaryDark]]; color:[[ColorPalette::Background]];}
.wizard .button {color:[[ColorPalette::Foreground]]; background:[[ColorPalette::SecondaryLight]]; border: 1px solid;
    border-color:[[ColorPalette::SecondaryPale]] [[ColorPalette::SecondaryDark]] [[ColorPalette::SecondaryDark]] [[ColorPalette::SecondaryPale]];}
.wizard .button:hover {color:[[ColorPalette::Foreground]]; background:[[ColorPalette::Background]];}
.wizard .button:active {color:[[ColorPalette::Background]]; background:[[ColorPalette::Foreground]]; border: 1px solid;
    border-color:[[ColorPalette::PrimaryDark]] [[ColorPalette::PrimaryPale]] [[ColorPalette::PrimaryPale]] [[ColorPalette::PrimaryDark]];}

.wizard .notChanged {background:transparent;}
.wizard .changedLocally {background:#80ff80;}
.wizard .changedServer {background:#8080ff;}
.wizard .changedBoth {background:#ff8080;}
.wizard .notFound {background:#ffff80;}
.wizard .putToServer {background:#ff80ff;}
.wizard .gotFromServer {background:#80ffff;}

#messageArea {border:1px solid [[ColorPalette::SecondaryMid]]; background:[[ColorPalette::SecondaryLight]]; color:[[ColorPalette::Foreground]];}
#messageArea .button {color:[[ColorPalette::PrimaryMid]]; background:[[ColorPalette::SecondaryPale]]; border:none;}

.popupTiddler {background:[[ColorPalette::TertiaryPale]]; border:2px solid [[ColorPalette::TertiaryMid]];}

.popup {background:[[ColorPalette::TertiaryPale]]; color:[[ColorPalette::TertiaryDark]]; border-left:1px solid [[ColorPalette::TertiaryMid]]; border-top:1px solid [[ColorPalette::TertiaryMid]]; border-right:2px solid [[ColorPalette::TertiaryDark]]; border-bottom:2px solid [[ColorPalette::TertiaryDark]];}
.popup hr {color:[[ColorPalette::PrimaryDark]]; background:[[ColorPalette::PrimaryDark]]; border-bottom:1px;}
.popup li.disabled {color:[[ColorPalette::TertiaryMid]];}
.popup li a, .popup li a:visited {color:[[ColorPalette::Foreground]]; border: none;}
.popup li a:hover {background:[[ColorPalette::SecondaryLight]]; color:[[ColorPalette::Foreground]]; border: none;}
.popup li a:active {background:[[ColorPalette::SecondaryPale]]; color:[[ColorPalette::Foreground]]; border: none;}
.popupHighlight {background:[[ColorPalette::Background]]; color:[[ColorPalette::Foreground]];}
.listBreak div {border-bottom:1px solid [[ColorPalette::TertiaryDark]];}

.tiddler .defaultCommand {font-weight:bold;}

.shadow .title {color:[[ColorPalette::TertiaryDark]];}

.title {color:[[ColorPalette::SecondaryDark]];}
.subtitle {color:[[ColorPalette::TertiaryDark]];}

.toolbar {color:[[ColorPalette::PrimaryMid]];}
.toolbar a {color:[[ColorPalette::TertiaryLight]];}
.selected .toolbar a {color:[[ColorPalette::TertiaryMid]];}
.selected .toolbar a:hover {color:[[ColorPalette::Foreground]];}

.tagging, .tagged {border:1px solid [[ColorPalette::TertiaryPale]]; background-color:[[ColorPalette::TertiaryPale]];}
.selected .tagging, .selected .tagged {background-color:[[ColorPalette::TertiaryLight]]; border:1px solid [[ColorPalette::TertiaryMid]];}
.tagging .listTitle, .tagged .listTitle {color:[[ColorPalette::PrimaryDark]];}
.tagging .button, .tagged .button {border:none;}

.footer {color:[[ColorPalette::TertiaryLight]];}
.selected .footer {color:[[ColorPalette::TertiaryMid]];}

.error, .errorButton {color:[[ColorPalette::Foreground]]; background:[[ColorPalette::Error]];}
.warning {color:[[ColorPalette::Foreground]]; background:[[ColorPalette::SecondaryPale]];}
.lowlight {background:[[ColorPalette::TertiaryLight]];}

.zoomer {background:none; color:[[ColorPalette::TertiaryMid]]; border:3px solid [[ColorPalette::TertiaryMid]];}

.imageLink, #displayArea .imageLink {background:transparent;}

.annotation {background:[[ColorPalette::SecondaryLight]]; color:[[ColorPalette::Foreground]]; border:2px solid [[ColorPalette::SecondaryMid]];}

.viewer .listTitle {list-style-type:none; margin-left:-2em;}
.viewer .button {border:1px solid [[ColorPalette::SecondaryMid]];}
.viewer blockquote {border-left:3px solid [[ColorPalette::TertiaryDark]];}

.viewer table, table.twtable {border:2px solid [[ColorPalette::TertiaryDark]];}
.viewer th, .viewer thead td, .twtable th, .twtable thead td {background:[[ColorPalette::SecondaryMid]]; border:1px solid [[ColorPalette::TertiaryDark]]; color:[[ColorPalette::Background]];}
.viewer td, .viewer tr, .twtable td, .twtable tr {border:1px solid [[ColorPalette::TertiaryDark]];}

.viewer pre {border:1px solid [[ColorPalette::SecondaryLight]]; background:[[ColorPalette::SecondaryPale]];}
.viewer code {color:[[ColorPalette::SecondaryDark]];}
.viewer hr {border:0; border-top:dashed 1px [[ColorPalette::TertiaryDark]]; color:[[ColorPalette::TertiaryDark]];}

.highlight, .marked {background:[[ColorPalette::SecondaryLight]];}

.editor input {border:1px solid [[ColorPalette::PrimaryMid]];}
.editor textarea {border:1px solid [[ColorPalette::PrimaryMid]]; width:100%;}
.editorFooter {color:[[ColorPalette::TertiaryMid]];}
.readOnly {background:[[ColorPalette::TertiaryPale]];}

#backstageArea {background:[[ColorPalette::Foreground]]; color:[[ColorPalette::TertiaryMid]];}
#backstageArea a {background:[[ColorPalette::Foreground]]; color:[[ColorPalette::Background]]; border:none;}
#backstageArea a:hover {background:[[ColorPalette::SecondaryLight]]; color:[[ColorPalette::Foreground]]; }
#backstageArea a.backstageSelTab {background:[[ColorPalette::Background]]; color:[[ColorPalette::Foreground]];}
#backstageButton a {background:none; color:[[ColorPalette::Background]]; border:none;}
#backstageButton a:hover {background:[[ColorPalette::Foreground]]; color:[[ColorPalette::Background]]; border:none;}
#backstagePanel {background:[[ColorPalette::Background]]; border-color: [[ColorPalette::Background]] [[ColorPalette::TertiaryDark]] [[ColorPalette::TertiaryDark]] [[ColorPalette::TertiaryDark]];}
.backstagePanelFooter .button {border:none; color:[[ColorPalette::Background]];}
.backstagePanelFooter .button:hover {color:[[ColorPalette::Foreground]];}
#backstageCloak {background:[[ColorPalette::Foreground]]; opacity:0.6; filter:alpha(opacity=60);}
/*}}}*/
</pre>
</div>

<div title="StyleSheetLayout">
<pre>/*{{{*/
* html .tiddler {height:1%;}

body {font-size:.75em; font-family:arial,helvetica; margin:0; padding:0;}

h1,h2,h3,h4,h5,h6 {font-weight:bold; text-decoration:none;}
h1,h2,h3 {padding-bottom:1px; margin-top:1.2em;margin-bottom:0.3em;}
h4,h5,h6 {margin-top:1em;}
h1 {font-size:1.35em;}
h2 {font-size:1.25em;}
h3 {font-size:1.1em;}
h4 {font-size:1em;}
h5 {font-size:.9em;}

hr {height:1px;}

a {text-decoration:none;}

dt {font-weight:bold;}

ol {list-style-type:decimal;}
ol ol {list-style-type:lower-alpha;}
ol ol ol {list-style-type:lower-roman;}
ol ol ol ol {list-style-type:decimal;}
ol ol ol ol ol {list-style-type:lower-alpha;}
ol ol ol ol ol ol {list-style-type:lower-roman;}
ol ol ol ol ol ol ol {list-style-type:decimal;}

.txtOptionInput {width:11em;}

#contentWrapper .chkOptionInput {border:0;}

.externalLink {text-decoration:underline;}

.indent {margin-left:3em;}
.outdent {margin-left:3em; text-indent:-3em;}
code.escaped {white-space:nowrap;}

.tiddlyLinkExisting {font-weight:bold;}
.tiddlyLinkNonExisting {font-style:italic;}

/* the 'a' is required for IE, otherwise it renders the whole tiddler in bold */
a.tiddlyLinkNonExisting.shadow {font-weight:bold;}

#mainMenu .tiddlyLinkExisting,
    #mainMenu .tiddlyLinkNonExisting,
    #sidebarTabs .tiddlyLinkNonExisting {font-weight:normal; font-style:normal;}
#sidebarTabs .tiddlyLinkExisting {font-weight:bold; font-style:normal;}

.header {position:relative;}
.header a:hover {background:transparent;}
.headerShadow {position:relative; padding:4.5em 0 1em 1em; left:-1px; top:-1px;}
.headerForeground {position:absolute; padding:4.5em 0 1em 1em; left:0; top:0;}

.siteTitle {font-size:3em;}
.siteSubtitle {font-size:1.2em;}

#mainMenu {position:absolute; left:0; width:10em; text-align:right; line-height:1.6em; padding:1.5em 0.5em 0.5em 0.5em; font-size:1.1em;}

#sidebar {position:absolute; right:3px; width:16em; font-size:.9em;}
#sidebarOptions {padding-top:0.3em;}
#sidebarOptions a {margin:0 0.2em; padding:0.2em 0.3em; display:block;}
#sidebarOptions input {margin:0.4em 0.5em;}
#sidebarOptions .sliderPanel {margin-left:1em; padding:0.5em; font-size:.85em;}
#sidebarOptions .sliderPanel a {font-weight:bold; display:inline; padding:0;}
#sidebarOptions .sliderPanel input {margin:0 0 0.3em 0;}
#sidebarTabs .tabContents {width:15em; overflow:hidden;}

.wizard {padding:0.1em 1em 0 2em;}
.wizard h1 {font-size:2em; font-weight:bold; background:none; padding:0; margin:0.4em 0 0.2em;}
.wizard h2 {font-size:1.2em; font-weight:bold; background:none; padding:0; margin:0.4em 0 0.2em;}
.wizardStep {padding:1em 1em 1em 1em;}
.wizard .button {margin:0.5em 0 0; font-size:1.2em;}
.wizardFooter {padding:0.8em 0.4em 0.8em 0;}
.wizardFooter .status {padding:0 0.4em; margin-left:1em;}
.wizard .button {padding:0.1em 0.2em;}

#messageArea {position:fixed; top:2em; right:0; margin:0.5em; padding:0.5em; z-index:2000; _position:absolute;}
.messageToolbar {display:block; text-align:right; padding:0.2em;}
#messageArea a {text-decoration:underline;}

.tiddlerPopupButton {padding:0.2em;}
.popupTiddler {position: absolute; z-index:300; padding:1em; margin:0;}

.popup {position:absolute; z-index:300; font-size:.9em; padding:0; list-style:none; margin:0;}
.popup .popupMessage {padding:0.4em;}
.popup hr {display:block; height:1px; width:auto; padding:0; margin:0.2em 0;}
.popup li.disabled {padding:0.4em;}
.popup li a {display:block; padding:0.4em; font-weight:normal; cursor:pointer;}
.listBreak {font-size:1px; line-height:1px;}
.listBreak div {margin:2px 0;}

.tabset {padding:1em 0 0 0.5em;}
.tab {margin:0 0 0 0.25em; padding:2px;}
.tabContents {padding:0.5em;}
.tabContents ul, .tabContents ol {margin:0; padding:0;}
.txtMainTab .tabContents li {list-style:none;}
.tabContents li.listLink { margin-left:.75em;}

#contentWrapper {display:block;}
#splashScreen {display:none;}

#displayArea {margin:1em 17em 0 14em;}

.toolbar {text-align:right; font-size:.9em;}

.tiddler {padding:1em 1em 0;}

.missing .viewer,.missing .title {font-style:italic;}

.title {font-size:1.6em; font-weight:bold;}

.missing .subtitle {display:none;}
.subtitle {font-size:1.1em;}

.tiddler .button {padding:0.2em 0.4em;}

.tagging {margin:0.5em 0.5em 0.5em 0; float:left; display:none;}
.isTag .tagging {display:block;}
.tagged {margin:0.5em; float:right;}
.tagging, .tagged {font-size:0.9em; padding:0.25em;}
.tagging ul, .tagged ul {list-style:none; margin:0.25em; padding:0;}
.tagClear {clear:both;}

.footer {font-size:.9em;}
.footer li {display:inline;}

.annotation {padding:0.5em; margin:0.5em;}

* html .viewer pre {width:99%; padding:0 0 1em 0;}
.viewer {line-height:1.4em; padding-top:0.5em;}
.viewer .button {margin:0 0.25em; padding:0 0.25em;}
.viewer blockquote {line-height:1.5em; padding-left:0.8em;margin-left:2.5em;}
.viewer ul, .viewer ol {margin-left:0.5em; padding-left:1.5em;}

.viewer table, table.twtable {border-collapse:collapse; margin:0.8em 1.0em;}
.viewer th, .viewer td, .viewer tr,.viewer caption,.twtable th, .twtable td, .twtable tr,.twtable caption {padding:3px;}
table.listView {font-size:0.85em; margin:0.8em 1.0em;}
table.listView th, table.listView td, table.listView tr {padding:0 3px 0 3px;}

.viewer pre {padding:0.5em; margin-left:0.5em; font-size:1.2em; line-height:1.4em; overflow:auto;}
.viewer code {font-size:1.2em; line-height:1.4em;}

.editor {font-size:1.1em;}
.editor input, .editor textarea {display:block; width:100%; font:inherit;}
.editorFooter {padding:0.25em 0; font-size:.9em;}
.editorFooter .button {padding-top:0; padding-bottom:0;}

.fieldsetFix {border:0; padding:0; margin:1px 0px;}

.zoomer {font-size:1.1em; position:absolute; overflow:hidden;}
.zoomer div {padding:1em;}

* html #backstage {width:99%;}
* html #backstageArea {width:99%;}
#backstageArea {display:none; position:relative; overflow: hidden; z-index:150; padding:0.3em 0.5em;}
#backstageToolbar {position:relative;}
#backstageArea a {font-weight:bold; margin-left:0.5em; padding:0.3em 0.5em;}
#backstageButton {display:none; position:absolute; z-index:175; top:0; right:0;}
#backstageButton a {padding:0.1em 0.4em; margin:0.1em;}
#backstage {position:relative; width:100%; z-index:50;}
#backstagePanel {display:none; z-index:100; position:absolute; width:90%; margin-left:3em; padding:1em;}
.backstagePanelFooter {padding-top:0.2em; float:right;}
.backstagePanelFooter a {padding:0.2em 0.4em;}
#backstageCloak {display:none; z-index:20; position:absolute; width:100%; height:100px;}

.whenBackstage {display:none;}
.backstageVisible .whenBackstage {display:block;}
/*}}}*/
</pre>
</div>

<div title="StyleSheetLocale">
<pre>/***
StyleSheet for use when a translation requires any css style changes.
This StyleSheet can be used directly by languages such as Chinese, Japanese and Korean which need larger font sizes.
***/
/*{{{*/
body {font-size:0.8em;}
#sidebarOptions {font-size:1.05em;}
#sidebarOptions a {font-style:normal;}
#sidebarOptions .sliderPanel {font-size:0.95em;}
.subtitle {font-size:0.8em;}
.viewer table.listView {font-size:0.95em;}
/*}}}*/
</pre>
</div>

<div title="StyleSheetPrint">
<pre>/*{{{*/
@media print {
#mainMenu, #sidebar, #messageArea, .toolbar, #backstageButton, #backstageArea {display: none !important;}
#displayArea {margin: 1em 1em 0em;}
noscript {display:none;} /* Fixes a feature in Firefox 1.5.0.2 where print preview displays the noscript content */
}
/*}}}*/
</pre>
</div>

<div title="ViewTemplate">
<pre>&lt;!--{{{--&gt;
&lt;div class='toolbar' role='navigation' macro='toolbar [[ToolbarCommands::ViewToolbar]]'&gt;&lt;/div&gt;
&lt;div class='title' macro='view title'&gt;&lt;/div&gt;
&lt;div class='subtitle'&gt;&lt;span macro='view modifier link'&gt;&lt;/span&gt;, &lt;span macro='view modified date'&gt;&lt;/span&gt; (&lt;span macro='message views.wikified.createdPrompt'&gt;&lt;/span&gt; &lt;span macro='view created date'&gt;&lt;/span&gt;)&lt;/div&gt;
&lt;div class='tagging' macro='tagging'&gt;&lt;/div&gt;
&lt;div class='tagged' macro='tags'&gt;&lt;/div&gt;
&lt;div class='viewer' macro='view text wikified'&gt;&lt;/div&gt;
&lt;div class='tagClear'&gt;&lt;/div&gt;
&lt;!--}}}--&gt;
</pre>
</div>

<p></p>
</div>



<div id="storeArea">
<div title="RefreshTiddlerCommand">
<pre>/***
|''Name''|RefreshTiddlerCommand|
|''Version''|0.3.0|
***/
//{{{
(function($) {

var cmd = config.commands.refreshTiddler = {
    text: "refresh",
    locale: {
        refreshing: "Refreshing tiddler..."
    },
    tooltip: "refresh this tiddler to be the one on the server",
    handler: function(ev, src, title) {
        var tiddler = store.getTiddler(title);
        if(!tiddler) {
            tiddler = new Tiddler(title);
            merge(tiddler.fields, config.defaultCustomFields);
        }
        $(story.getTiddler(title)).find(".viewer").
            empty().text(cmd.locale.refreshing);
        var dirtyStatus = store.isDirty();
        story.loadMissingTiddler(title, {
            "server.workspace": tiddler.fields["server.recipe"]  ? "recipes/" + tiddler.fields["server.recipe"] :
                tiddler.fields["server.workspace"] || "bags/"+tiddler.fields["server.bag"],
            "server.host": tiddler.fields["server.host"],
            "server.type": tiddler.fields["server.type"]
        }, function() {
            store.setDirty(dirtyStatus);
        });
    }
};

})(jQuery);
//}}}</pre>
</div>

<div title="cancelTiddler">
<pre>&lt;svg xmlns="http://www.w3.org/2000/svg" xmlns:xl="http://www.w3.org/1999/xlink" version="1.1" viewBox="72 648 70 70" 
width="30" height="30"&gt;
&lt;g stroke="none" stroke-opacity="1" stroke-dasharray="none" fill="none" fill-opacity="1"&gt;
    &lt;g&gt;
        &lt;path d="M 77.59005 669.34003 C 71.532745 681.90424 73.714462 697.4441 84.135193 707.86475 
        C 97.315445 721.0451 118.684715 721.0451 131.8649 707.86475 
        C 145.04515 694.68457 145.04515 673.31537 131.8649 660.13513 
        C 121.4441 649.7141 105.90419 647.53253 93.339905 653.5899 L 102.047455 662.2976 
        C 109.58637 660.2373 117.987976 662.16803 123.90997 668.08997 
        C 132.69673 676.8767 132.69673 691.12317 123.90997 699.90985 
        C 115.12313 708.6966 100.87699 708.6966 92.09012 699.90985 
        C 86.168266 693.98804 84.23744 685.58643 86.297653 678.04755 Z M 72 648 L 72 668.25 L 78.75 661.49957 
        L 99.00019 681.7502 L 105.750175 675.00006 L 85.50013 654.75012 L 92.249985 648 Z" fill="black"
        class="glyph"/&gt;
    &lt;/g&gt;
&lt;/g&gt;
&lt;/svg&gt;</pre>
</div>

<div title="spaceIcon">
<pre>A [[SiteIcon|SiteIcon tiddler]]@glossary helps provide some identity to your space.  Ideally it'd be a square and a minimum of 48*48 pixels size.  You can upload your site icon using the uploader below.

&lt;&lt;binaryUploadPublic title:SiteIcon&gt;&gt;</pre>
</div>

<div title="privateIcon">
<pre>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</pre>
</div>

<div title="TiddlyFileImporter">
<pre>/***
|''Name''|TiddlyFileImporter|
|''Version''|0.3.8|
|''Author''|Ben Gillies|
|''Type''|plugin|
|''Description''|Upload a TiddlyWiki file to TiddlyWeb, and import the tiddlers.|
!Usage
Upload a TiddlyWiki file to TiddlyWeb, and import the tiddlers.
!Requires
tiddlyweb
tiddlywebplugins.reflector
!Code
***/
//{{{
(function($){
if(!version.extensions.TiddlyFileImporter)
{ //# ensure that the plugin is only installed once
    version.extensions.TiddlyFileImporter = { installed: true };
}

config.macros.fileImport = {
    reflectorURI: '/reflector?csrf_token=%0',
    incorrectTypeError: 'Incorrect File Type. You must upload a TiddlyWiki',
    uploadLabel: 'Upload',
    uploadLabelPrompt: 'Import tiddlers from this TiddlyWiki',
    step1FileText: 'File:',
    step1PostText: 'In the next screen you will select the tiddlers to import.',
    step1Title: 'Step 1: Pick a TiddlyWiki to import',
    step1TypeChooser: 'Import From:',
    step3Html: ['&lt;input type="hidden" name="markList" /&gt;',
        '&lt;input type="hidden" checked="true" name="chkSync" /&gt;',
        '&lt;input type="hidden" name="chkSave" /&gt;',
        '&lt;input type="hidden" name="txtSaveTiddler" /&gt;'].join(),

    handler: function(place, macroName, params, wikifier, paramString) {
        var wizard = new Wizard();
        wizard.createWizard(place, 'Import a TiddlyWiki');
        this.restart(wizard);
    },

    restart: function(wizard) {
        var me = config.macros.fileImport;
        wizard.addStep(me.step1Title, ['&lt;input type="hidden" ',
            'name="markList" /&gt;'].join(""));
        var markList = wizard.getElement('markList');
        var uploadWrapper = document.createElement('div');
        markList.parentNode.insertBefore(uploadWrapper, markList);
        uploadWrapper.setAttribute('refresh', 'macro');
        uploadWrapper.getAttribute('macroName', 'fileImport');
        var iframeName = 'reflectorImporter' + Math.random().toString();
        me.createForm(uploadWrapper, wizard, iframeName);
        $(uploadWrapper).append('&lt;p&gt;' + me.step1PostText + '&lt;/p&gt;');
        wizard.setValue('serverType', 'tiddlyweb');
        wizard.setValue('adaptor', new config.adaptors.file());
        wizard.setValue('host', config.defaultCustomFields['server.host']);
        wizard.setValue('context', {});
        var iframe = $(['&lt;iframe name="' + iframeName + '" ',
            'style="display: none" /&gt;'].join("")).appendTo(uploadWrapper);
        var onSubmit = function(ev) {
            var uploadType = $('select[name=uploadtype]', wizard.formElem).val();
            if (uploadType == "file") {
                // set an onload ready to hijack the form
                me.setOnLoad(uploadWrapper, wizard, iframe[0]);
                wizard.importType = 'file';
                wizard.formElem.submit();
            } else {
                var csrf_token = config.extensions.tiddlyspace.getCSRFToken();
                $.ajax({
                    url: "%0/reflector?csrf_token=%1".format(
                        config.defaultCustomFields["server.host"], csrf_token),
                    type: "POST",
                    dataType: "text",
                    data: {
                        uri: $("input", ".importFrom", wizard.formElem).val()
                    },
                    success: function(data, txtStatus, xhr) {
                        wizard.POSTResponse = data;
                        me.importTiddlers(uploadWrapper, wizard);
                    },
                    error: function(xhr, txtStatus, error) {
                        displayMessage(["There was an error fetching the ",
                            'url: ', txtStatus].join(""));
                        me.restart(wizard);
                    }
                });
                return false;
            }
        };
        wizard.setButtons([{
            caption: me.uploadLabel,
            tooltip: me.uploadLabelPrompt,
            onClick: onSubmit
        }]);
        $(wizard.formElem).submit(function(ev) {
            onSubmit(ev);
            ev.preventDefault();
        });
    },

    createForm: function(place, wizard, iframeName) {
        var form = wizard.formElem;
        var me = config.macros.fileImport;
        form.action = me.reflectorURI.format(
            config.extensions.tiddlyspace.getCSRFToken());
        form.enctype = 'multipart/form-data';
        form.encoding = 'multipart/form-data';
        form.method = 'POST';
        form.target = iframeName;
        onSelectChange = function(e) {
            var changeTo = $(this).val();
            if (changeTo == "file") {
                $(".importFrom").html('%0 &lt;input type="file" name="file" /&gt;'.
                    format(me.step1FileText));
            } else {
                $(".importFrom").html('URL: &lt;input type="text" name="uri" /&gt;'
                    + ' Do you want &lt;a target="_blank" href="http://faq.tiddlyspace.com/How%20do%20I%20include%2Fexclude%20spaces%3F"&gt;inclusion&lt;/a&gt; instead?');
            }
        };
        $(place).append('&lt;span&gt;%0&lt;/span&gt;'.format(me.step1TypeChooser)).
            append($(['&lt;select name="uploadtype"&gt;&lt;option value="file" selected="selected"&gt;file',
                '&lt;option value="uri"&gt;url&lt;/select&gt;'].join("")).change(onSelectChange)).
            append('&lt;div class="importFrom"&gt;%0&lt;input type="file" name="file" /&gt;&lt;/div&gt;'.
                    format(me.step1FileText));
    },

    setOnLoad: function(place, wizard, iframe) {
        var me = config.macros.fileImport;
        var loadHandler = function() {
            me.importTiddlers.apply(this, [place, wizard, iframe]);
        };
        iframe.onload = loadHandler;
        completeReadyStateChanges = 0;
        iframe.onreadystatechange = function() {
            if (++(completeReadyStateChanges) == 5) {
                loadHandler();
            }
        };
    },

    importTiddlers: function(place, wizard, iframe) {
        var tmpStore = new TiddlyWiki();
        var POSTedWiki = "";
        if (wizard.importType == "file") {
            try {
                POSTedWiki= iframe.contentWindow
                    .document.documentElement.innerHTML;
            } catch(e) {
                displayMessage(config.macros.fileImport.incorrectTypeError);
                config.macros.fileImport.restart(wizard);
                return;
            }
            // now we are done, so remove the iframe
            $(iframe).remove();
        } else {
            POSTedWiki = wizard.POSTResponse;
        }

        tmpStore.importTiddlyWiki(POSTedWiki);
        var newTiddlers = tmpStore.getTiddlers();
        var workspace = config.defaultCustomFields['server.workspace'];
        var context = {
            status: true,
            statusText: 'OK',
            httpStatus: 200,
            adaptor: wizard.getValue('adaptor'),
            tiddlers: newTiddlers
        };
        context.adaptor.store = tmpStore;
        wizard.setValue('context', context);
        wizard.setValue('workspace', workspace);
        wizard.setValue('inFileImport', true);
        config.macros.importTiddlers.onGetTiddlerList(context, wizard);
    }
};

var _onGetTiddler = config.macros.importTiddlers.onGetTiddler;
config.macros.importTiddlers.onGetTiddler = function(context, wizard) {
    if (wizard.getValue('inFileImport')) {
        var me = config.macros.importTiddlers;
        if(!context.status)
            displayMessage("Error in importTiddlers.onGetTiddler: " + context.statusText);
        var tiddler = context.tiddler;
        var fields = tiddler.fields;
        merge(fields, config.defaultCustomFields);
        fields["server.workspace"] = wizard.getValue('workspace');
        delete fields['server.permissions'];
        delete fields['server.bag'];
        fields['server.page.revision'] = 'false';
        delete fields['server.recipe'];
        fields.changecount = 1;
        store.suspendNotifications();
        store.saveTiddler(tiddler.title, tiddler.title, tiddler.text,
            tiddler.modifier, tiddler.modified, tiddler.tags, tiddler.fields,
            false, tiddler.created);
        store.resumeNotifications();
        var remainingImports = wizard.getValue("remainingImports")-1;
        wizard.setValue("remainingImports",remainingImports);
        if(remainingImports === 0) {
            if(context.isSynchronous) {
                store.notifyAll();
                refreshDisplay();
            }
            wizard.setButtons([
                    {caption: me.doneLabel, tooltip: me.donePrompt, onClick: me.onClose}
                ],me.statusDoneImport);
            autoSaveChanges();
        }
    } else {
        _onGetTiddler.apply(this, arguments);
    }
};

var _onCancel = config.macros.importTiddlers.onCancel;
config.macros.importTiddlers.onCancel = function(e)
{
    var wizard = new Wizard(this);
    if (!wizard.getValue('inFileImport')) {
        return _onCancel.apply(this, arguments);
    }
    var place = wizard.clear();
    config.macros.fileImport.restart(wizard);
    return false;
};

var _step3Html = config.macros.importTiddlers.step3Html;
var _onGetTiddlerList = config.macros.importTiddlers.onGetTiddlerList;
config.macros.importTiddlers.onGetTiddlerList = function(context, wizard) {
    var fileImport = config.macros.fileImport;
    var importTiddlers = config.macros.importTiddlers;
    if (wizard.getValue('inFileImport')) {
        importTiddlers.step3Html = fileImport.step3Html;
    } else {
        importTiddlers.step3Html = _step3Html;
    }
    _onGetTiddlerList.apply(this, arguments);
};
})(jQuery);
//}}}</pre>
</div>

<div title="pearlSetupFlag">
<pre>@@Please do not modify this tiddler; it was created automatically upon space creation.@@</pre>
</div>

<div title="文件">
<pre>'文件'
&lt;html&gt;
&lt;head&gt;
      &lt;title&gt;第一个HTML代码&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div align="center"&gt;
&lt;img src="http://picm.photophoto.cn/005/023/001/0230010072.jpg" hight="500" width="300" &gt;&lt;br/&gt;

&lt;/div&gt;
&lt;hr width="800" color="pink" size"10"/&gt;

&lt;/body&gt;
&lt;/html&gt;
</pre>
</div>

<div title="_reply">
<pre>&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"&gt;
    &lt;title&gt;Reply&lt;/title&gt;
    &lt;link rel="stylesheet" href="//tiddlyspace.com/bags/benspa_public/tiddlers/bootvelcro.css"&gt;
    &lt;style&gt;
        html,
        body {
            overflow: hidden;
            background-color: transparent;
        }

        #container {
            /* prevent a fouc if no images present */
            display: none;
        }

        .modal-header {
            border-bottom: none;
            padding: 5px 0 0;
            position: absolute;
            width: 100%;
            background-color: #e0e0e0;
            -webkit-border-radius: 6px 6px 0 0;
            -moz-border-radius: 6px 6px 0 0;
            border-radius: 6px 6px 0 0;
            cursor: move;
        }

        .form-actions {
            position: absolute;
            bottom: 0;
            box-sizing: border-box;
            -moz-box-sizing: border-box;
            width: 100%;
            margin: 0;
            border-radius: 0 0 6px 6px;
            background-color: #e0e0e0;
            border-top: 1px solid gray;
        }

        .form-actions input.btn {
            width: auto;
            float: right;
            margin: 0 0.2em;
        }

        .closeBtn {
            background-color: #DCE7F1 !important;
        }

        .primary {
            background-color: #09F !important;
        }

        h1 {
            margin-bottom: 9px;
            margin-top: 9px;
        }

        body {
            width: 100%;
            height: 100%;
            position: absolute;
        }

        .modal {
            margin: 10px;
            top: 0;
            left: 0;
            bottom: 0;
            width: 510px;
            position: absolute;
            box-shadow: #444 0px 0px 10px 2px;
            border-radius: 6px;
            background-color: white;
            border: 1px solid gray;
            background-color: #F0F4F8;
        }

        label em {
            cursor: pointer;
        }

        .modal-body {
            overflow: auto;
            position: absolute;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
            margin: 65px 20px 67px;
            background-color: transparent;
        }

        .nav-tabs {
            padding-left: 1%;
            margin: 0;
            width: 99%;
            border-color: gray;
        }

        .nav-tabs &gt; li {
            cursor: pointer;
        }

        .nav-tabs &gt; li &gt; a {
            line-height: 2.4em;
            font-weight: bold;
            font-size: 100%;
        }

        .nav-tabs &gt; li.active &gt; a{
            background-color: #F0F4F8;
            border-color: gray;
            border-bottom-color: #F0F4F8;
        }

        .active {
            display: block;
        }

        input,
        textarea,
        select,
        .uneditable-input {
            color: #606060;
        }

        .imagePicker {
            -moz-box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
            -webkit-box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid #CCC;
            height: 110px;
            overflow: auto;
            -webkit-border-radius: 3px;
            -moz-border-radius: 3px;
            border-radius: 3px;
            margin-left: 0;
        }

        .imagePicker img {
            margin: 5px;
            border: 2px solid transparent;
        }

        .imagePicker .current {
            border: 2px dotted #555;
        }

        label {
            font-weight: bold;
        }

        .form-actions label {
            float: left;
            margin-top: 0.75em;
        }

        fieldset input,
        fieldset textarea {
            width: 90%;
            border-color: gray;
        }

        @media all and (max-width: 550px) {
            .modal {
                width: 95%;
            }
        }

        #help {
            position: absolute;
            border: 0;
            right: 4px;
            top: 5px;
            text-indent: -9999px;
            color: transparent;
            height: 16px;
            width: 16px;
            background: none;
            background-image: url(/bags/common/tiddlers/help.png);
            background-repeat: no-repeat;
            background-color: white;
            z-index: 2;
            border-radius: 10px;
        }

        #help-info {
            padding: 0;
            border: 1px solid gray;
            width: 60%;
            height: 50px;
            color: #404040;
            background-color: white;
            position: absolute;
            top: 5px;
            right: 5px;
            z-index: 1;
            cursor: auto;
            border-radius: 5px;

        }

        #help-info p {
            padding: 10px 25px;
            margin-bottom: 0;
        }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div id="container"&gt;
        &lt;form action="#" class="modal"&gt;
            &lt;div class="modal-header"&gt;
                &lt;button id="help"&gt;help&lt;/button&gt;
                &lt;div id="help-info" style="display:none;"&gt;&lt;p&gt;
                Found something interesting? Write about it in your own space. &lt;a href="//docs.tiddlyspace.com/Reply to this Tiddler" target="_blank"&gt;Find out more&lt;/a&gt;
                &lt;/p&gt;&lt;/div&gt;
                &lt;ul class="nav nav-tabs" data-tabs="tabs"&gt;
                    &lt;li class="active" data-tab-name="post"&gt;&lt;a href="#postForm"&gt;Reply&lt;/a&gt;&lt;/li&gt;
                &lt;/ul&gt;
            &lt;/div&gt;


            &lt;fieldset id="postForm" class="modal-body"&gt;
                &lt;label&gt;Title
                    &lt;input type="text" name="title"&gt;
                &lt;/label&gt;
                &lt;input type="hidden" name="url"&gt;
                &lt;label&gt;Post
                    &lt;textarea name="text" rows="8"&gt;&lt;/textarea&gt;
                &lt;/label&gt;
                &lt;label&gt;Tags
                    &lt;input type="text" name="tags" value=""&gt;
                &lt;/label&gt;
            &lt;/fieldset&gt;


            &lt;div class="form-actions"&gt;
                &lt;label class="checkbox"&gt;
                    &lt;input type="checkbox" name="private" val="private"&gt;
                    keep private
                &lt;/label&gt;
                &lt;input type="submit" class="btn primary btn-large" value="Done"&gt;
                &lt;input type="button" class="btn btn-large closeBtn" value="Cancel"&gt;
            &lt;/div&gt;
        &lt;/form&gt;
    &lt;/div&gt;

    &lt;script type="text/javascript"
            src="/bags/common/tiddlers/jquery.js"&gt;&lt;/script&gt;
    &lt;script type="text/javascript" src="/bags/tiddlyspace/tiddlers/chrjs"&gt;&lt;/script&gt;
    &lt;script type="text/javascript" src="/bags/common/tiddlers/_reply.js"&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
</div>

<div title="_account">
<pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta http-equiv="Content-Type" content="text/html;charset=utf-8"&gt;
    &lt;title&gt;Account&lt;/title&gt;
    &lt;link href="/bags/common/tiddlers/profile.css" type='text/css' rel='stylesheet' &gt;
    &lt;link href="/bags/common/tiddlers/admin.css" type='text/css' rel='stylesheet' &gt;
    &lt;link href="/bags/common/tiddlers/jquery-ui.custom.css" type='text/css' rel='stylesheet' &gt;
&lt;/head&gt;
&lt;body&gt;

&lt;div id="container"&gt;
    &lt;div class="main section"&gt;
        &lt;a class="app" href="/"&gt;home&lt;/a&gt;
        &lt;div class="left"&gt;
        &lt;div id="siteiconArea"&gt;
        &lt;h2&gt;User Icon&lt;/h2&gt;
        &lt;div&gt;
            &lt;img id="siteicon" class="siteicon"&gt;
            &lt;form id="upload" method="POST" enctype="multipart/form-data"&gt;
                &lt;input type="hidden" name="title" value="SiteIcon" /&gt;
                &lt;input type="hidden" name="tags" value="excludeLists"&gt;
                &lt;input type="hidden" name="csrf_token" class="csrf" /&gt;
                &lt;input type="file" name="file" accept="image/*" /&gt;
                &lt;input type="submit" value="upload" /&gt;
            &lt;/form&gt;
            &lt;div id="dropzone"&gt;Drop file here
                &lt;img class="notloading" src="/bags/common/tiddlers/ajax-loader.gif" alt="submitting SiteIcon" /&gt;
            &lt;/div&gt;
        &lt;/div&gt;
        &lt;/div&gt;
        &lt;h2&gt;Find Space&lt;/h2&gt;
        &lt;form class="spaceSearch"&gt;
            &lt;input class="inputBox" type="text" placeholder="find space" /&gt;
            &lt;a href="http://docs.tiddlyspace.com/What%20is%20a%20Space%3F" class="help"
                title="What is a space?"&gt;What is a space?&lt;/a&gt;
            &lt;button&gt;view all&lt;/button&gt;
        &lt;/form&gt;
        &lt;div class='list-container'&gt;
            You are a member of the following spaces:
            &lt;ul class='ts-space-search'&gt;
            &lt;/ul&gt;
        &lt;/div&gt;
        &lt;h2&gt;Create New Space&lt;/h2&gt;
        &lt;form class="ts-spaces"&gt;
            &lt;input class="inputBox" type="text" name="spacename" placeholder="space name"&gt;&lt;span class="hostSuffix"&gt;.tiddlyspace.com&lt;/span&gt;
            &lt;input type="submit" value="Create Space" /&gt;
        &lt;/form&gt;
        &lt;/div&gt;
        &lt;div class="right"&gt;
        &lt;h2&gt;Change Password&lt;/h2&gt;
        &lt;form class="ts-password"&gt;
            &lt;input class="inputBox" placeholder="existing password" type="password" name="password"&gt;
            &lt;input class="inputBox" placeholder="new password" type="password" name="new_password"&gt;
            &lt;input class="inputBox" placeholder="new password"   type="password" name="new_password_confirm"&gt;
            &lt;input type="submit" value="Change password"&gt;
        &lt;/form&gt;
        &lt;h2&gt;OpenID&lt;/h2&gt;
        &lt;h3&gt;Why OpenID?&lt;/h3&gt;
        &lt;a href="http://openid.net/"&gt;&lt;img src="/bags/common/tiddlers/openid.png" alt="openid" &gt;&lt;/a&gt;&lt;br /&gt;
        Use just one username and password across hundreds of OpenID-enabled sites.&lt;br /&gt;
        It's an open standard.&lt;br /&gt;
        &lt;a href="http://openid.net/what/"&gt;learn more&lt;/a&gt;
        &lt;ul class="ts-identities"&gt;&lt;/ul&gt;
        &lt;form class="ts-openid" target="_top"&gt;
            &lt;div&gt;
                Add an openid:
            &lt;/div&gt;
            &lt;input class="inputBox" type="text" name="openid" placeholder="your openid" /&gt;
            &lt;input type="submit" value="Register" /&gt;
            &lt;a href="http://openid.net/get-an-openid/" class="help"
            title="What is an open id?"&gt;What is an open id?&lt;/a&gt;
        &lt;/form&gt;
        &lt;/div&gt;
        &lt;div class="clear"&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;
&lt;script src="/bags/common/tiddlers/backstage.js"&gt;&lt;/script&gt;
&lt;script src='/bags/common/tiddlers/jquery.js'&gt;&lt;/script&gt;
&lt;script src='/bags/tiddlyspace/tiddlers/chrjs'&gt;&lt;/script&gt;
&lt;script src='/bags/common/tiddlers/chrjs.space'&gt;&lt;/script&gt;
&lt;script src='/bags/common/tiddlers/chrjs.users'&gt;&lt;/script&gt;
&lt;script src='/bags/common/tiddlers/chrjs.identities'&gt;&lt;/script&gt;
&lt;script src="/bags/common/tiddlers/jquery-ui.custom.js"&gt;&lt;/script&gt;
&lt;script src='/bags/common/tiddlers/jquery-form.js'&gt;&lt;/script&gt;
&lt;script src="/bags/common/tiddlers/siteiconupload.js"&gt;&lt;/script&gt;
&lt;script src='/bags/common/tiddlers/ts.js'&gt;&lt;/script&gt;
&lt;script src="/status.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript"&gt;
/*
 * jQuery UI Autocomplete HTML Extension
 *
 * Copyright 2010, Scott González (http://scottgonzalez.com)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * http://github.com/scottgonzalez/jquery-ui-extensions
 */
(function( $ ) {

var proto = $.ui.autocomplete.prototype,
    initSource = proto._initSource;

function filter( array, term ) {
    var matcher = new RegExp( $.ui.autocomplete.escapeRegex(term), "i" );
    return $.grep( array, function(value) {
        return matcher.test( $( "&lt;div&gt;" ).html( value.label || value.value || value ).text() );
    });
}

$.extend( proto, {
    _initSource: function() {
        if ( this.options.html &amp;&amp; $.isArray(this.options.source) ) {
            this.source = function( request, response ) {
                response( filter( this.options.source, request.term ) );
            };
        } else {
            initSource.call( this );
        }
    },

    _renderItem: function( ul, item) {
        return $( "&lt;li&gt;&lt;/li&gt;" )
            .data( "item.autocomplete", item )
            .append( $( "&lt;a&gt;&lt;/a&gt;" )[ this.options.html ? "html" : "text" ]( item.label ) )
            .appendTo( ul );
    }
});

})( jQuery );

/***
_accounts application specific javascript
***/
var link;
ts.init(function(ts) {
    if(ts.user.anon) { // redirect to homepage when user not logged in
        window.location = ts.getHost();
    } else if(ts.user.name === ts.currentSpace){
        initSiteIconUpload(ts.user.name);
    } else {
        link = $("&lt;a /&gt;").attr("href", ts.getHost(ts.user.name) + "/_account").text("Change User Icon");
        $("#siteiconArea div").empty().append(link);
    }
    $(".hostSuffix").text("." + ts.getHost("").split("//")[1]);
    ts.getSpaces(function(spaces) {
        $("&lt;div class='info' /&gt;").text("You have " + spaces.length + " spaces.").insertBefore($(".spaceSearch")[0]);
        $("form.spaceSearch input").autocomplete({
            html: true,
            source: function(req, response) {
                ts.getSpaces(function(spaces) {
                    var selected = [];
                    for(var i = 0; i &lt; spaces.length; i++) {
                        var space = spaces[i];
                        if(space.name.indexOf(req.term) &gt; -1) {
                            var host = ts.getHost(space.name) ;
                            var img = host + "/SiteIcon";
                            selected.push({
                                value: space.name,
                                label: '&lt;a href="' + host + '" target="_parent" class="autocompleteLink"&gt;&lt;img src="' + img + '" style="height:24px;width:auto;max-height:24px;max-width:24px;"/&gt;' + space.name + '&lt;/a&gt;'
                            });
                        }
                    }
                    response(selected);
                });
            },
            select: function(event, ui) {
                window.top.location = ts.getHost(ui.item.value);
            }
        });

        var $ul = $('.ts-space-search');
        $.each(spaces, function(i, space) {
            $ul.append($('&lt;li/&gt;').html($('&lt;a/&gt;').attr('href', space.uri)
                .text(space.name)));
        });

        $('form.spaceSearch button').click(function(ev) {
            $('.list-container').slideToggle('fast');
            ev.preventDefault();
            return false;
        });
    });
});

if(window != window.top) {
    $("html").addClass("iframeMode");
    $("a").live("click",function(ev) {
        $(ev.target).attr("target", "_parent");
    });
}
&lt;/script&gt;
&lt;!--[if lt IE 8]&gt;
&lt;script type="text/javascript" src="/bags/common/tiddlers/json2.js"&gt;&lt;/script&gt;
&lt;![endif]--&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
</div>

<div title="迪伦的荒原世界">
<pre>&lt;html&gt;
&lt;head&gt;
      &lt;title&gt;第一个HTML代码&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div align="center"&gt;
&lt;img src="http://zw.shangxueba.com/uploadfile/20150901/201509011346492814.jpg" hight="500" width="500" &gt;&lt;br/&gt;
&lt;a href="http:www.Baidu.com"&gt;百度&lt;/a&gt;
&lt;hr width="800" color="pink" size"10"/&gt;
      &lt;h2&gt;&lt;font color="purple" face="楷体" size"20"&gt;如果我真的存在，也是因为你需要我。 &lt;br/&gt;
      &lt;h2&gt;I exist because you need me.&lt;/font&gt;&lt;br/&gt;
&lt;/div&gt;
&lt;hr width="800" color="pink" size"10"/&gt;

&lt;/body&gt;
&lt;/html&gt;

</pre>
</div>

<div title="SpaceSettings">
<pre>!Upload an icon
&lt;&lt;tiddler spaceIcon&gt;&gt;
!Describe your space
If you haven't already done so, you should provide a brief decscription of yourself and what you're using this space for. To do this, just edit the [[SiteInfo]] tiddler (keeping the title the same of course).

!Change the title
&lt;&lt;tiddler spaceTitle&gt;&gt;
!Change the theme
&lt;&lt;tiddler colorScheme&gt;&gt;
!Change the menu
If you'd like to change the menu items along the top, you can edit the [[MainMenu]] tiddler.

!Change the default tiddlers
&lt;&lt;tiddler setDefaultTiddlers&gt;&gt;
!More Advanced customisations
If you know HTML and CSS, you can edit some or all of the following tiddlers to customise your space further:
* PageTemplate
* EditTemplate
* ViewTemplate
* StyleSheet</pre>
</div>

<div title="TiddlySpaceConfig">
<pre>/***
|''Name''|TiddlySpaceConfig|
|''Version''|0.7.7|
|''Description''|TiddlySpace configuration|
|''Status''|stable|
|''Source''|http://github.com/TiddlySpace/tiddlyspace/raw/master/src/plugins/TiddlySpaceConfig.js|
|''CoreVersion''|2.6.1|
|''Requires''|TiddlyWebConfig ServerSideSavingPlugin TiddlyFileImporter|
!Code
***/
//{{{
(function($) {

var tweb = config.extensions.tiddlyweb;

var recipe = config.defaultCustomFields["server.workspace"].split("recipes/")[1];
var currentSpace; // assigned later

var disabledTabs = [];

var coreBags = ["system", "tiddlyspace"];
var systemSpaces = ["plugins", "info", "images", "theme"];
systemSpaces = $.map(systemSpaces, function(item, i) {
    return "system-%0_public".format(item);
});

// hijack search macro to add custom attributes for mobile devices
var _search = config.macros.search.handler;
config.macros.search.handler = function(place, macroName, params) {
    _search.apply(this, arguments);
    $(".searchField:input", place).
        attr({ autocapitalize: "off", autocorrect: "off" });
};

// arg is either a container name or a tiddler object
// if fuzzy is truthy, space may be inferred from workspace (for new tiddlers)
// returns space object or false
var determineSpace = function(arg, fuzzy) {
    if(typeof arg == "string") { // container name
        var space = split(arg, "_", "r");
        return ["public", "private"].contains(space.type) ? space : false;
    } else if(arg) { // tiddler
        var container = determineContainer(arg, fuzzy);
        return container ? determineSpace(container.name, fuzzy) : false;
    } else {
        return false;
    }
};

// if fuzzy is truthy, container may be inferred from workspace for new tiddlers
// returns container object or false
var determineContainer = function(tiddler, fuzzy) { // TODO: expose?
    var bag = tiddler.fields["server.bag"];
    var recipe = tiddler.fields["server.recipe"]; // XXX: unused/irrelevant/redundant!?
    if(bag) {
        return { type: "bag", name: bag };
    } else if(recipe) {
        return { type: "recipe", name: recipe };
    } else if(fuzzy) { // new tiddler
        var workspace = tiddler.fields["server.workspace"];
        if(workspace) {
            var container = split(workspace, "/", "l");
            return ["bags", "recipes"].contains(container.type) ? container : false;
        } else {
            return false;
        }
    } else {
        return false;
    }
};

// hijack removeTiddlerCallback to restore tiddler from recipe cascade -- TODO: move into TiddlyWebWiki?
var sssp = config.extensions.ServerSideSavingPlugin;
var _removeTiddlerCallback = sssp.removeTiddlerCallback;
sssp.removeTiddlerCallback = function(context, userParams) {
    var title = context.tiddler.title;
    var recipe = context.tiddler.fields["server.recipe"];
    _removeTiddlerCallback.apply(this, arguments);
    if(recipe) {
        context.workspace = "recipes/" + recipe;
        var callback = function(context, userParams) {
            if(context.status) {
                var dirty = store.isDirty();
                store.saveTiddler(context.tiddler).clearChangeCount();
                store.setDirty(dirty);
            } else {
                store.notify(title, true);
            }
        };
        context.adaptor.getTiddler(title, context, null, callback);
    }
};

// splits a string once using delimiter
// mode "l" splits at the first, "r" at the last occurrence
// returns an object with members type and name
var split = function(str, sep, mode) {
    mode = mode == "r" ? "pop" : "shift"; // TODO: use +/-1 instead of "l"/"r"?
    var arr = str.split(sep);
    var type = arr.length &gt; 1 ? arr[mode]() : null;
    return { type: type, name: arr.join(sep) };
};

var plugin = config.extensions.tiddlyspace = {
    currentSpace: determineSpace(recipe),
    coreBags: coreBags.concat(systemSpaces),

    determineSpace: determineSpace,
    isValidSpaceName: function(name) {
        return name.match(/^[a-z][0-9a-z\-]*[0-9a-z]$/) ? true : false;
    },
    getCurrentBag: function(type) {
        return "%0_%1".format(currentSpace, type);
    },
    getCurrentWorkspace: function(type) {
        return "bags/" + this.getCurrentBag(type);
    },
    // returns the URL for a space's avatar (SiteIcon) based on a server_host
    // object and an optional space name
    // optional nocors argument prevents cross-domain URLs from being generated
    getAvatar: function(host, space, nocors) {
        if(space &amp;&amp; typeof space != "string") { // backwards compatibility -- XXX: deprecated
            space = space.name;
        }
        var subdomain = nocors ? currentSpace : space;
        host = host ? this.getHost(host, subdomain) : "";
        var bag = space ? "%0_public".format(space) : "tiddlyspace";
        return "%0/bags/%1/tiddlers/SiteIcon".format(host, bag);
    },
    // returns the URL based on a server_host object (scheme, host, port) and an
    // optional subdomain
    getHost: function(host, subdomain) {
        if(host === undefined) { // offline
            tweb.status.server_host = {}; // prevents exceptions further down the stack -- XXX: hacky workaround, breaks encapsulation
            return null;
        }
        subdomain = subdomain ? subdomain + "." : "";
        var url = "%0://%1%2".format(host.scheme, subdomain, host.host);
        var port = host.port;
        if(port &amp;&amp; !["80", "443"].contains(port)) {
            url += ":" + port;
        }
        return url;
    },
    disableTab: function(tabTiddler) {
        if(typeof(tabTiddler) == "string") {
            disabledTabs.push(tabTiddler);
        } else {
            for(var i = 0; i &lt; tabTiddler.length; i++) {
                plugin.disableTab(tabTiddler[i]);
            }
        }
    },
    checkSyncStatus: function(tiddler) {
        if(tiddler) {
            var title = typeof(tiddler) === "string" ? tiddler : tiddler.title;
            var el = story.getTiddler(title) || false;
            if(el) {
                refreshElements(el);
            }
        }
    },
    isDisabledTab: function(tabTitle) {
        var match = new RegExp("(?:\\[\\[([^\\]]+)\\]\\])", "mg").exec(tabTitle);
        var tabIdentifier = match ? match[1] : tabTitle;
        return disabledTabs.contains(tabIdentifier);
    },
    getCSRFToken: window.getCSRFToken || null // this may not have been processed yet
};

currentSpace = plugin.currentSpace.name;

tweb.serverPrefix = tweb.host.split("/")[3] || ""; // XXX: assumes root handler
tweb.getStatus(function(status) {
    var url = plugin.getHost(status.server_host);
    tweb.status.server_host.url = url;
    config.messages.tsVersion = status.version;
});

if(window.location.protocol == "file:") {
    // enable AutoSave by default
    config.options.chkAutoSave = config.options.chkAutoSave === undefined ?
        true : config.options.chkAutoSave;
} else {
    // set global read-only mode based on membership heuristics
    var indicator = store.getTiddler("SiteTitle") || tiddler;
    readOnly = !(recipe.split("_").pop() == "private" ||
        tweb.hasPermission("write", indicator));
    // replace TiddlyWiki's ImportTiddlers due to cross-domain restrictions
    if(config.macros.fileImport) {
        $.extend(config.macros.importTiddlers, config.macros.fileImport);
    }
}

// hijack saveChanges to ensure SystemSettings is private by default
var _saveChanges = saveChanges;
saveChanges = function(onlyIfDirty, tiddlers) {
    if(tiddlers &amp;&amp; tiddlers.length == 1 &amp;&amp;
            tiddlers[0] &amp;&amp; tiddlers[0].title == "SystemSettings") {
        var fields = tiddlers[0].fields;
        delete fields["server.recipe"];
        fields["server.bag"] = plugin.getCurrentBag("private");
        fields["server.workspace"] = plugin.getCurrentWorkspace("private");
    }
    return _saveChanges.apply(this, arguments);
};

// ensure backstage is always initialized
// required to circumvent TiddlyWiki's read-only based handling
config.macros.backstageInit = {
    init: function() {
        showBackstage = true;
    }
};

// disable evaluated macro parameters for security reasons
config.evaluateMacroParameters = "none";
var _parseParams = String.prototype.parseParams;
String.prototype.parseParams = function(defaultName, defaultValue, allowEval,
        noNames, cascadeDefaults) {
    if(config.evaluateMacroParameters == "none") {
        arguments[2] = false;
    }
    return _parseParams.apply(this, arguments);
};

var _tabsMacro = config.macros.tabs.handler;
config.macros.tabs.handler = function(place, macroName, params) {
    var newParams = [params[0]]; // keep cookie name
    for(var i = 1; i &lt; params.length; i += 3) {
        var tabTitle = params[i + 2];
        if(!plugin.isDisabledTab(tabTitle)){
            newParams = newParams.concat(params[i], params[i + 1], tabTitle);
        }
    }
    _tabsMacro.apply(this, [place, macroName, newParams]);
};

// disable ControlView for XHRs by default
$.ajaxSetup({
    beforeSend: function(xhr) {
        xhr.setRequestHeader("X-ControlView", "false");
    }
});
// TiddlyWeb adaptor currently still uses httpReq, which needs extra magic -- XXX: obsolete this!
var _httpReq = httpReq;
httpReq = function(type, url, callback, params, headers, data, contentType,
        username, password, allowCache) {
    headers = headers || {};
    headers["X-ControlView"] = "false";
    _httpReq.apply(this, arguments);
};

// register style sheet for backstage separately (important)
store.addNotification("StyleSheetBackstage", refreshStyles);

// option for default privacy setting
config.optionsDesc.chkPrivateMode = "Set your default privacy mode to private";
config.optionsSource.chkPrivateMode = "setting";
config.options.chkPrivateMode = config.options.chkPrivateMode || false;
saveSystemSetting("chkPrivateMode", true);
config.defaultCustomFields["server.workspace"] = plugin.
    getCurrentWorkspace(config.options.chkPrivateMode ? "private" : "public");

config.paramifiers.follow = {
    onstart: function(v) {
        if(!readOnly) {
            var bag = "%0_public".format(currentSpace);
            story.displayTiddler(null, v, DEFAULT_EDIT_TEMPLATE, null, null,
                "server.bag:%0 server.workspace:bags/%0".format(bag));
            story.setTiddlerTag(v, "follow", 1);
            story.focusTiddler(v, "text");
        }
    }
};

var fImport = config.macros.fileImport;
if(fImport) {
    fImport.uploadTo = "Upload to: ";
    var _createForm = config.macros.fileImport.createForm;
    config.macros.fileImport.createForm = function(place, wizard, iframeName) {
        var container = $("&lt;div /&gt;").text(fImport.uploadTo).appendTo(place);
        var select = $('&lt;select name="mode" /&gt;').appendTo(container)[0];
        $('&lt;option value="private" selected&gt;private&lt;/a&gt;').appendTo(select);
        $('&lt;option value="public"&gt;public&lt;/a&gt;').appendTo(select);
        wizard.setValue("importmode", select);
        _createForm.apply(this, [place, wizard, iframeName]);
    };

    var _onGet = config.macros.importTiddlers.onGetTiddler;
    config.macros.importTiddlers.onGetTiddler = function(context, wizard) {
        var type = $(wizard.getValue("importmode")).val();
        var ws =  plugin.getCurrentWorkspace(type);
        wizard.setValue("workspace", ws);
        _onGet.apply(this, [context, wizard]);
    };
}

config.extensions.ServerSideSavingPlugin.reportSuccess = function(msg, tiddler) {
    plugin.checkSyncStatus(tiddler);
    msg = config.extensions.ServerSideSavingPlugin.locale[msg];
    var link = "/" + encodeURIComponent(tiddler.title);
    displayMessage(msg.format([tiddler.title]), link);
};


})(jQuery);
//}}}</pre>
</div>

<div title="TiddlyWebAdaptor">
<pre>/***
|''Name''|TiddlyWebAdaptor|
|''Description''|adaptor for interacting with TiddlyWeb|
|''Author:''|FND|
|''Contributors''|Chris Dent, Martin Budden|
|''Version''|1.4.10|
|''Status''|stable|
|''Source''|http://svn.tiddlywiki.org/Trunk/association/adaptors/TiddlyWebAdaptor.js|
|''CodeRepository''|http://svn.tiddlywiki.org/Trunk/association/|
|''License''|[[BSD|http://www.opensource.org/licenses/bsd-license.php]]|
|''CoreVersion''|2.5|
|''Keywords''|serverSide TiddlyWeb|
!Notes
This plugin includes [[jQuery JSON|http://code.google.com/p/jquery-json/]].
!To Do
* createWorkspace
* document custom/optional context attributes (e.g. filters, query, revision) and tiddler fields (e.g. server.title, origin)
!Code
***/
//{{{
(function($) {

var adaptor = config.adaptors.tiddlyweb = function() {};

adaptor.prototype = new AdaptorBase();
adaptor.serverType = "tiddlyweb";
adaptor.serverLabel = "TiddlyWeb";
adaptor.mimeType = "application/json";

adaptor.parsingErrorMessage = "Error parsing result from server";
adaptor.noBagErrorMessage = "no bag specified for tiddler";
adaptor.locationIDErrorMessage = "no bag or recipe specified for tiddler"; // TODO: rename

// retrieve current status (requires TiddlyWeb status plugin)
adaptor.prototype.getStatus = function(context, userParams, callback) {
    context = this.setContext(context, userParams, callback);
    var uriTemplate = "%0/status";
    var uri = uriTemplate.format([context.host]);
    var req = httpReq("GET", uri, adaptor.getStatusCallback, context,
        null, null, null, null, null, true);
    return typeof req == "string" ? req : true;
};

adaptor.getStatusCallback = function(status, context, responseText, uri, xhr) {
    context.status = responseText ? status : false;
    try {
        context.statusText = xhr.statusText;
    } catch(exc) { // offline (Firefox)
        context.status = false;
        context.statusText = null;
    }
    context.httpStatus = xhr.status;
    if(context.status) {
        context.serverStatus = $.evalJSON(responseText); // XXX: error handling!?
    }
    if(context.callback) {
        context.callback(context, context.userParams);
    }
};

// retrieve a list of workspaces
adaptor.prototype.getWorkspaceList = function(context, userParams, callback) {
    context = this.setContext(context, userParams, callback);
    context.workspaces = [];
    var uriTemplate = "%0/recipes"; // XXX: bags?
    var uri = uriTemplate.format([context.host]);
    var req = httpReq("GET", uri, adaptor.getWorkspaceListCallback,
        context, { accept: adaptor.mimeType }, null, null, null, null, true);
    return typeof req == "string" ? req : true;
};

adaptor.getWorkspaceListCallback = function(status, context, responseText, uri, xhr) {
    context.status = status;
    context.statusText = xhr.statusText;
    context.httpStatus = xhr.status;
    if(status) {
        try {
            var workspaces = $.evalJSON(responseText);
        } catch(ex) {
            context.status = false; // XXX: correct?
            context.statusText = exceptionText(ex, adaptor.parsingErrorMessage);
            if(context.callback) {
                context.callback(context, context.userParams);
            }
            return;
        }
        context.workspaces = workspaces.map(function(itm) { return { title: itm }; });
    }
    if(context.callback) {
        context.callback(context, context.userParams);
    }
};

// retrieve a list of tiddlers
adaptor.prototype.getTiddlerList = function(context, userParams, callback) {
    context = this.setContext(context, userParams, callback);
    var uriTemplate = "%0/%1/%2/tiddlers%3";
    var params = context.filters ? "?" + context.filters : "";
    if(context.format) {
        params = context.format + params;
    }
    var workspace = adaptor.resolveWorkspace(context.workspace);
    var uri = uriTemplate.format([context.host, workspace.type + "s",
        adaptor.normalizeTitle(workspace.name), params]);
    var req = httpReq("GET", uri, adaptor.getTiddlerListCallback,
        context, merge({ accept: adaptor.mimeType }, context.headers), null, null, null, null, true);
    return typeof req == "string" ? req : true;
};

adaptor.getTiddlerListCallback = function(status, context, responseText, uri, xhr) {
    context.status = status;
    context.statusText = xhr.statusText;
    context.httpStatus = xhr.status;
    if(status) {
        context.tiddlers = [];
        try {
            var tiddlers = $.evalJSON(responseText); //# NB: not actual tiddler instances
        } catch(ex) {
            context.status = false; // XXX: correct?
            context.statusText = exceptionText(ex, adaptor.parsingErrorMessage);
            if(context.callback) {
                context.callback(context, context.userParams);
            }
            return;
        }
        for(var i = 0; i &lt; tiddlers.length; i++) {
            var tiddler = adaptor.toTiddler(tiddlers[i], context.host);
            context.tiddlers.push(tiddler);
        }
    }
    if(context.callback) {
        context.callback(context, context.userParams);
    }
};

// perform global search
adaptor.prototype.getSearchResults = function(context, userParams, callback) {
    context = this.setContext(context, userParams, callback);
    var uriTemplate = "%0/search?q=%1%2";
    var filterString = context.filters ? ";" + context.filters : "";
    var uri = uriTemplate.format([context.host, context.query, filterString]); // XXX: parameters need escaping?
    var req = httpReq("GET", uri, adaptor.getSearchResultsCallback,
        context, { accept: adaptor.mimeType }, null, null, null, null, true);
    return typeof req == "string" ? req : true;
};

adaptor.getSearchResultsCallback = function(status, context, responseText, uri, xhr) {
    adaptor.getTiddlerListCallback(status, context, responseText, uri, xhr); // XXX: use apply?
};

// retrieve a particular tiddler's revisions
adaptor.prototype.getTiddlerRevisionList = function(title, limit, context, userParams, callback) {
    context = this.setContext(context, userParams, callback);
    var uriTemplate = "%0/%1/%2/tiddlers/%3/revisions";
    var workspace = adaptor.resolveWorkspace(context.workspace);
    var uri = uriTemplate.format([context.host, workspace.type + "s",
        adaptor.normalizeTitle(workspace.name), adaptor.normalizeTitle(title)]);
    var req = httpReq("GET", uri, adaptor.getTiddlerRevisionListCallback,
        context, merge({ accept: adaptor.mimeType }, context.headers), null, null, null, null, true);
    return typeof req == "string" ? req : true;
};

adaptor.getTiddlerRevisionListCallback = function(status, context, responseText, uri, xhr) {
    context.status = status;
    context.statusText = xhr.statusText;
    context.httpStatus = xhr.status;
    if(status) {
        context.revisions = [];
        try {
            var tiddlers = $.evalJSON(responseText); //# NB: not actual tiddler instances
        } catch(ex) {
            context.status = false; // XXX: correct?
            context.statusText = exceptionText(ex, adaptor.parsingErrorMessage);
            if(context.callback) {
                context.callback(context, context.userParams);
            }
            return;
        }
        for(var i = 0; i &lt; tiddlers.length; i++) {
            var tiddler = adaptor.toTiddler(tiddlers[i], context.host);
            context.revisions.push(tiddler);
        }
        var sortField = "server.page.revision";
        context.revisions.sort(function(a, b) {
            return a.fields[sortField] &lt; b.fields[sortField] ? 1 :
                (a.fields[sortField] == b.fields[sortField] ? 0 : -1);
        });
    }
    if(context.callback) {
        context.callback(context, context.userParams);
    }
};

// retrieve an individual tiddler revision -- XXX: breaks with standard arguments list -- XXX: convenience function; simply use getTiddler?
adaptor.prototype.getTiddlerRevision = function(title, revision, context, userParams, callback) {
    context = this.setContext(context, userParams, callback);
    context.revision = revision;
    return this.getTiddler(title, context, userParams, callback);
};

// retrieve an individual tiddler
//# context is an object with members host and workspace
//# callback is passed the new context and userParams
adaptor.prototype.getTiddler = function(title, context, userParams, callback) {
    context = this.setContext(context, userParams, callback);
    context.title = title;
    if(context.revision) {
        var uriTemplate = "%0/%1/%2/tiddlers/%3/revisions/%4";
    } else {
        uriTemplate = "%0/%1/%2/tiddlers/%3";
    }
    if(!context.tiddler) {
        context.tiddler = new Tiddler(title);
    }
    context.tiddler.fields["server.type"] = adaptor.serverType;
    context.tiddler.fields["server.host"] = AdaptorBase.minHostName(context.host);
    context.tiddler.fields["server.workspace"] = context.workspace;
    var workspace = adaptor.resolveWorkspace(context.workspace);
    var uri = uriTemplate.format([context.host, workspace.type + "s",
        adaptor.normalizeTitle(workspace.name), adaptor.normalizeTitle(title),
        context.revision]);
    var req = httpReq("GET", uri, adaptor.getTiddlerCallback, context,
        merge({ accept: adaptor.mimeType }, context.headers), null, null, null, null, true);
    return typeof req == "string" ? req : true;
};

adaptor.getTiddlerCallback = function(status, context, responseText, uri, xhr) {
    context.status = status;
    context.statusText = xhr.statusText;
    context.httpStatus = xhr.status;
    if(status) {
        try {
            var tid = $.evalJSON(responseText);
        } catch(ex) {
            context.status = false;
            context.statusText = exceptionText(ex, adaptor.parsingErrorMessage);
            if(context.callback) {
                context.callback(context, context.userParams);
            }
            return;
        }
        var tiddler = adaptor.toTiddler(tid, context.host);
        tiddler.title = context.tiddler.title;
        tiddler.fields["server.etag"] = xhr.getResponseHeader("Etag");
        // normally we'd assign context.tiddler = tiddler here - but we can't do
        // that because of IE, which triggers getTiddler in putTiddlerCallback,
        // and since ServerSideSavingPlugin foolishly relies on persistent
        // object references, we need to merge the data into the existing object
        $.extend(context.tiddler, tiddler);
    }
    if(context.callback) {
        context.callback(context, context.userParams);
    }
};

// retrieve tiddler chronicle (all revisions)
adaptor.prototype.getTiddlerChronicle = function(title, context, userParams, callback) {
    context = this.setContext(context, userParams, callback);
    context.title = title;
    var uriTemplate = "%0/%1/%2/tiddlers/%3/revisions?fat=1";
    var workspace = adaptor.resolveWorkspace(context.workspace);
    var uri = uriTemplate.format([context.host, workspace.type + "s",
        adaptor.normalizeTitle(workspace.name), adaptor.normalizeTitle(title)]);
    var req = httpReq("GET", uri, adaptor.getTiddlerChronicleCallback,
        context, { accept: adaptor.mimeType }, null, null, null, null, true);
    return typeof req == "string" ? req : true;
};

adaptor.getTiddlerChronicleCallback = function(status, context, responseText, uri, xhr) {
    context.status = status;
    context.statusText = xhr.statusText;
    context.httpStatus = xhr.status;
    if(status) {
        context.responseText = responseText;
    }
    if(context.callback) {
        context.callback(context, context.userParams);
    }
};

// store an individual tiddler
adaptor.prototype.putTiddler = function(tiddler, context, userParams, callback) {
    context = this.setContext(context, userParams, callback);
    context.title = tiddler.title;
    context.tiddler = tiddler;
    context.host = context.host || this.fullHostName(tiddler.fields["server.host"]);
    var uriTemplate = "%0/%1/%2/tiddlers/%3";
    try {
        context.workspace = context.workspace || tiddler.fields["server.workspace"];
        var workspace = adaptor.resolveWorkspace(context.workspace);
    } catch(ex) {
        return adaptor.locationIDErrorMessage;
    }
    var uri = uriTemplate.format([context.host, workspace.type + "s",
        adaptor.normalizeTitle(workspace.name),
        adaptor.normalizeTitle(tiddler.title)]);
    var etag = adaptor.generateETag(workspace, tiddler);
    var headers = etag ? { "If-Match": etag } : null;
    var payload = {
        type: tiddler.fields["server.content-type"] || null,
        text: tiddler.text,
        tags: tiddler.tags,
        fields: $.extend({}, tiddler.fields)
    };
    delete payload.fields.changecount;
    $.each(payload.fields, function(key, value) {
        if(key.indexOf("server.") == 0) {
            delete payload.fields[key];
        }
    });
    payload = $.toJSON(payload);
    var req = httpReq("PUT", uri, adaptor.putTiddlerCallback,
        context, headers, payload, adaptor.mimeType, null, null, true);
    return typeof req == "string" ? req : true;
};

adaptor.putTiddlerCallback = function(status, context, responseText, uri, xhr) {
    context.status = [204, 1223].contains(xhr.status);
    context.statusText = xhr.statusText;
    context.httpStatus = xhr.status;
    if(context.status) {
        var loc = xhr.getResponseHeader("Location");
        var etag = xhr.getResponseHeader("Etag");
        if(loc &amp;&amp; etag) {
            var bag = loc.split("/bags/").pop().split("/")[0];
            context.tiddler.fields["server.bag"] = bag;
            context.tiddler.fields["server.workspace"] = "bags/" + bag;
            var rev = etag.split("/").pop().split(/;|:/)[0];
            context.tiddler.fields["server.page.revision"] = rev;
            context.tiddler.fields["server.etag"] = etag;
            if(context.callback) {
                context.callback(context, context.userParams);
            }
        } else { // IE
            context.adaptor.getTiddler(context.tiddler.title, context,
                context.userParams, context.callback);
        }
    } else if(context.callback) {
        context.callback(context, context.userParams);
    }
};

// store a tiddler chronicle
adaptor.prototype.putTiddlerChronicle = function(revisions, context, userParams, callback) {
    context = this.setContext(context, userParams, callback);
    context.title = revisions[0].title;
    var headers = null;
    var uriTemplate = "%0/%1/%2/tiddlers/%3/revisions";
    var host = context.host || this.fullHostName(tiddler.fields["server.host"]);
    var workspace = adaptor.resolveWorkspace(context.workspace);
    var uri = uriTemplate.format([host, workspace.type + "s",
        adaptor.normalizeTitle(workspace.name),
        adaptor.normalizeTitle(context.title)]);
    if(workspace.type == "bag") { // generate ETag
        var etag = [adaptor.normalizeTitle(workspace.name),
            adaptor.normalizeTitle(context.title), 0].join("/"); //# zero-revision prevents overwriting existing contents
        headers = { "If-Match": '"' + etag + '"' };
    }
    var payload = $.toJSON(revisions);
    var req = httpReq("POST", uri, adaptor.putTiddlerChronicleCallback,
        context, headers, payload, adaptor.mimeType, null, null, true);
    return typeof req == "string" ? req : true;
};

adaptor.putTiddlerChronicleCallback = function(status, context, responseText, uri, xhr) {
    context.status = [204, 1223].contains(xhr.status);
    context.statusText = xhr.statusText;
    context.httpStatus = xhr.status;
    if(context.callback) {
        context.callback(context, context.userParams);
    }
};

// store a collection of tiddlers (import TiddlyWiki HTML store)
adaptor.prototype.putTiddlerStore = function(store, context, userParams, callback) {
    context = this.setContext(context, userParams, callback);
    var uriTemplate = "%0/%1/%2/tiddlers";
    var host = context.host;
    var workspace = adaptor.resolveWorkspace(context.workspace);
    var uri = uriTemplate.format([host, workspace.type + "s",
        adaptor.normalizeTitle(workspace.name)]);
    var req = httpReq("POST", uri, adaptor.putTiddlerStoreCallback,
        context, null, store, "text/x-tiddlywiki", null, null, true);
    return typeof req == "string" ? req : true;
};

adaptor.putTiddlerStoreCallback = function(status, context, responseText, uri, xhr) {
    context.status = [204, 1223].contains(xhr.status);
    context.statusText = xhr.statusText;
    context.httpStatus = xhr.status;
    if(context.callback) {
        context.callback(context, context.userParams);
    }
};

// rename an individual tiddler or move it to a different workspace -- TODO: make {from|to}.title optional
//# from and to are objects with members title and workspace (bag; optional),
//# representing source and target tiddler, respectively
adaptor.prototype.moveTiddler = function(from, to, context, userParams, callback) { // XXX: rename parameters (old/new)?
    var self = this;
    var newTiddler = store.getTiddler(from.title) || store.getTiddler(to.title); //# local rename might already have occurred
    var oldTiddler = $.extend(true, {}, newTiddler); //# required for eventual deletion
    oldTiddler.title = from.title; //# required for original tiddler's ETag
    var _getTiddlerChronicle = function(title, context, userParams, callback) {
        return self.getTiddlerChronicle(title, context, userParams, callback);
    };
    var _putTiddlerChronicle = function(context, userParams) {
        if(!context.status) {
            return callback(context, userParams);
        }
        var revisions = $.evalJSON(context.responseText); // XXX: error handling?
        // change current title while retaining previous location
        for(var i = 0; i &lt; revisions.length; i++) {
            delete revisions[i].revision;
            if(!revisions[i].fields.origin) { // NB: origin = "&lt;workspace&gt;/&lt;title&gt;"
                revisions[i].fields.origin = ["bags", revisions[i].bag, revisions[i].title].join("/");
            }
            revisions[i].title = to.title;
        }
        // add new revision
        var rev = $.extend({}, revisions[0]);
        $.each(newTiddler, function(i, item) {
            if(!$.isFunction(item)) {
                rev[i] = item;
            }
        });
        rev.title = to.title;
        rev.created = rev.created.convertToYYYYMMDDHHMM();
        rev.modified = new Date().convertToYYYYMMDDHHMM();
        delete rev.fields.changecount;
        revisions.unshift(rev);
        if(to.workspace) {
            context.workspace = to.workspace;
        } else if(context.workspace.substring(0, 4) != "bags") { // NB: target workspace must be a bag
            context.workspace = "bags/" + rev.bag;
        }
        var subCallback = function(context, userParams) {
            if(!context.status) {
                return callback(context, userParams);
            }
            context.adaptor.getTiddler(newTiddler.title, context, userParams, _deleteTiddler);
        };
        return self.putTiddlerChronicle(revisions, context, context.userParams, subCallback);
    };
    var _deleteTiddler = function(context, userParams) {
        if(!context.status) {
            return callback(context, userParams);
        }
        $.extend(true, newTiddler, context.tiddler);
        context.callback = null;
        return self.deleteTiddler(oldTiddler, context, context.userParams, callback);
    };
    callback = callback || function() {};
    context = this.setContext(context, userParams);
    context.host = context.host || oldTiddler.fields["server.host"];
    context.workspace = from.workspace || oldTiddler.fields["server.workspace"];
    return _getTiddlerChronicle(from.title, context, userParams, _putTiddlerChronicle);
};

// delete an individual tiddler
adaptor.prototype.deleteTiddler = function(tiddler, context, userParams, callback) {
    context = this.setContext(context, userParams, callback);
    context.title = tiddler.title; // XXX: not required!?
    var uriTemplate = "%0/bags/%1/tiddlers/%2";
    var host = context.host || this.fullHostName(tiddler.fields["server.host"]);
    var bag = tiddler.fields["server.bag"];
    if(!bag) {
        return adaptor.noBagErrorMessage;
    }
    var uri = uriTemplate.format([host, adaptor.normalizeTitle(bag),
        adaptor.normalizeTitle(tiddler.title)]);
    var etag = adaptor.generateETag({ type: "bag", name: bag }, tiddler);
    var headers = etag ? { "If-Match": etag } : null;
    var req = httpReq("DELETE", uri, adaptor.deleteTiddlerCallback, context, headers,
        null, null, null, null, true);
    return typeof req == "string" ? req : true;
};

adaptor.deleteTiddlerCallback = function(status, context, responseText, uri, xhr) {
    context.status = [204, 1223].contains(xhr.status);
    context.statusText = xhr.statusText;
    context.httpStatus = xhr.status;
    if(context.callback) {
        context.callback(context, context.userParams);
    }
};

// compare two revisions of a tiddler (requires TiddlyWeb differ plugin)
//# if context.rev1 is not specified, the latest revision will be used for comparison
//# if context.rev2 is not specified, the local revision will be sent for comparison
//# context.format is a string as determined by the TiddlyWeb differ plugin
adaptor.prototype.getTiddlerDiff = function(title, context, userParams, callback) {
    context = this.setContext(context, userParams, callback);
    context.title = title;

    var tiddler = store.getTiddler(title);
    try {
        var workspace = adaptor.resolveWorkspace(tiddler.fields["server.workspace"]);
    } catch(ex) {
        return adaptor.locationIDErrorMessage;
    }
    var tiddlerRef = [workspace.type + "s", workspace.name, tiddler.title].join("/");

    var rev1 = context.rev1 ? [tiddlerRef, context.rev1].join("/") : tiddlerRef;
    var rev2 = context.rev2 ? [tiddlerRef, context.rev2].join("/") : null;

    var uriTemplate = "%0/diff?rev1=%1";
    if(rev2) {
        uriTemplate += "&amp;rev2=%2";
    }
    if(context.format) {
        uriTemplate += "&amp;format=%3";
    }
    var host = context.host || this.fullHostName(tiddler.fields["server.host"]);
    var uri = uriTemplate.format([host, adaptor.normalizeTitle(rev1),
        adaptor.normalizeTitle(rev2), context.format]);

    if(rev2) {
        var req = httpReq("GET", uri, adaptor.getTiddlerDiffCallback, context, null,
            null, null, null, null, true);
    } else {
        var payload = {
            title: tiddler.title,
            text: tiddler.text,
            modifier: tiddler.modifier,
            tags: tiddler.tags,
            fields: $.extend({}, tiddler.fields)
        }; // XXX: missing attributes!?
        payload = $.toJSON(payload);
        req = httpReq("POST", uri, adaptor.getTiddlerDiffCallback, context,
            null, payload, adaptor.mimeType, null, null, true);
    }
    return typeof req == "string" ? req : true;
};

adaptor.getTiddlerDiffCallback = function(status, context, responseText, uri, xhr) {
    context.status = status;
    context.statusText = xhr.statusText;
    context.httpStatus = xhr.status;
    context.uri = uri;
    if(status) {
        context.diff = responseText;
    }
    if(context.callback) {
        context.callback(context, context.userParams);
    }
};

// generate tiddler information
adaptor.prototype.generateTiddlerInfo = function(tiddler) {
    var info = {};
    var uriTemplate = "%0/%1/%2/tiddlers/%3";
    var host = this.host || tiddler.fields["server.host"]; // XXX: this.host obsolete?
    host = this.fullHostName(host);
    var workspace = adaptor.resolveWorkspace(tiddler.fields["server.workspace"]);
    info.uri = uriTemplate.format([host, workspace.type + "s",
        adaptor.normalizeTitle(workspace.name),
        adaptor.normalizeTitle(tiddler.title)]);
    return info;
};

// create Tiddler instance from TiddlyWeb tiddler JSON
adaptor.toTiddler = function(json, host) {
    var created = Date.convertFromYYYYMMDDHHMM(json.created);
    var modified = Date.convertFromYYYYMMDDHHMM(json.modified);
    var fields = json.fields;
    fields["server.type"] = adaptor.serverType;
    fields["server.host"] = AdaptorBase.minHostName(host);
    fields["server.bag"] = json.bag;
    fields["server.title"] = json.title;
    if(json.recipe) {
        fields["server.recipe"] = json.recipe;
    }
    if(json.type &amp;&amp; json.type != "None") {
        fields["server.content-type"] = json.type;
    }
    fields["server.permissions"] = json.permissions.join(", ");
    fields["server.page.revision"] = json.revision;
    fields["server.workspace"] = "bags/" + json.bag;
    var tiddler = new Tiddler(json.title);
    tiddler.assign(tiddler.title, json.text, json.modifier, modified, json.tags,
        created, json.fields, json.creator);
    return tiddler;
};

adaptor.resolveWorkspace = function(workspace) {
    var components = workspace.split("/");
    return {
        type: components[0] == "bags" ? "bag" : "recipe",
        name: components[1] || components[0]
    };
};

adaptor.generateETag = function(workspace, tiddler) {
    var revision = tiddler.fields["server.page.revision"];
    var etag = revision == "false" ? null : tiddler.fields["server.etag"];
    if(!etag &amp;&amp; workspace.type == "bag") {
        if(typeof revision == "undefined") {
            revision = "0";
        } else if(revision == "false") {
            return null;
        }
        etag = [adaptor.normalizeTitle(workspace.name),
            adaptor.normalizeTitle(tiddler.title), revision].join("/");
        etag = '"' + etag + '"';
    }
    return etag;
};

adaptor.normalizeTitle = function(title) {
    return encodeURIComponent(title);
};

})(jQuery);


/*
 * jQuery JSON Plugin
 * version: 1.3
 * source: http://code.google.com/p/jquery-json/
 * license: MIT (http://www.opensource.org/licenses/mit-license.php)
 */
(function($){function toIntegersAtLease(n)
{return n&lt;10?'0'+n:n;}
Date.prototype.toJSON=function(date)
{return this.getUTCFullYear()+'-'+
toIntegersAtLease(this.getUTCMonth())+'-'+
toIntegersAtLease(this.getUTCDate());};var escapeable=/["\\\x00-\x1f\x7f-\x9f]/g;var meta={'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'};$.quoteString=function(string)
{if(escapeable.test(string))
{return'"'+string.replace(escapeable,function(a)
{var c=meta[a];if(typeof c==='string'){return c;}
c=a.charCodeAt();return'\\u00'+Math.floor(c/16).toString(16)+(c%16).toString(16);})+'"';}
return'"'+string+'"';};$.toJSON=function(o,compact)
{var type=typeof(o);if(type=="undefined")
return"undefined";else if(type=="number"||type=="boolean")
return o+"";else if(o===null)
return"null";if(type=="string")
{return $.quoteString(o);}
if(type=="object"&amp;&amp;typeof o.toJSON=="function")
return o.toJSON(compact);if(type!="function"&amp;&amp;typeof(o.length)=="number")
{var ret=[];for(var i=0;i&lt;o.length;i++){ret.push($.toJSON(o[i],compact));}
if(compact)
return"["+ret.join(",")+"]";else
return"["+ret.join(", ")+"]";}
if(type=="function"){throw new TypeError("Unable to convert object of type 'function' to json.");}
var ret=[];for(var k in o){var name;type=typeof(k);if(type=="number")
name='"'+k+'"';else if(type=="string")
name=$.quoteString(k);else
continue;var val=$.toJSON(o[k],compact);if(typeof(val)!="string"){continue;}
if(compact)
ret.push(name+":"+val);else
ret.push(name+": "+val);}
return"{"+ret.join(", ")+"}";};$.compactJSON=function(o)
{return $.toJSON(o,true);};$.evalJSON=function(src)
{return eval("("+src+")");};$.secureEvalJSON=function(src)
{var filtered=src;filtered=filtered.replace(/\\["\\\/bfnrtu]/g,'@');filtered=filtered.replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']');filtered=filtered.replace(/(?:^|:|,)(?:\s*\[)+/g,'');if(/^[\],:{}\s]*$/.test(filtered))
return eval("("+src+")");else
throw new SyntaxError("Error parsing JSON, source is not valid.");};})(jQuery);
//}}}</pre>
</div>

<div title="SiteIcon">
<pre>htmlimgsrchttp//pearltiddlyspacecom/bags/pearlpublic/tiddlers/SiteIcon//html</pre>
</div>

<div title="StyleSheetTiddler">
<pre>/*{{{*/
.tiddler .originButton div {
    display: inline-block;
}

.tiddler .spaceSiteIcon .siteIcon {
    _display: inline; /* IE doesn't like inline-block */
}

.tiddler .originButton {
    display: block;
}

.selected .tagging,
.selected .tagging:hover {
    border: none;
    background: none;
}

.tagging {
    float: none;
    background: none;
    border: none;
}

.tagging li.listTitle {
    margin-left: 0px;
}
.tagging li {
    margin: 0 8px;
}

.tagging .tiddlyLink {
    -webkit-border-radius: 3px;
    -moz-border-radius: 3px;
    -o-border-radius: 3px;
    border-radius: 3px;
    padding: 1px 2px;
    line-height: 1.2em;
}

/* for following */
#popup .siteIcon {
    float: left;
    height: 25px;
}

.content {
    width: 100%; /* IE */
    font-size: 0.9em;
}

.editorHeading {
    height: 48px;
}

.heading {
    left: 0;
    margin-bottom: 40px;
    position: relative;
    top: 32px;
}

.followButton a {
    display: block;
    margin-top: -20px;
}

.tiddler .followPlaceHolder {
    display: block;
    position: absolute;
    top: 16px;
    right: 64px;
    _right: 138px; // add width of modifierIcon
}

.tiddler .followButton {
    position: relative;
    height: 24px;
    text-align: left;
    color: #fff;
    background: [[ColorPalette::PrimaryMid]];
    padding: 10px 0px 0px 10px;
    width: 38px;
    margin: -16px -8px 24px 0;
}

/* creates the larger triangle */
.followButton:before {
    content: "\00a0";
    display: block; /* reduce the damage in FF3.0 */
    position: relative;
    bottom: -20px;
    right: 0;
    width: 0;
    height: 0;
    border-width: 0 0 20px 20px;
    border-style: solid;
    border-color: transparent [[ColorPalette::PrimaryMid]];
}

.toolbar svg {
    height: 16px;
    width: 16px;
}

.toolbar svg .glyph {
    fill: #ccc;
}

.toolbar a:hover .glyph {
    fill: black;
}

.toolbar a:active .glyph {
    fill: [[ColorPalette::Background]];
}

.originButton,
.followPlaceHolder,
.tiddler .subtitle {
    cursor: pointer;
}

.editSpaceSiteIcon .originButton {
    cursor: auto;
}

.tiddler .subtitle:hover {
    font-weight: bold;
    background: none;
}

.originButton img,
.originButton svg {
    margin-left: 0px;
}

.modifierIcon {
    position: absolute;
    width: 74px;
    top: 0px;
    right: 0px;
    _right: 74px; /* in IE6 positioning works incorrectly so use -width instead */
    text-align: right;
}

.modifierIcon img,
.modifierIcon svg {
    margin-right: 8px;
}

.tiddler .viewer {
    padding-bottom: 16px;
    margin: 0 0 0 56px;
    line-height: 1.4em;
}

.viewer pre {
    margin-left: 0;
}

.siteIcon .label {
    color: [[ColorPalette::TertiaryDark]];
}

.tiddler .spaceSiteIcon {
    float: left;
    margin-right: 0;
    margin-top: 0;
    position: relative;
    display: block;
}

.tiddler .titleBar {
    display: block;
    margin-right: 136px;
    margin-left: 56px;
}

.followButton a {
    color: [[ColorPalette::Background]];
}

.tiddler {
    position: relative;
    padding: 0;
    margin-bottom: 3em;
    border-top: 3px solid [[ColorPalette::PrimaryMid]];
    background: #fff;
}

.tiddler .editor {
    padding: 0px 8px;
}

.tiddler .heading .title {
    position: relative;
    display: block;
    word-wrap: break-word;
    font-size: 32px;
    line-height: 32px;
}
.tiddler .heading .editor.title {
    font-size: 1.7em;
    line-height: normal;
}

.tiddler .headingClear {
    clear: both;
}

.tiddler .subtitle {
    font-style: italic;
    font-size: 0.9em;
    color: #a6a59e;
    margin-top: 0;
}

.toolbar {
    position: absolute;
    padding: 0;
    top: 8px;
    right: -8px;
}

.toolbar .moreCommand.highlight {
    background: none;
}

.tiddler .toolbar .button {
    border: none;
    display: inline;
    padding: 0px;
    margin-right: 16px;
}

.tiddler .toolbar a:hover {
    background: none;
}

.tiddler .tagged .listTitle {
    display: none;
}

.revButton {
    float: right;
}

/*! EditTemplate specific*/
.tiddler .privacySettings {
    text-align: center;
}
.tiddler .privacySettings .originButton {
    display: inline;
}

.editSpaceSiteIcon, .privacyEdit {
    float: left;
}

.editSpaceSiteIcon svg,
.editSpaceSiteIcon img,
.editSpaceSiteIcon .roundelLabel {
    float: left;
}

.tagTitle {
    position: absolute;
    text-align: center;
    width: 48px;
    top: 0px;
    left: -56px;
}

.editSpaceSiteIcon .originButton img,
.editSpaceSiteIcon .originButton svg {
    height: 16px;
    margin-left: 24px;
    margin-right: 32px;
    width: 16px;
}

.tagAnnotation {
    margin-top: 8px;
    padding-bottom: 8px;
}
.annotationsBox {
    margin-top: 8px;
}

.editorFooter {
    position: relative;
    padding: 0;
    margin-top: 16px;
    margin-left: 64px;
}

.tiddler .editorFooter .editor {
    padding-left: 0px;
}

.heading .editor input {
    width: 100%;
    font-size: 1.5em;
}

.spaceSiteIcon .externalImage .image a:hover,
.modifierIcon .externalImage .image a:hover {
    background: none;
}

div.toolbar {
    visibility:hidden;
    right:-16px;
}

.selected div.toolbar {
    visibility: visible;
}

.followButton a:hover {
    background: [[ColorPalette::PrimaryMid]];
    text-decoration: underline;
}

a.image:hover {
    background: transparent;
}

@media all and (max-device-width: 480px) {
    div.toolbar {
        visibility:visible;
    }
}
@media only screen and (device-width: 768px) {
    div.toolbar {
        visibility:visible;
    }
}
@media all and (max-width: 960px) {
    .tiddler .titleBar {
        margin-left: 36px;
        margin-right: 80px;
    }

    .tiddler .heading {
        margin-bottom: 48px;
    }

    .tiddler .heading .title {
        font-size: 32px;
        line-height: 32px;
    }

    .tiddler .modifierIcon img,
    .tiddler .modifierIcon svg,
    .tiddler .spaceSiteIcon .originButton img,
    .originButton svg {
        width: 32px;
        height: 32px;
        margin-left: 0px;
        margin-right: 0px;
    }

    .tiddler .followPlaceHolder {
        right: 48px;
    }

    .tiddler .followButton {
        width: 24px;
    }

    .tiddler .viewer {
        margin: 0px 0px 0px 36px;
        padding-top: 0;
    }

    br {
        line-height: 0.5em;
    }
}
/*}}}*/</pre>
</div>

<div title="FollowTiddlersBlackList">
<pre>ColorPalette
StyleSheet
SiteSubtitle
GettingStarted
SiteTitle
MainMenu
SiteIcon
DefaultTiddlers
ViewTemplate
PageTemplate
SideBarOptions
EditTemplate
SiteInfo
SideBarTabs
ToolbarCommands</pre>
</div>

<div title="spaceTitle">
<pre>The title and subtitle of your space are visible to visitors and are also displayed in your browser's tabs. Click on the SiteTitle and SiteSubtitle tiddler links below to make changes.
* [[SiteTitle]]
* [[SiteSubtitle]]</pre>
</div>

<div title="SiteInfo">
<pre> pearl</pre>
</div>

<div title="DefaultTiddlers">
<pre>[[迪伦的荒原世界]]</pre>
</div>

<div title="RevisionTemplate">
<pre>&lt;!--{{{--&gt;
&lt;div macro='slideRevision'&gt;&lt;/div&gt;
&lt;div class='heading'&gt;
    &lt;span class="titleBar"&gt;
        &lt;div class='title' macro='view title text'&gt;&lt;/div&gt;
    &lt;/span&gt;
    &lt;span class='modifierIcon'
        macro='view modifier SiteIcon label:no height:48 width:48 preserveAspectRatio:yes'&gt;
    &lt;/span&gt;
    &lt;div class='toolbar'
        macro='toolbar [[ToolbarCommands::RevisionToolbar]] icons:yes height:48 width:48 more:popup'&gt;
    &lt;/div&gt;
    &lt;div class='tagClear'&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class='content'&gt;
    &lt;div class='viewer' macro='view text wikified'&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class='tagInfo'&gt;
    &lt;div class='tidTags' macro='tags'&gt;&lt;/div&gt;
    &lt;div class='tagging' macro='tagging'&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!--}}}--&gt;</pre>
</div>

<div title="GettingStarted">
<pre>To get started with this blank [[TiddlyWiki]], you'll need to modify the following tiddlers:
* [[SiteTitle]] &amp; [[SiteSubtitle]]: The title and subtitle of the site, as shown above (after saving, they will also appear in the browser title bar)
* [[MainMenu]]: The menu (usually on the left)
* [[DefaultTiddlers]]: Contains the names of the tiddlers that you want to appear when the TiddlyWiki is opened
You'll also need to enter your username for signing your edits: &lt;&lt;option txtUserName&gt;&gt;
</pre>
</div>

<div title="TiddlySpacePublishingCommands">
<pre>/***
|''Name''|TiddlySpacePublishingCommands|
|''Version''|0.8.5|
|''Status''|@@beta@@|
|''Description''|toolbar commands for drafting and publishing|
|''Author''|Jon Robson|
|''Source''|http://github.com/TiddlySpace/tiddlyspace/raw/master/src/plugins/TiddlySpacePublishingCommands.js|
|''CoreVersion''|2.6.1|
|''Requires''|TiddlySpaceConfig TiddlySpaceFilters|
!Usage
Provides changeToPrivate, changeToPublic and saveDraft commands
Provides TiddlySpacePublisher macro.
{{{&lt;&lt;TiddlySpacePublisher type:private&gt;&gt;}}} make lots of private tiddlers public.
{{{&lt;&lt;TiddlySpacePublisher type:public&gt;&gt;}}} make lots of public tiddlers public.
!TODO
* add public argument?
!Code
***/
//{{{
(function($) {

var tiddlyspace = config.extensions.tiddlyspace;
var originMacro = config.macros.tiddlerOrigin;

tiddlyspace.getTiddlerStatusType = function(tiddler) {
    var isShadow = store.isShadowTiddler(tiddler.title);
    var exists = store.tiddlerExists(tiddler.title);
    if(isShadow &amp;&amp; !exists) {
        return "shadow";
    } else if(!exists) {
        return "missing";
    } else {
        var types = ["private", "public"];
        var type = "external";
        for(var i = 0; i &lt; types.length; i++) {
            var t = types[i];
            type = config.filterHelpers.is[t](tiddler) ? t : type;
        }
        if(config.filterHelpers.is.unsynced(tiddler)) {
            type = type == "private" ? "unsyncedPrivate" : "unsyncedPublic";
        }
        return type;
    }
};

var cmd = config.commands.publishTiddler = {
    text: "make public",
    tooltip: "Change this private tiddler into a public tiddler",
    errorMsg: "Error publishing %0: %1",

    isEnabled: function(tiddler) {
        return !readOnly &amp;&amp; config.filterHelpers.is["private"](tiddler);
    },
    handler: function(ev, src, title) {
        var tiddler = store.getTiddler(title);
        if(tiddler) {
            var newBag = cmd.toggleBag(tiddler.fields["server.bag"]);
            this.moveTiddler(tiddler, {
                title: tiddler.fields["publish.name"] || tiddler.title,
                fields: { "server.bag": newBag }
            });
        }
    },
    toggleBag: function(bag, to) {
        var newBag;
        if(typeof bag != typeof "") {
            var tiddler = bag;
            bag = tiddler.fields["server.bag"];
        }
        if(bag.indexOf("_private") &gt; -1) { // should make use of endsWith
            to = to ? to : "public";
            newBag = bag.replace("_private", "_" + to);
        } else {
            to = to ? to : "private";
            newBag = bag.replace("_public", "_" + to);
        }
        return newBag;
    },
    copyTiddler: function(title, newTitle, newBag, callback) {
        var original = store.getTiddler(title);
        newTitle = newTitle ? newTitle : title;
        var adaptor = original.getAdaptor();
        var publish = function(original, callback) {
            var tiddler = $.extend(new Tiddler(newTitle), original);
            tiddler.fields = $.extend({}, original.fields, {
                "server.bag": newBag,
                "server.workspace": "bags/%0".format(newBag),
                "server.page.revision": "false"
            });
            delete tiddler.fields["server.title"];
            tiddler.title = newTitle;
            adaptor.putTiddler(tiddler, null, null, callback);
        };
        publish(original, callback);
    },
    moveTiddler: function(tiddler, newTiddler, callback) {
            var info = {
            copyContext: {},
            deleteContext: {}
        };
        var _dirty = store.isDirty();
        var adaptor = tiddler.getAdaptor();
        var newTitle = newTiddler.title;
        var oldTitle = tiddler.title;
        delete tiddler.fields["server.workspace"];
        var oldBag = tiddler.fields["server.bag"];
        var newBag = newTiddler.fields["server.bag"];
        var newWorkspace = "bags/%0".format(newBag);
        cmd.copyTiddler(oldTitle, newTitle, newBag, function(ctx) {
                info.copyContext = ctx;
                var context = {
                    tiddler: tiddler,
                    workspace: newWorkspace
                };
                store.addTiddler(ctx.tiddler);
                tiddler.title = oldTitle; // for cases where a rename occurs
                if(ctx.status) { // only do if a success
                    if(oldBag != newBag) {
                        adaptor.deleteTiddler(tiddler, context, {}, function(ctx) {
                            info.deleteContext = ctx;
                            var el;
                            if(tiddler) {
                                tiddler.fields["server.workspace"] = newWorkspace;
                                tiddler.fields["server.bag"] = newBag;
                            }
                            el = el ? el : story.refreshTiddler(oldTitle, null, true);
                            if(oldTitle != newTitle) {
                                store.deleteTiddler(oldTitle);
                                store.notify(oldTitle, true);
                            }
                            if(el) {
                                story.displayTiddler(el, newTitle);
                            }
                            if(oldTitle != newTitle) {
                                story.closeTiddler(oldTitle);
                            }
                            if(callback) {
                                callback(info);
                            }
                            store.setDirty(_dirty);
                        });
                    } else {
                        if(callback) {
                            callback(info);
                        }
                    }
                    refreshDisplay();
                }
        });
    }
};

var changeToPrivate = config.commands.changeToPrivate = {
    text: "make private",
    tooltip: "turn this public tiddler into a private tiddler",
    isEnabled: function(tiddler) {
        return !readOnly &amp;&amp; config.filterHelpers.is["public"](tiddler);
    },
    handler: function(event, src, title) {
        var tiddler = store.getTiddler(title);
        var newBag = cmd.toggleBag(tiddler, "private");
        var newTiddler = { title: title, fields: { "server.bag": newBag }};
        cmd.moveTiddler(tiddler, newTiddler);
    }
};
config.commands.changeToPublic = cmd;

/* Save as draft command */
var saveDraftCmd = config.commands.saveDraft = {
    text: "save draft",
    tooltip: "Save as a private draft",
    isEnabled: function(tiddler) {
        return changeToPrivate.isEnabled(tiddler);
    },
    getDraftTitle: function(title) {
        var draftTitle;
        var draftNum = "";
        while(!draftTitle) {
            var suggestedTitle = "%0 [draft%1]".format(title, draftNum);
            if(store.getTiddler(suggestedTitle)) {
                draftNum = !draftNum ? 2 : draftNum + 1;
            } else {
                draftTitle = suggestedTitle;
            }
        }
        return draftTitle;
    },
    createDraftTiddler: function(title, gatheredFields) {
        var tiddler = store.getTiddler(title);
        var draftTitle = saveDraftCmd.getDraftTitle(title);
        var draftTiddler = new Tiddler(draftTitle);
        if(tiddler) {
            $.extend(true, draftTiddler, tiddler);
        } else {
            $.extend(draftTiddler.fields, config.defaultCustomFields);
        }
        for(var fieldName in gatheredFields) {
            if(TiddlyWiki.isStandardField(fieldName)) {
                draftTiddler[fieldName] = gatheredFields[fieldName];
            } else {
                draftTiddler.fields[fieldName] = gatheredFields[fieldName];
            }
        }
        var privateBag = tiddlyspace.getCurrentBag("private");
        var privateWorkspace = tiddlyspace.getCurrentWorkspace("private");
        draftTiddler.title = draftTitle;
        draftTiddler.fields["publish.name"] = title;
        draftTiddler.fields["server.workspace"] = privateWorkspace;
        draftTiddler.fields["server.bag"] = privateBag;
        draftTiddler.fields["server.title"] = draftTitle;
        draftTiddler.fields["server.page.revision"] = "false";
        delete draftTiddler.fields["server.etag"];
        return draftTiddler;
    },
    handler: function(ev, src, title) {
        var tiddler = store.getTiddler(title); // original tiddler
        var tidEl = story.getTiddler(title);
        var uiFields = {};
        story.gatherSaveFields(tidEl, uiFields);
        var tid = saveDraftCmd.createDraftTiddler(title, uiFields);
        tid = store.saveTiddler(tid.title, tid.title, tid.text, tid.modifier,
            new Date(), tid.tags, tid.fields);
        autoSaveChanges(null, [tid]);
        story.closeTiddler(title);
        story.displayTiddler(src, title);
        story.displayTiddler(src, tid.title);
    }
};

var macro = config.macros.TiddlySpacePublisher = {
    locale: {
        title: "Batch Publisher",
        changeStatusLabel: "Make %0",
        noTiddlersText: "No tiddlers to publish",
        changeStatusPrompt: "Make all the selected tiddlers %0.",
        description: "Change tiddlers from %0 to %1 in this space"
    },

    listViewTemplate: {
        columns: [
            { name: "Selected", field: "Selected", rowName: "title", type: "Selector" },
            { name: "Tiddler", field: "tiddler", title: "Tiddler", type: "Tiddler" },
            { name: "Status", field: "status", title: "Status", type: "WikiText" }
        ],
        rowClasses: []
    },

    changeStatus: function(tiddlers, status, callback) { // this is what is called when you click the publish button
        var publicBag;
        for(var i = 0; i &lt; tiddlers.length; i++) {
            var tiddler = tiddlers[i];
            var newTiddler = {
                title: tiddler.title,
                fields: { "server.bag": cmd.toggleBag(tiddler, status) }
            };
            cmd.moveTiddler(tiddler, newTiddler, callback);
        }
    },
    getMode: function(paramString) {
        var params = paramString.parseParams("anon")[0];
        var status = params.type ?
            (["public", "private"].contains(params.type[0]) ? params.type[0] : "private") :
            "private";
        var newStatus = status == "public" ? "private" : "public";
        return [status, newStatus];
    },
    handler: function(place, macroName, params, wikifier, paramString, tiddler) {
        var wizard = new Wizard();
        var locale = macro.locale;
        var status = macro.getMode(paramString);
        wizard.createWizard(place, locale.title);
        wizard.addStep(macro.locale.description.format(status[0], status[1]),
            '&lt;input type="hidden" name="markList" /&gt;');
        var markList = wizard.getElement("markList");
        var listWrapper = $("&lt;div /&gt;").addClass("batchPublisher").
            attr("refresh", "macro").attr("macroName", macroName).
            attr("params", paramString)[0];
        markList.parentNode.insertBefore(listWrapper, markList);
        $.data(listWrapper, "wizard", wizard);
        macro.refresh(listWrapper);
    },
    getCheckedTiddlers: function(listWrapper, titlesOnly) {
        var tiddlers = [];
        $(".chkOptionInput[rowName]:checked", listWrapper).each(function(i, el) {
            var title = $(el).attr("rowName");
            if(titlesOnly) {
                tiddlers.push(title);
            } else {
                tiddlers.push(store.getTiddler(title));
            }
        });
        return tiddlers;
    },
    refresh: function(listWrapper) {
        var checked = macro.getCheckedTiddlers(listWrapper, true);
        var paramString = $(listWrapper).empty().attr("params");
        var wizard = $.data(listWrapper, "wizard");
        var locale = macro.locale;
        var params = paramString.parseParams("anon")[0];
        var publishCandidates = [];
        var status = macro.getMode(paramString);
        var pubType = status[0];
        var newPubType = status[1];
        var tiddlers = params.filter ? store.filterTiddlers(params.filter[0]) :
            store.filterTiddlers("[is[%0]]".format(pubType));
        var enabled = [];
        for(var i = 0; i &lt; tiddlers.length; i++) {
            var tiddler = tiddlers[i];
            var title = tiddler.title;
            if(!tiddler.tags.contains("excludePublisher") &amp;&amp; title !== "SystemSettings") {
                publishCandidates.push({ title: title, tiddler: tiddler, status: pubType});
            }
            if(checked.contains(title)) {
                enabled.push("[rowname=%0]".format(title));
            }
        }

        if(publishCandidates.length === 0) {
            createTiddlyElement(listWrapper, "em", null, null, locale.noTiddlersText);
        } else {
            var listView = ListView.create(listWrapper, publishCandidates, macro.listViewTemplate);
            wizard.setValue("listView", listView);
            var btnHandler = function(ev) {
                var tiddlers = macro.getCheckedTiddlers(listWrapper);
                var callback = function(status) {
                    $(".batchPublisher").each(function(i, el) {
                        macro.refresh(el);
                    });
                };
                macro.changeStatus(tiddlers, newPubType, callback);
            };
            wizard.setButtons([{
                caption: locale.changeStatusLabel.format(newPubType),
                tooltip: locale.changeStatusPrompt.format(newPubType),
                onClick: btnHandler
            }]);
            $(enabled.join(",")).attr("checked", true); // retain what was checked before
        }
    }
};

})(jQuery);
//}}}</pre>
</div>

<div title="TiddlySpaceTabs">
<pre>!Spaces
&lt;&lt;groupBy server.bag&gt;&gt;

!Private
&lt;&lt;list filter [is[private]]&gt;&gt;

!Public
&lt;&lt;list filter [is[public]]&gt;&gt;

!Drafts
&lt;&lt;list filter [is[draft]]&gt;&gt;</pre>
</div>

<div title="TiddlySpaceBackstage">
<pre>/***
|''Name''|TiddlySpaceBackstage|
|''Version''|0.8.0|
|''Description''|Provides a TiddlySpace version of the backstage and a homeLink macro|
|''Status''|@@beta@@|
|''Contributors''|Jon Lister, Jon Robson, Colm Britton|
|''Source''|http://github.com/TiddlySpace/tiddlyspace/raw/master/src/plugins/TiddlySpaceBackstage.js|
|''Requires''|TiddlySpaceConfig ImageMacroPlugin TiddlySpaceViewTypes|
!StyleSheet
.tiddler .error.annotation .button{
    display: inline-block;
}

#backstageArea {
    z-index: 49;
    color: white;
    background-color: black;
    background: -webkit-gradient(linear,left bottom,left top,color-stop(0, #222),color-stop(0.5, #333),color-stop(1, #555));
    background: -moz-linear-gradient(center bottom,#222 0%, #333 50%, #555 100%);
    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr=#ff555555, endColorstr=#ff222222);
    -ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#ff555555, endColorstr=#ff222222)";
    height: 25px;
    padding: 0;
}

#backstageButton {
    overflow: hidden;
}

#backstageButton #backstageShow,
#backstageButton #backstageHide {
    margin: 0px;
    padding: 0px;
}

#backstageButton #backstageShow:hover,
#backstageButton #backstageHide:hover {
    background: none;
    color: none;
}

#backstageButton img,
#backstageButton svg {
    width: 24px;
    height: 24px;
}

#messageArea {
    top: 50px;
}

#backstageToolbar {
    position: relative;
}

#backstageArea a {
    padding: 0px;
    margin-left: 0px;
    color: white;
    background: none;
}

#backstageArea a:hover {
    background-color: white;
}

#backstage ol,
#backstage ul {
    padding: auto;
}

#backstageButton a {
    margin: 0;
}

.backstagePanelBody ul {
    padding: 5px;
    margin: 5px;
}

#backstage #backstagePanel {
    margin-left: 5%;
    padding: 0em;
    margin-right: 5%;
}

#backstageToolbar a {
    position: relative;
}

#backstageArea a.backstageSelTab,
#backstageToolbar .backstageTask {
    line-height: 25px;
    color: #767676;
}

.backstageTask .externalImage,
.backstageTask .image {
    display: inline;
}

#backstageToolbar a span {
    z-index: 2;
}

a.backstageTask {
    display: inline;
        margin-left: 1em !important;
}

.backstagePanelBody .button {
    display: inline-block;
    margin-right: 10px;
}

.backstagePanelBody {
    margin: 0 0 0 0.6em;
    padding: 0.4em 0.5em 1px 0.5em;
}

#backstage table {
    margin: auto;
}

#backstage .wizard table {
    border: 0px;
    margin: 0;
}

#backstage div  li.listLink {
    border: 0px;
    width: 78%;
    font-size: 0.7em;
}

#backstage div li.listTitle {
    font-weight: bold;
    text-decoration: underline;
    font-size: 1em;
    background: #ccc;
    width: 100%;
}

#backstage fieldset {
    border: solid 1px [[ColorPalette::Background]];
}

#backstage .viewer table,#backstage table.twtable {
    border: 0px;
}

#backstageToolbar img {
    padding: 0;
}

#backstage .wizard,
#backstage .wizardFooter {
    background: none;
}

.viewer td, .viewer tr, .twtable td, .twtable tr {
    border: 1px solid #eee;
}

#backstage .inlineList ul li {
    background-color: [[ColorPalette::Background]];
    border: solid 1px [[ColorPalette::TertiaryMid]];
    display: block;
    float: left;
    list-style: none;
    margin-right: 1em;
    padding: 0.5em;
}

.backstageClear, .inlineList form {
    clear: both;
    display: block;
    margin-top: 3em;
}

.tiddlyspaceMenu {
    text-align: center;
}

span.chunkyButton {
    display: inline-block;
    padding: 0;
    margin: 0;
    border: solid 2px #000;
    background-color: #04b;
}

span.chunkyButton a.button, span.chunkyButton a:active.button {
    white-space: nowrap;
    font-weight: bold;
    font-size: 1.8em;
    color: #fff;
    text-align: center;
    padding: 0.5em 0.5em;
    margin: 0;
    border-style: none;
    display: block;
}

span.chunkyButton:hover {
    background-color: #014;
}

span.chunkyButton a.button:hover {
    border-style: none;
    background: none;
    color: #fff;
}

#backstage .unpluggedSpaceTab .wizard,
.unpluggedSpaceTab .wizard {
    background: white;
    border: 2px solid #CCC;
    padding: 5px;
}

.syncKey .keyItem {
    border: 1px solid black;
    display: inline-block;
    margin: 0.2em;
    padding: 0.1em 0.1em 0.1em 0.1em;
}

.keyHeading {
    font-size: 2em;
    font-weight: bold;
    margin: 0.4em 0em -0.2em;
}

.unpluggedSpaceTab .putToServer,
.unpluggedSpaceTab .notChanged {
    display: none;
}

.tiddlyspaceMenu ul {
    margin: 0;
    padding: 0;
}

.tiddlyspaceMenu ul li {
    list-style: none;
}

.unsyncedChanges .unsyncedList {
    display: block;
}

.unsyncedList {
    display: none;
}
!Code
***/
//{{{
(function ($) {
    var name = "StyleSheet" + tiddler.title;
    config.shadowTiddlers[name] = "/*{{{*/\n%0\n/*}}}*/".
        format(store.getTiddlerText(tiddler.title + "##StyleSheet")); // this accesses the StyleSheet section of the current tiddler (the plugin that contains it)
    store.addNotification(name, refreshStyles);

    if (!config.extensions.tiddlyweb.status.tiddlyspace_version) { // unplugged
        config.extensions.tiddlyweb.status.tiddlyspace_version = "&lt;unknown&gt;";
        config.extensions.tiddlyweb.status.server_host = {
            url:config.extensions.tiddlyweb.host }; // TiddlySpaceLinkPlugin expects this
    }
    var disabled_tasks_for_nonmembers = ["tiddlers", "plugins", "batch", "sync"];

    var tweb = config.extensions.tiddlyweb;
    var tiddlyspace = config.extensions.tiddlyspace;
    var currentSpace = tiddlyspace.currentSpace.name;
    var imageMacro = config.macros.image;

    if (config.options.chkBackstage === undefined) {
        config.options.chkBackstage = false;
    }

// Set up Backstage
    config.tasks = {};
    config.tasks.status = {
        text:"status",
        tooltip:"TiddlySpace Info",
        content:"&lt;&lt;tiddler Backstage##Menu&gt;&gt;"
    };
    config.tasks.tiddlers = {
        text:"tiddlers",
        tooltip:"tiddlers control panel",
        content:"&lt;&lt;tiddler Backstage##BackstageTiddlers&gt;&gt;"
    };
    config.tasks.plugins = {
        text:"plugins",
        tooltip:"Manage installed plugins",
        content:"&lt;&lt;tiddler Backstage##Plugins&gt;&gt;"
    };
    config.tasks.batch = {
        text:"batch",
        tooltip:"Batch manage public/private tiddlers",
        content:"&lt;&lt;tiddler Backstage##BatchOps&gt;&gt;"
    };
    config.tasks.tweaks = {
        text:"tweaks",
        tooltip:"Tweak TiddlyWiki behaviors",
        content:"&lt;&lt;tiddler Backstage##Tweaks&gt;&gt;"
    };
    config.tasks.exportTiddlers = {
        text:"import/export",
        tooltip:"Import/export tiddlers from/to a TiddlyWiki",
        content:"&lt;&lt;tiddler Backstage##ImportExport&gt;&gt;"
    };
    config.tasks.sync = {
        text:"sync",
        tooltip:"Check Sync status",
        content:"&lt;&lt;tiddler Backstage##SpaceUnplugged&gt;&gt;"
    };

    if (window.location.protocol === "file:") {
        config.unplugged = true;
    }

    config.backstageTasks = ["status", "tiddlers", "plugins",
        "batch", "tweaks", "exportTiddlers", "sync"];

    config.messages.backstage.prompt = "";
// initialize state
    var _show = backstage.show;
    backstage.show = function () {
        // selectively hide backstage tasks and tabs based on user status
        var tasks = $("#backstageToolbar .backstageTask").show();
        var bs = backstage.tiddlyspace;
        if (!config.unplugged) {
            tweb.getUserInfo(function (user) {
                if (user.anon) {
                    jQuery.each(disabled_tasks_for_nonmembers, function (i, task) {
                        var taskIndex = config.backstageTasks.indexOf(task);
                        if (taskIndex !== -1) {
                            config.backstageTasks.splice(taskIndex, 1);
                        }
                    });
                    config.messages.memberStatus = bs.locale.loggedout;
                } else {
                    config.messages.memberStatus = readOnly ?
                        bs.locale.nonmember : bs.locale.member;
                }
            });
        } else {
            config.messages.memberStatus = bs.locale.unplugged;
        }

        // display backstage
        return _show.apply(this, arguments);
    };
    if (readOnly) {
        jQuery.each(disabled_tasks_for_nonmembers, function (i, task) {
            var taskIndex = config.backstageTasks.indexOf(task);
            if (taskIndex !== -1) {
                config.backstageTasks.splice(taskIndex, 1);
            }
        });
    }

    var tasks = config.tasks;
    var commonUrl = "/bags/common/tiddlers/%0";

    backstage.tiddlyspace = {
        locale:{
            member:"You are a member of this space.",
            nonmember:"You are not a member of this space.",
            loggedout:"You are currently logged out of TiddlySpace.",
            unplugged:"You are unplugged."
        },
        showButton:function () {
            var showBtn = $("#backstageShow")[0];
            var altText = $(showBtn).text();
            $(showBtn).empty();
            imageMacro.renderImage(showBtn, "backstage.svg",
                { altImage:commonUrl.format("backstage.png"), alt:altText});
        },
        hideButton:function () {
            var hideBtn = $("#backstageHide")[0];
            var altText = $(hideBtn).text();
            $(hideBtn).empty();
            imageMacro.renderImage(hideBtn, "close.svg",
                { altImage:commonUrl.format("close.png"), alt:altText, width:24, height:24 });
        }
    };

    var _init = backstage.init;
    backstage.init = function () {
        _init.apply(this, arguments);
        var init = function (user) {
            var bs = backstage.tiddlyspace;
            bs.showButton();
            bs.hideButton();
        };
        tweb.getUserInfo(init);
    };

    var home = config.macros.homeLink = {
        locale:{
            linkText:"your home space"
        },
        handler:function (place) {
            var container = $("&lt;span /&gt;").appendTo(place)[0];
            tweb.getUserInfo(function (user) {
                if (!user.anon &amp;&amp; user.name !== currentSpace) {
                    createSpaceLink(container, user.name, null, home.locale.linkText);
                }
            });
        }
    };

    config.macros.exportSpace = {
        handler:function (place, macroName, params) {
            var filename = params[0] ||
                "/tiddlers.wiki?download=%0.html".format(currentSpace);
            $('&lt;a class="button"&gt;download&lt;/a&gt;').// XXX: i18n
                attr("href", filename).appendTo(place);
        }
    };

}(jQuery));
//}}}</pre>
</div>

<div title="RevisionsCommandPlugin">
<pre>/***
|''Name''|RevisionsCommandPlugin|
|''Description''|provides access to tiddler revisions|
|''Author''|FND|
|''Contributors''|Martin Budden|
|''Version''|0.3.3|
|''Status''|@@beta@@|
|''Source''|http://svn.tiddlywiki.org/Trunk/association/plugins/RevisionsCommandPlugin.js|
|''CodeRepository''|http://svn.tiddlywiki.org/Trunk/association/plugins/|
|''License''|[[BSD|http://www.opensource.org/licenses/bsd-license.php]]|
|''CoreVersion''|2.6.0|
|''Keywords''|serverSide|
!Usage
Extend [[ToolbarCommands]] with {{{revisions}}}.
!Revision History
!!v0.1 (2009-07-23)
* initial release (renamed from experimental ServerCommandsPlugin)
!!v0.2 (2010-03-04)
* suppressed wikification in diff view
!!v0.3 (2010-04-07)
* restored wikification in diff view
* added link to side-by-side diff view
!To Do
* strip server.* fields from revision tiddlers
* resolve naming conflicts
* i18n, l10n
* code sanitizing
* documentation
!Code
***/
//{{{
(function($) {

jQuery.twStylesheet(".diff { white-space: pre, font-family: monospace }",
    { id: "diff" });

var cmd = config.commands.revisions = {
    type: "popup",
    hideShadow: true,
    text: "revisions",
    tooltip: "display tiddler revisions",
    revTooltip: "", // TODO: populate dynamically?
    loadLabel: "loading...",
    loadTooltip: "loading revision list",
    selectLabel: "select",
    selectTooltip: "select revision for comparison",
    selectedLabel: "selected",
    compareLabel: "compare",
    linkLabel: "side-by-side view",
    revSuffix: " [rev. #%0]",
    diffSuffix: " [diff: #%0 #%1]",
    dateFormat: "YYYY-0MM-0DD 0hh:0mm",
    listError: "revisions could not be retrieved",

    handlePopup: function(popup, title) {
        title = this.stripSuffix("rev", title);
        title = this.stripSuffix("diff", title);
        var tiddler = store.getTiddler(title);
        var type = _getField("server.type", tiddler);
        var adaptor = new config.adaptors[type]();
        var limit = null; // TODO: customizable
        var context = {
            host: _getField("server.host", tiddler),
            workspace: _getField("server.workspace", tiddler)
        };
        var loading = createTiddlyButton(popup, cmd.loadLabel, cmd.loadTooltip);
        var params = { popup: popup, loading: loading, origin: title };
        adaptor.getTiddlerRevisionList(title, limit, context, params, this.displayRevisions);
    },

    displayRevisions: function(context, userParams) {
        removeNode(userParams.loading);
        if(context.status) {
            var callback = function(ev) {
                var e = ev || window.event;
                var revision = resolveTarget(e).getAttribute("revision");
                context.adaptor.getTiddlerRevision(tiddler.title, revision, context,
                    userParams, cmd.displayTiddlerRevision);
            };
            var table = createTiddlyElement(userParams.popup, "table");
            for(var i = 0; i &lt; context.revisions.length; i++) {
                var tiddler = context.revisions[i];
                var row = createTiddlyElement(table, "tr");
                var timestamp = tiddler.modified.formatString(cmd.dateFormat);
                var revision = tiddler.fields["server.page.revision"];
                var cell = createTiddlyElement(row, "td");
                createTiddlyButton(cell, timestamp, cmd.revTooltip, callback, null,
                    null, null, { revision: revision });
                cell = createTiddlyElement(row, "td", null, null, tiddler.modifier);
                cell = createTiddlyElement(row, "td");
                createTiddlyButton(cell, cmd.selectLabel, cmd.selectTooltip,
                    cmd.revisionSelected, null, null, null,
                    { index:i, revision: revision, col: 2 });
                cmd.context = context; // XXX: unsafe (singleton)!?
            }
        } else {
            $("&lt;li /&gt;").text(cmd.listError).appendTo(userParams.popup);
        }
    },

    revisionSelected: function(ev) {
        var e = ev || window.event;
        e.cancelBubble = true;
        if(e.stopPropagation) {
            e.stopPropagation();
        }
        var n = resolveTarget(e);
        var index = n.getAttribute("index");
        var col = n.getAttribute("col");
        while(!index || !col) {
            n = n.parentNode;
            index = n.getAttribute("index");
            col = n.getAttribute("col");
        }
        cmd.revision = n.getAttribute("revision");
        var table = n.parentNode.parentNode.parentNode;
        var rows = table.childNodes;
        for(var i = 0; i &lt; rows.length; i++) {
            var c = rows[i].childNodes[col].firstChild;
            if(i == index) {
                if(c.textContent) {
                    c.textContent = cmd.selectedLabel;
                } else {
                    c.text = cmd.selectedLabel;
                }
            } else {
                if(c.textContent) {
                    c.textContent = cmd.compareLabel;
                } else {
                    c.text = cmd.compareLabel;
                }
                c.onclick = cmd.compareSelected;
            }
        }
    },

    compareSelected: function(ev) {
        var e = ev || window.event;
        var n = resolveTarget(e);
        var context = cmd.context;
        context.rev1 = n.getAttribute("revision");
        context.rev2 = cmd.revision;
        context.tiddler = context.revisions[n.getAttribute("index")];
        context.format = "unified";
        context.adaptor.getTiddlerDiff(context.tiddler.title, context,
            context.userParams, cmd.displayTiddlerDiffs);
    },

    displayTiddlerDiffs: function(context, userParams) {
        var tiddler = context.tiddler;
        tiddler.title += cmd.diffSuffix.format([context.rev1, context.rev2]);
        tiddler.text = "{{diff{\n" + context.diff + "\n}}}";
        tiddler.tags = ["diff"];
        tiddler.fields.doNotSave = "true"; // XXX: correct?
        if(!store.getTiddler(tiddler.title)) {
            store.addTiddler(tiddler);
        }
        var src = story.getTiddler(userParams.origin);
        var tiddlerEl = story.displayTiddler(src, tiddler);
        var uri = context.uri.replace("format=unified", "format=horizontal");
        var link = $('&lt;a target="_blank" /&gt;').attr("href", uri).text(cmd.linkLabel);
        $(".viewer", tiddlerEl).prepend(link);
    },

    displayTiddlerRevision: function(context, userParams) {
        var tiddler = context.tiddler;
        tiddler.title += cmd.revSuffix.format([tiddler.fields["server.page.revision"]]);
        tiddler.fields.doNotSave = "true"; // XXX: correct?
        if(!store.getTiddler(tiddler.title)) {
            store.addTiddler(tiddler);
        }
        var src = story.getTiddler(userParams.origin);
        story.displayTiddler(src, tiddler);
    },

    stripSuffix: function(type, title) {
        var str = cmd[type + "Suffix"];
        var i = str.indexOf("%0");
        i = title.indexOf(str.substr(0, i));
        if(i != -1) {
            title = title.substr(0, i);
        }
        return title;
    }
};

var _getField = function(name, tiddler) {
    return tiddler.fields[name] || config.defaultCustomFields[name];
};

})(jQuery);
//}}}</pre>
</div>

<div title="TiddlySpaceSanitizer">
<pre>/***
|''Description''|Sanitisation for dynamically pulling tiddlers into your space and displaying them|
!Notes
Works both inside and outside TiddlyWiki. Uses the HTML Sanitizer provided by the Google Caja project
(see http://code.google.com/p/google-caja/wiki/JsHtmlSanitizer for more on this), which is licensed under
an Apache License (see http://www.apache.org/licenses/LICENSE-2.0).
!Code
***/
//{{{
(function($) {

var cleanURL = function(url) {
    var regexp = /^(?:http|https|mailto|ftp|irc|news):\/\//;
    return (regexp.test(url)) ? url : null;
};

$.sanitize = function(html) {
    return html_sanitize(html, cleanURL);
};

/*
 * HTML Sanitizer, provided by Google Caja
 */

/* Copyright Google Inc.
 * Licensed under the Apache Licence Version 2.0
 * Autogenerated at Tue May 17 17:39:24 BST 2011
 * @provides html4
 */var html4={};html4.atype={NONE:0,URI:1,URI_FRAGMENT:11,SCRIPT:2,STYLE:3,ID:4,IDREF:5,IDREFS:6,GLOBAL_NAME:7,LOCAL_NAME:8,CLASSES:9,FRAME_TARGET:10},html4.ATTRIBS={"*::class":9,"*::dir":0,"*::id":4,"*::lang":0,"*::onclick":2,"*::ondblclick":2,"*::onkeydown":2,"*::onkeypress":2,"*::onkeyup":2,"*::onload":2,"*::onmousedown":2,"*::onmousemove":2,"*::onmouseout":2,"*::onmouseover":2,"*::onmouseup":2,"*::style":3,"*::title":0,"a::accesskey":0,"a::coords":0,"a::href":1,"a::hreflang":0,"a::name":7,"a::onblur":2,"a::onfocus":2,"a::rel":0,"a::rev":0,"a::shape":0,"a::tabindex":0,"a::target":10,"a::type":0,"area::accesskey":0,"area::alt":0,"area::coords":0,"area::href":1,"area::nohref":0,"area::onblur":2,"area::onfocus":2,"area::shape":0,"area::tabindex":0,"area::target":10,"bdo::dir":0,"blockquote::cite":1,"br::clear":0,"button::accesskey":0,"button::disabled":0,"button::name":8,"button::onblur":2,"button::onfocus":2,"button::tabindex":0,"button::type":0,"button::value":0,"canvas::height":0,"canvas::width":0,"caption::align":0,"col::align":0,"col::char":0,"col::charoff":0,"col::span":0,"col::valign":0,"col::width":0,"colgroup::align":0,"colgroup::char":0,"colgroup::charoff":0,"colgroup::span":0,"colgroup::valign":0,"colgroup::width":0,"del::cite":1,"del::datetime":0,"dir::compact":0,"div::align":0,"dl::compact":0,"font::color":0,"font::face":0,"font::size":0,"form::accept":0,"form::action":1,"form::autocomplete":0,"form::enctype":0,"form::method":0,"form::name":7,"form::onreset":2,"form::onsubmit":2,"form::target":10,"h1::align":0,"h2::align":0,"h3::align":0,"h4::align":0,"h5::align":0,"h6::align":0,"hr::align":0,"hr::noshade":0,"hr::size":0,"hr::width":0,"iframe::align":0,"iframe::frameborder":0,"iframe::height":0,"iframe::marginheight":0,"iframe::marginwidth":0,"iframe::width":0,"img::align":0,"img::alt":0,"img::border":0,"img::height":0,"img::hspace":0,"img::ismap":0,"img::name":7,"img::src":1,"img::usemap":11,"img::vspace":0,"img::width":0,"input::accept":0,"input::accesskey":0,"input::align":0,"input::alt":0,"input::autocomplete":0,"input::checked":0,"input::disabled":0,"input::ismap":0,"input::maxlength":0,"input::name":8,"input::onblur":2,"input::onchange":2,"input::onfocus":2,"input::onselect":2,"input::readonly":0,"input::size":0,"input::src":1,"input::tabindex":0,"input::type":0,"input::usemap":11,"input::value":0,"ins::cite":1,"ins::datetime":0,"label::accesskey":0,"label::for":5,"label::onblur":2,"label::onfocus":2,"legend::accesskey":0,"legend::align":0,"li::type":0,"li::value":0,"map::name":7,"menu::compact":0,"ol::compact":0,"ol::start":0,"ol::type":0,"optgroup::disabled":0,"optgroup::label":0,"option::disabled":0,"option::label":0,"option::selected":0,"option::value":0,"p::align":0,"pre::width":0,"q::cite":1,"select::disabled":0,"select::multiple":0,"select::name":8,"select::onblur":2,"select::onchange":2,"select::onfocus":2,"select::size":0,"select::tabindex":0,"table::align":0,"table::bgcolor":0,"table::border":0,"table::cellpadding":0,"table::cellspacing":0,"table::frame":0,"table::rules":0,"table::summary":0,"table::width":0,"tbody::align":0,"tbody::char":0,"tbody::charoff":0,"tbody::valign":0,"td::abbr":0,"td::align":0,"td::axis":0,"td::bgcolor":0,"td::char":0,"td::charoff":0,"td::colspan":0,"td::headers":6,"td::height":0,"td::nowrap":0,"td::rowspan":0,"td::scope":0,"td::valign":0,"td::width":0,"textarea::accesskey":0,"textarea::cols":0,"textarea::disabled":0,"textarea::name":8,"textarea::onblur":2,"textarea::onchange":2,"textarea::onfocus":2,"textarea::onselect":2,"textarea::readonly":0,"textarea::rows":0,"textarea::tabindex":0,"tfoot::align":0,"tfoot::char":0,"tfoot::charoff":0,"tfoot::valign":0,"th::abbr":0,"th::align":0,"th::axis":0,"th::bgcolor":0,"th::char":0,"th::charoff":0,"th::colspan":0,"th::headers":6,"th::height":0,"th::nowrap":0,"th::rowspan":0,"th::scope":0,"th::valign":0,"th::width":0,"thead::align":0,"thead::char":0,"thead::charoff":0,"thead::valign":0,"tr::align":0,"tr::bgcolor":0,"tr::char":0,"tr::charoff":0,"tr::valign":0,"ul::compact":0,"ul::type":0},html4.eflags={OPTIONAL_ENDTAG:1,EMPTY:2,CDATA:4,RCDATA:8,UNSAFE:16,FOLDABLE:32,SCRIPT:64,STYLE:128},html4.ELEMENTS={a:0,abbr:0,acronym:0,address:0,applet:16,area:2,b:0,base:18,basefont:18,bdo:0,big:0,blockquote:0,body:49,br:2,button:0,canvas:0,caption:0,center:0,cite:0,code:0,col:2,colgroup:1,dd:1,del:0,dfn:0,dir:0,div:0,dl:0,dt:1,em:0,fieldset:0,font:0,form:0,frame:18,frameset:16,h1:0,h2:0,h3:0,h4:0,h5:0,h6:0,head:49,hr:2,html:49,i:0,iframe:4,img:2,input:2,ins:0,isindex:18,kbd:0,label:0,legend:0,li:1,link:18,map:0,menu:0,meta:18,nobr:0,noframes:20,noscript:20,object:16,ol:0,optgroup:0,option:1,p:1,param:18,pre:0,q:0,s:0,samp:0,script:84,select:0,small:0,span:0,strike:0,strong:0,style:148,sub:0,sup:0,table:0,tbody:1,td:1,textarea:8,tfoot:1,th:1,thead:1,title:24,tr:1,tt:0,u:0,ul:0,"var":0},html4.ueffects={NOT_LOADED:0,SAME_DOCUMENT:1,NEW_DOCUMENT:2},html4.URIEFFECTS={"a::href":2,"area::href":2,"blockquote::cite":0,"body::background":1,"del::cite":0,"form::action":2,"img::src":1,"input::src":1,"ins::cite":0,"q::cite":0},html4.ltypes={UNSANDBOXED:2,SANDBOXED:1,DATA:0},html4.LOADERTYPES={"a::href":2,"area::href":2,"blockquote::cite":2,"body::background":1,"del::cite":2,"form::action":2,"img::src":1,"input::src":1,"ins::cite":2,"q::cite":2};var html=function(a){function x(b,c,d){var e=[];w(function(b,e){for(var f=0;f&lt;e.length;f+=2){var g=e[f],h=e[f+1],i=null,j;if((j=b+"::"+g,a.ATTRIBS.hasOwnProperty(j))||(j="*::"+g,a.ATTRIBS.hasOwnProperty(j)))i=a.ATTRIBS[j];if(i!==null)switch(i){case a.atype.NONE:break;case a.atype.SCRIPT:case a.atype.STYLE:h=null;break;case a.atype.ID:case a.atype.IDREF:case a.atype.IDREFS:case a.atype.GLOBAL_NAME:case a.atype.LOCAL_NAME:case a.atype.CLASSES:h=d?d(h):h;break;case a.atype.URI:h=c&amp;&amp;c(h);break;case a.atype.URI_FRAGMENT:h&amp;&amp;"#"===h.charAt(0)?(h=d?d(h):h,h&amp;&amp;(h="#"+h)):h=null;break;default:h=null}else h=null;e[f+1]=h}return e})(b,e);return e.join("")}function w(b){var c,d;return v({startDoc:function(a){c=[],d=!1},startTag:function(e,f,g){if(!d){if(!a.ELEMENTS.hasOwnProperty(e))return;var h=a.ELEMENTS[e];if(h&amp;a.eflags.FOLDABLE)return;if(h&amp;a.eflags.UNSAFE){d=!(h&amp;a.eflags.EMPTY);return}f=b(e,f);if(f){h&amp;a.eflags.EMPTY||c.push(e),g.push("&lt;",e);for(var i=0,j=f.length;i&lt;j;i+=2){var k=f[i],l=f[i+1];l!==null&amp;&amp;l!==void 0&amp;&amp;g.push(" ",k,'="',r(l),'"')}g.push("&gt;")}}},endTag:function(b,e){if(d)d=!1;else{if(!a.ELEMENTS.hasOwnProperty(b))return;var f=a.ELEMENTS[b];if(!(f&amp;(a.eflags.UNSAFE|a.eflags.EMPTY|a.eflags.FOLDABLE))){var g;if(f&amp;a.eflags.OPTIONAL_ENDTAG)for(g=c.length;--g&gt;=0;){var h=c[g];if(h===b)break;if(!(a.ELEMENTS[h]&amp;a.eflags.OPTIONAL_ENDTAG))return}else for(g=c.length;--g&gt;=0;)if(c[g]===b)break;if(g&lt;0)return;for(var i=c.length;--i&gt;g;){var h=c[i];a.ELEMENTS[h]&amp;a.eflags.OPTIONAL_ENDTAG||e.push("&lt;/",h,"&gt;")}c.length=g,e.push("&lt;/",b,"&gt;")}}},pcdata:function(a,b){d||b.push(a)},rcdata:function(a,b){d||b.push(a)},cdata:function(a,b){d||b.push(a)},endDoc:function(a){for(var b=c.length;--b&gt;=0;)a.push("&lt;/",c[b],"&gt;");c.length=0}})}function v(c){return function(d,e){d=String(d);var f=null,g=!1,h=[],j=void 0,l=void 0,m=void 0;c.startDoc&amp;&amp;c.startDoc(e);while(d){var n=d.match(g?t:u);d=d.substring(n[0].length);if(g){if(n[1]){var o=b(n[1]),p;if(n[2]){var q=n[3];switch(q.charCodeAt(0)){case 34:case 39:q=q.substring(1,q.length-1)}p=k(i(q))}else p=o;h.push(o,p)}else if(n[4]){l!==void 0&amp;&amp;(m?c.startTag&amp;&amp;c.startTag(j,h,e):c.endTag&amp;&amp;c.endTag(j,e));if(m&amp;&amp;l&amp;(a.eflags.CDATA|a.eflags.RCDATA)){f===null?f=b(d):f=f.substring(f.length-d.length);var r=f.indexOf("&lt;/"+j);r&lt;0&amp;&amp;(r=d.length),l&amp;a.eflags.CDATA?c.cdata&amp;&amp;c.cdata(d.substring(0,r),e):c.rcdata&amp;&amp;c.rcdata(s(d.substring(0,r)),e),d=d.substring(r)}j=l=m=void 0,h.length=0,g=!1}}else if(n[1])c.pcdata&amp;&amp;c.pcdata(n[0],e);else if(n[3])m=!n[2],g=!0,j=b(n[3]),l=a.ELEMENTS.hasOwnProperty(j)?a.ELEMENTS[j]:void 0;else if(n[4])c.pcdata&amp;&amp;c.pcdata(n[4],e);else if(n[5]&amp;&amp;c.pcdata)switch(n[5]){case"&lt;":c.pcdata("&amp;lt;",e);break;case"&gt;":c.pcdata("&amp;gt;",e);break;default:c.pcdata("&amp;amp;",e)}}c.endDoc&amp;&amp;c.endDoc(e)}}function s(a){return a.replace(m,"&amp;amp;$1").replace(n,"&amp;lt;").replace(o,"&amp;gt;")}function r(a){return a.replace(l,"&amp;amp;").replace(n,"&amp;lt;").replace(o,"&amp;gt;").replace(p,"&amp;#34;").replace(q,"&amp;#61;")}function k(a){return a.replace(j,g)}function i(a){return a.replace(h,"")}function g(a,b){return f(b)}function f(a){a=b(a);if(c.hasOwnProperty(a))return c[a];var f=a.match(d);if(f)return String.fromCharCode(parseInt(f[1],10));if(!!(f=a.match(e)))return String.fromCharCode(parseInt(f[1],16));return""}var b;"script"==="SCRIPT".toLowerCase()?b=function(a){return a.toLowerCase()}:b=function(a){return a.replace(/[A-Z]/g,function(a){return String.fromCharCode(a.charCodeAt(0)|32)})};var c={lt:"&lt;",gt:"&gt;",amp:"&amp;",nbsp:"240",quot:'"',apos:"'"},d=/^#(\d+)$/,e=/^#x([0-9A-Fa-f]+)$/,h=/\0/g,j=/&amp;(#\d+|#x[0-9A-Fa-f]+|\w+);/g,l=/&amp;/g,m=/&amp;([^a-z#]|#(?:[^0-9x]|x(?:[^0-9a-f]|$)|$)|$)/gi,n=/&lt;/g,o=/&gt;/g,p=/\"/g,q=/\=/g,t=new RegExp("^\\s*(?:(?:([a-z][a-z-]*)(\\s*=\\s*(\"[^\"]*\"|'[^']*'|(?=[a-z][a-z-]*\\s*=)|[^&gt;\"'\\s]*))?)|(/?&gt;)|[\\s\\S][^a-z\\s&gt;]*)","i"),u=new RegExp("^(?:&amp;(\\#[0-9]+|\\#[x][0-9a-f]+|\\w+);|&lt;!--[\\s\\S]*?--&gt;|&lt;!\\w[^&gt;]*&gt;|&lt;\\?[^&gt;*]*&gt;|&lt;(/)?([a-z][a-z0-9]*)|([^&lt;&amp;&gt;]+)|([&lt;&amp;&gt;]))","i");return{escapeAttrib:r,makeHtmlSanitizer:w,makeSaxParser:v,normalizeRCData:s,sanitize:x,unescapeEntities:k}}(html4),html_sanitize=html.sanitize

// stop here if we're not in TiddlyWiki
// XXX: is this the correct way of checking for TiddlyWiki?
if (!window.TiddlyWiki || !window.store || !store instanceof TiddlyWiki) {
    return;
}

var tiddlyspace = config.extensions.tiddlyspace;

var _subWikify = Wikifier.prototype.subWikify;

var cleanedTitle = 'This section has been cleaned of any potentially harmful code';

var replaceFunctions = {
    html: function(w) {
        var sanitizedHTML, spanEl;
        this.lookaheadRegExp.lastIndex = w.matchStart;
        var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
        if(lookaheadMatch &amp;&amp; lookaheadMatch.index == w.matchStart) {
            sanitizedHTML = $.sanitize(lookaheadMatch[1]);
            spanEl = createTiddlyElement(w.output, 'span', null, 'sanitized');
            spanEl.innerHTML = sanitizedHTML;
            spanEl.setAttribute('title', cleanedTitle);
            w.nextMatch = this.lookaheadRegExp.lastIndex;
        }
    },
    customFormat: function(w) {
        switch(w.matchText) {
            case '@@':
                var e = createTiddlyElement(w.output, 'span');
                var styles = config.formatterHelpers.inlineCssHelper(w);
                if (styles.length === 0) {
                    e.className = 'marked';
                }
                w.subWikifyTerm(e, /(@@)/mg);
                break;
            case '{{':
                var lookaheadRegExp = /\{\{[\s]*([\w]+[\s\w]*)[\s]*\{(\n?)/mg;
                lookaheadRegExp.lastIndex = w.matchStart;
                var lookaheadMatch = lookaheadRegExp.exec(w.source);
                if(lookaheadMatch) {
                    w.nextMatch = lookaheadRegExp.lastIndex;
                    e = createTiddlyElement(w.output,lookaheadMatch[2] == "\n" ? "div" : "span",null,lookaheadMatch[1]);
                    w.subWikifyTerm(e,/(\}\}\})/mg);
                }
                break;
        }
    }
};

Wikifier.prototype.subWikify = function(output, terminator) {
    var tid = this.tiddler,
        spaceName = tiddlyspace.currentSpace.name,
        tidSpace, recipeName, stripped;
    try {
        recipeName = tid.fields['server.recipe'] ||
            tid.fields['server.workspace'];
        tidSpace = tiddlyspace.resolveSpaceName(recipeName);
        if (tidSpace !== spaceName) {
            // external tiddler, so replace dangerous formatters
            stripped = stripHTML(tid, this.formatter);
        }
    } catch(e) {
        // do nothing. There's no tiddler, so assume it's safe (?!?!?)
    }

    _subWikify.apply(this, arguments);

    if (stripped) {
        // change back to the original function
        unstripHTML(stripped, this.formatter);
    }
};

// replace potentially unsafe formatters with versions that strip bad HTML/CSS
var stripHTML = function(tid, formatter) {
    var popped = {}, _handler;
    for (var i = 0; i &lt; formatter.formatters.length; i++) {
        var f = formatter.formatters[i];
        if (replaceFunctions[f.name]) {
            _handler = f.handler;
            popped[f.name] = _handler;
            f.handler = replaceFunctions[f.name];
        }
    };

    return popped;
};

// put the original formatters back where they belong
var unstripHTML = function(stripped, formatter) {
    for (var i = 0; i &lt; formatter.formatters.length; i++) {
        var f = formatter.formatters[i];
        if (stripped[f.name]) {
            f.handler = stripped[f.name];
        }
    };
};

})(jQuery);
//}}}</pre>
</div>

<div title="missingIcon">
<pre>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</pre>
</div>

<div title="MarkupPreHead">
<pre>&lt;!--{{{--&gt;
&lt;link href="/bags/pearl_public/tiddlers.atom" rel="alternate"
    type="application/atom+xml" title="pearl's public feed" /&gt;
&lt;link rel="canonical" href="http://pearl.tiddlyspace.com/" /&gt;
&lt;!--}}}--&gt;</pre>
</div>

<div title="privateAndPublicIcon">
<pre>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</pre>
</div>

<div title="BinaryTiddlersPlugin">
<pre>/***
|''Name''|BinaryTiddlersPlugin|
|''Description''|renders base64-encoded binary tiddlers as images or links|
|''Author''|FND|
|''Version''|0.3.2|
|''Status''|@@beta@@|
|''Source''|http://svn.tiddlywiki.org/Trunk/association/plugins/BinaryTiddlersPlugin.js|
|''License''|[[BSD|http://www.opensource.org/licenses/bsd-license.php]]|
|''CoreVersion''|2.5|
!Code
***/
//{{{
(function($) {

"use strict";

var ctfield = "server.content-type";

var plugin = config.extensions.BinaryTiddlersPlugin = {
    isWikiText: function(tiddler) {
        var ctype = tiddler.fields[ctfield];
        if(ctype) {
            if (ctype === 'text/x-tiddlywiki') {
                return true;
            }
            return !this.isBinary(tiddler) &amp;&amp; !this.isTextual(ctype);
        } else {
            return true;
        }
    },
    // NB: pseudo-binaries are considered non-binary here
    isBinary: function(tiddler) {
        var ctype = tiddler.fields[ctfield];
        return ctype ? !this.isTextual(ctype) : false;
    },
    isTextual: function(ctype) {
        return ctype.indexOf("text/") === 0
            || this.endsWith(ctype, "+xml")
            || ctype === 'application/json'
            || ctype === 'application/javascript';
    },
    endsWith: function(str, suffix) {
        return str.length &gt;= suffix.length &amp;&amp;
            str.substr(str.length - suffix.length) === suffix;
    },
    isLink: function(tiddler) {
        return this.isBinary(tiddler) &amp;&amp; tiddler.text.indexOf("&lt;html&gt;") !== -1;
    }
};

// Disable edit for linked tiddlers (for now)
// This will be changed to a GET then PUT
config.commands.editTiddler.isEnabled = function(tiddler) {
    var existingTest = config.commands.editTiddler.isEnabled;
    if (existingTest) {
        return existingTest &amp;&amp; !plugin.isLink(tiddler);
    } else {
        return !plugin.isLink(tiddler);
    }
};

// hijack text viewer to add special handling for binary tiddlers
var _view = config.macros.view.views.wikified;
config.macros.view.views.wikified = function(value, place, params, wikifier,
        paramString, tiddler) {
    var ctype = tiddler.fields["server.content-type"];
    if(params[0] === "text" &amp;&amp; ctype &amp;&amp; ctype !== 'text/x-tiddlywiki' &amp;&amp;
            !tiddler.tags.contains("systemConfig") &amp;&amp; !plugin.isLink(tiddler)) {
        var el;
        if(plugin.isBinary(tiddler)) {
            var uri = "data:%0;base64,%1".format([ctype, tiddler.text]); // TODO: fallback for legacy browsers
            if(ctype.indexOf("image/") === 0) {
                el = $("&lt;img /&gt;").attr("alt", tiddler.title).attr("src", uri);
            } else {
                el = $("&lt;a /&gt;").attr("href", uri).text(tiddler.title);
            }
        } else {
            el = $("&lt;pre /&gt;").text(tiddler.text);
        }
        el.appendTo(place);
    } else {
        _view.apply(this, arguments);
    }
};

// hijack edit macro to disable editing of binary tiddlers' body
var _editHandler = config.macros.edit.handler;
config.macros.edit.handler = function(place, macroName, params, wikifier,
        paramString, tiddler) {
    if(params[0] === "text" &amp;&amp; plugin.isBinary(tiddler)) {
        return false;
    } else {
        _editHandler.apply(this, arguments);
    }
};

// hijack autoLinkWikiWords to ignore binary tiddlers
var _autoLink = Tiddler.prototype.autoLinkWikiWords;
Tiddler.prototype.autoLinkWikiWords = function() {
    return plugin.isWikiText(this) ? _autoLink.apply(this, arguments) : false;
};

}(jQuery));
//}}}</pre>
</div>

<div title="ImageMacroPlugin">
<pre>/***
|''Name''|ImageMacroPlugin|
|''Version''|0.9.4|
|''Description''|Allows the rendering of svg images in a TiddlyWiki|
|''Author''|Osmosoft|
|''License''|[[BSD|http://www.opensource.org/licenses/bsd-license.php]]|
|''Notes''|Currently only works in modern browsers (not IE)|
|''Requires''|BinaryTiddlersPlugin|
!Usage
{{{&lt;&lt;image SVG&gt;&gt;}}} will render the text of the tiddler with title SVG as an SVG image (but not in ie where it will fail silently)
!!Parameters
width/height: specify width/height parameters
link: make the image link to a given location
tiddlyLink: link to a tiddler

!Notes
Binary tiddlers in TiddlyWeb when passed through the wikifier will be shown as images.
eg. {{{&lt;&lt;view text wikified&gt;&gt;}}} on a binary tiddler will show the image.
{{{&lt;&lt;view fieldname image&gt;&gt;}}}
will render the value of the tiddler field 'fieldname' as an image. This field can contain a tid
{{{&lt;&lt;image SiteIcon&gt;&gt;}}}
will create an image tag where the tiddler has content type beginning image and not ending +xml
will attempt to create svg object in other scenarios
{{{&lt;&lt;image /photos/x.jpg&gt;&gt;}}}
will create an image tag with src /photos/x.jpg as long as there is not a tiddler called /photos/x.jpg in 
which case it will render that tiddler as an image. Note for the case of svg files it will attempt to render as an svg if possible via the image
tag. It doesn't embed the svg in the dom for security reasons as svg code can contain javascript.
!Code
***/
//{{{
(function($) {

var macro = config.macros.image = {
    shim: "/bags/common/tiddlers/shim",
    ieVersion: config.browser.isIE ? parseInt(config.browser.ieVersion[1], 10) : false,
    svgns: "http://www.w3.org/2000/svg",
    xlinkns: "http://www.w3.org/1999/xlink", 
    svgAvailable: document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure", "1.1"),
    _fixPrefix: 1,
    _external_cache: {},
    _image_tag_cache: {},
    _image_dimensions: {},
    locale: {
        badImage: "This image cannot be displayed."
    },
    handler: function(place, macroName, params, wikifier, paramString, tiddler){
        var imageSource = params[0];
        // collect named arguments
        var args = macro.getArguments(paramString, params);
        this.renderImage(place, imageSource, args);
    },
    init: function() {
        var startupImages = store.getTaggedTiddlers("systemImage");
        var place = $("&lt;div /&gt;").attr("id", "systemImageArea").appendTo("body").hide()[0];
        for(var i = 0; i &lt; startupImages.length; i++) {
            var image = startupImages[i];
            macro.renderImage(place, image.title, { idPrefix: "" });
        }
        var data = new Image();
        data.onload = function() {
            // note ie 8 only supports data uris up to 32k so cannot be relied on
            macro.supportsDataUris = this.width != 1 || this.height != 1 ? false : true;
            macro.supportsDataUris = macro.ieVersion &amp;&amp; macro.ieVersion &lt; 9 ? false : macro.supportsDataUris;
        };
        data.onerror = data.onload;
        data.src = "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";
    },
    refreshImage: function(src) {
        var elements = macro._image_tag_cache[src] ? macro._image_tag_cache[src] : [];
        if(macro._image_dimensions[src]) {
            macro._image_dimensions[src] = false;
        }
        for(var i = 0; i &lt; elements.length; i++) {
            var el = $(elements[i]);
            var newSrc = "%0?nocache=%1".format(src, Math.random());
            el.attr("src", newSrc); // force reload
        }
    },
    isBinaryImageType: function(contentType) {
        return (contentType &amp;&amp; contentType.indexOf("image") === 0 &amp;&amp;
            contentType.indexOf("+xml") != contentType.length - 4) ? true : false;
    },
    isImageTiddler: function(tiddler) {
        return macro.isSVGTiddler(tiddler) || macro.isBinaryImageTiddler(tiddler);
    },
    isSVGTiddler: function(tiddler) {
        var type = tiddler ? tiddler.fields['server.content-type'] : false;
        return type == "image/svg+xml";
    },
    isBinaryImageTiddler: function(tiddler) {
        return macro.isBinaryImageType(tiddler.fields['server.content-type']);
    },
    renderImage: function(place, imageSource, options) {
        var imageTiddler = store.getTiddler(imageSource);
        var container;
        var classes = ["image"];
        if(options.link) {
            classes = classes.concat(["imageLink", "externalLink"]);
            container = $("&lt;a /&gt;").attr("href", options.link).appendTo(place)[0];
        } else if(options.tiddlyLink) {
            classes.push("imageLink");
            container = createTiddlyLink(place, options.tiddlyLink, false);
        } else {
            container = $("&lt;span /&gt;").appendTo(place)[0];
        }
        $(container).addClass(classes.join(" "));

        options = options ? options : {};
        if(imageTiddler &amp;&amp; macro.isBinaryImageTiddler(imageTiddler)) { // handle the case where we have an image url
            return macro._renderBinaryImageTiddler(container, imageTiddler, options);
        } else if(imageTiddler){ // handle the case where we have a tiddler
            return macro._renderSVGTiddler(container, imageTiddler, options);
        } else { // we have a string representing a url
            return macro._renderBinaryImageUrl(container, imageSource, options);
        }
    },
    _renderAlternateText: function(container, options) {
        var img;
        var src = options.src || "";
        if(options.width &amp;&amp; options.height) {
            img = $("&lt;img /&gt;").attr("src", src).addClass("svgImageText").attr("width", options.width).
                attr("height", options.height).appendTo(container);
        }
        var alt = options.alt;
        if(img &amp;&amp; alt) {
            img.attr("alt", alt).attr("title", alt);
        } else if(alt) {
            $(container).addClass("svgImageText").text(alt);
        }
        macro._image_tag_cache[src] = img;
    },
    _renderSVGTiddler: function(place, tiddler, options) {
        if(!options) {
            options = {};
        }
        merge(options, { tiddler: tiddler, fix: true});

        if(macro.svgAvailable) {
            this._importSVG(place, options); // display the svg
        } else if(options.altImage) {
            var image = options.altImage;
            delete options.altImage;
            this._renderBinaryImageUrl(place, image, options);
        } else {
            this._renderAlternateText(place, options); // instead of showing the image show the alternate text.
        }
    },
    _renderBinaryImageTiddler: function(place, tiddler, options) {
        var resourceURI;
        var fields = tiddler.fields;
        if(fields["server.type"] == "tiddlyweb") { // construct an accurate url for the resource
            resourceURI = "%0/%1/tiddlers/%2".format(config.defaultCustomFields["server.host"],
                fields["server.workspace"], encodeURI(fields["server.title"]));
        } else { // guess the url for the resource
            resourceURI = tiddler.title;
        }
        var ctype = fields["server.content-type"] || tiddler.type;
        var text = tiddler.text;
        if(macro.supportsDataUris &amp;&amp; ctype &amp;&amp; text.indexOf("&lt;html") == -1) {
            var uri = "data:%0;base64,%1".format(ctype, text);
            options.src = resourceURI;
            return macro._renderBinaryImageUrl(place, uri, options);
        } else if(options.src) {
            return macro._renderBinaryImageUrl(place, options.src, options);
        } else {
            return macro._renderBinaryImageUrl(place, resourceURI, options);
        }
    },
    _renderImageTag: function(container, src, width, height, options) {
        var img;
        img = $("&lt;img /&gt;").appendTo(container);
        if(height) {
            img.attr("height", height);
        }
        if(width) {
            img.attr("width", width);
        }
        if(macro.ieVersion &amp;&amp; macro.ieVersion &lt; 7 &amp;&amp; macro.shim &amp;&amp; options.ie6png) {
            $(img).css({width: userW, height: userH,
                    filter: "progid:DXImageTransform.Microsoft.AlphaImageLoader(src='%0', sizingMethod='scale')".format(src)
                }).attr("src", macro.shim);
        } else {
            img.attr("src", src);
        }
        if(!macro._image_tag_cache[options.srcUrl]) {
            macro._image_tag_cache[options.srcUrl] = [];
        }
        img = $(img).addClass(options.imageClass)[0];
        macro._image_tag_cache[options.srcUrl].push(img);
        return img;
    },
    _getDimensions: function(realDimensions, reqDimensions, preserve) {
        var w = realDimensions.width;
        var h = realDimensions.height;
        var reqh = reqDimensions.height;
        var reqw = reqDimensions.width;
        var finalw = w, finalh = h;
        var ratiow = reqw / w, ratioh = reqh / h;
        var scaledw = ratioh * w;
        var scaledh = ratiow * h;
        if(!reqw &amp;&amp; reqh) {
            finalw = scaledw;
            finalh = reqh;
        } else if(reqw &amp;&amp; !reqh) {
            finalw = reqw;
            finalh = scaledh;
        } else if(reqh &amp;&amp; reqw) {
            var preserveWidth = w &gt; h ? true : false;
            if(preserve) {
                if(preserveWidth &amp;&amp; scaledh &lt; reqh) {
                    finalh = scaledh;
                    finalw = reqw;
                } else {
                    finalh = reqh;
                    finalw = scaledw;
                }
            } else {
                finalw = reqw;
                finalh = reqh;
            }
        }
        return { width: parseInt(finalw, 10), height: parseInt(finalh, 10) };
    },
    _renderBinaryImageUrl: function(container, src, options) {
        var srcUrl = options.src ? options.src : src;
        srcUrl = srcUrl.indexOf("/") === -1 ? "/%0".format(srcUrl) : srcUrl; // for IE. 
        var image_dimensions = macro._image_dimensions[srcUrl];
        var image = new Image(); // due to weird scaling issues where you use just a width or just a height
        var createImageTag = function(dimensions, error) {
            if(error) {
                var altImage = options.altImage;
                if(altImage) {
                    delete options.altImage;
                    macro._renderBinaryImageUrl(container, altImage, options);
                } else {
                    options.src = src;
                    macro._renderAlternateText(container, options);
                }
            } else {
                var dim = macro._getDimensions(dimensions, { 
                    width: options.width, height: options.height }, options.preserveAspectRatio);
                options.srcUrl = srcUrl;
                macro._renderImageTag(container, src, dim.width, dim.height, options);
            }
        };

        if(!image_dimensions) {
            image.onload = function() {
                var dimensions = { width: image.width, height: image.height};
                macro._image_dimensions[srcUrl] = dimensions;
                createImageTag(dimensions);
            };
            image.onerror = function() {
                createImageTag(null, true);
            };
            image.src = src;
        } else {
            createImageTag(image_dimensions);
        }
    },
    _generateIdPrefix: function(){
        return "twsvgfix_" + (this._fixPrefix++).toString() + "_";
    },
    _fixSVG: function(childNodes, idPrefix) {
        var urlPattern = /url\(\#([^\)]*)\)*/ig;
        var fixes = [
        { attr: "id", pattern: /^(.*)$/ig },
        { attr: "href", namespace: macro.xlinkns, pattern: /^#(.*)$/ig }
        ];
        var url_fixes = ["filter", "fill", "mask", "stroke", "style"];
        for(var i = 0; i &lt; url_fixes.length; i++) {
            fixes.push({ attr: url_fixes[i], pattern: urlPattern });
        }
        for(var t = 0; t &lt; childNodes.length; t++) {
            var node = childNodes[t];
            for(var a = 0; a &lt; fixes.length; a++) {
                var fix = fixes[a];
                var attr = fix.attr;
                var ns = fix.namespace || "";
                if(node.hasAttributeNS &amp;&amp; node.hasAttributeNS(ns, attr)) {
                    var v = node.getAttributeNS(ns, attr);
                    fix.pattern.lastIndex = 0;
                    var match = fix.pattern.exec(v);
                    if(match) {
                        // Make sure replacement string doesn't contain any single dollar signs
                        var toReplace = match[1];
                        if(toReplace.indexOf(idPrefix) !== 0 &amp;&amp; toReplace.indexOf("twglobal_") !== 0) {
                            var replacement = (idPrefix + toReplace).replace("$", "$$$$"); 
                            v = v.replace(match[1], replacement);
                        }
                        node.setAttributeNS(ns, attr,v);
                    }
                }
            }
            var children = node.childNodes;
            if(children.length &gt; 0) {
                this._fixSVG(children, idPrefix);
            }
        }
    },
    _importSVG: function(place, options){
        options = options ? options : {};
        var svgDoc, tiddlerText = options.tiddler.text;
        if (window.DOMParser) {
            svgDoc = new DOMParser().parseFromString(tiddlerText, "application/xml").documentElement;
            var idPrefix = options.idPrefix || this._generateIdPrefix();
            this._fixSVG([svgDoc], idPrefix);
            var el = document.importNode(svgDoc, true);
            var svgHolder = document.createElementNS(macro.svgns,"svg");
            var width = options.width;
            var height = options.height;
            if(width || height) {
                if(width &amp;&amp; height) { // set view box of containing svg element based on the svg viewbox and width and height.
                    var viewBox = el.getAttribute("viewBox");
                    var topLeft = "0 0";
                    if(viewBox) {
                        topLeft = viewBox.replace(/([0-9]*) +([0-9]*) +([0-9]*) +([0-9]*) */gi,"$1 $2");
                    }
                    svgHolder.setAttributeNS(macro.svgns, "viewBox", "0 0 %0 %1".format(width, height));
                } else {
                    if(!width) {
                        width = el.getAttribute("width");
                    }
                    if(!height) {
                        height = el.getAttribute("height");
                    }
                }
                svgHolder.setAttribute("width", width);
                svgHolder.setAttribute("height", height);

                el.setAttribute("width", "100%");
                el.setAttribute("height", "100%");
                svgHolder.setAttribute("class", "svgImage svgIcon %0".format(options.imageClass || ""));
                svgHolder.appendChild(el);
                place.appendChild(svgHolder);
            }
            else {
                var existing = el.className ? el.className.baseVal : "";
                el.setAttribute("class","svgImage %0".format(existing));
                place.appendChild(el);
            }
            // if a tiddler attribute is set this is read as a link
            $("[tiddler], [tiddlyLink]", place).attr("refresh", "link").click(function(ev) {
                var tiddler = $(ev.target).attr("tiddlyLink");
                if(tiddler) {
                    story.displayTiddler(ev.target, tiddler);
                }
            });
        }
    },
    getArguments: function(paramString, params) {
        var args = paramString.parseParams("name", null, true, false, true)[0];
        var options = {};
        for(var id in args) {
            if(true) {
                var p = args[id];
                if(id == "def") {
                    options[id] = p;
                } else {
                    options[id] = p[0];
                }
            }
        }
        var width = isNaN(params[1]) ? false : parseInt(params[1], 10);
        var height = isNaN(params[2]) ? false : parseInt(params[2], 10);

        options.width = macro.lookupArgument(options, "width", width);
        options.height = macro.lookupArgument(options, "height", height);
        options.preserveAspectRatio = args.preserveAspectRatio &amp;&amp; 
            args.preserveAspectRatio[0] == "yes" ? true : false;
        options.tiddlyLink = macro.lookupArgument(options, "tiddlyLink", false);
        options.link = macro.lookupArgument(options, "link", false);
        return options;
    },
    lookupArgument: function(args, id, ifEmpty) {
        return args[id] ? args[id] : ifEmpty;
    }
};

// update views
var _oldwikifiedview = config.macros.view.views.wikified;
// update wikifier to check tiddler type before rendering
merge(config.macros.view.views, {
    wikified: function(value, place, params, wikifier, paramString, tiddler) {
        if(macro.isImageTiddler(tiddler) &amp;&amp; params[0] == "text") {
            var newplace = $("&lt;div /&gt;").addClass("wikifiedImage").appendTo(place)[0];
            macro.renderImage(newplace, tiddler.title, { alt: macro.locale.badImage });
        } else {
            _oldwikifiedview.apply(this, arguments);
        }
    },
    image: function(value, place, params, wikifier, paramString, tiddler) {
        // a field can point to another tiddler whereas text is the current tiddler.
        var title = params[0] == "text" ? tiddler.title : value;
        var args = macro.getArguments(paramString, params);
        macro.renderImage(place, title, args);
    }
});
config.shadowTiddlers.StyleSheetImageMacro = [".wikifiedImage svg, .wikifiedImage .image { width: 80%; }",
    ".svgImageText { background-color:[[ColorPalette::Error]]; color:#ddd; display: inline-block; }",
    "span.svgImageText { display: inline-block; overflow: hidden; }"
].join("");
store.addNotification("StyleSheetImageMacro", refreshStyles);

})(jQuery);
//}}}</pre>
</div>

<div title="ColorPalette">
<pre>/*{{{*/
Background: #f8dceb
Foreground: #220615
PrimaryPale: #fefafc
PrimaryLight: #edc4da
PrimaryMid: #b64884
PrimaryDark: #534a4f
SecondaryPale: #fafefd
SecondaryLight: #c4ede8
SecondaryMid: #48b6ab
SecondaryDark: #4a5352
TertiaryPale: #fafefa
TertiaryLight: #c4edc4
TertiaryMid: #48b648
TertiaryDark: #4a534a
Error: #f88
ColorPaletteParameters: HSL([327|27], [0.67|0.53|0.43|0.06],[0.31|0.5|0.85|0.99])
/*}}}*/</pre>
</div>

<div title="colorScheme">
<pre>Unless you're delighted with the default theme you can make some quick changes by generating a new random color palette, hit this button to cycle through some alternatives.

&lt;&lt;RandomColorPaletteButton saturation_pale:0.67 saturation_light:0.53
saturation_mid:0.43 saturation_dark:0.06 pale:0.99 light:0.85 mid:0.5 dark:0.31&gt;&gt;

You can also change the look and feel completely by installing a new theme. To do this, find one you like in the @themes space, note down the name, and include it in this space by going to the space menu. You can reach the space menu by clicking on the blue and pink circle at the top-right of the page and chooshing "THIS SPACE". Here are a few to check out:
* @pip
* @caspian-ii
* @basalt
* @simplicity
* @cheesecake
* @jelly-doughnut

(//Note that if you are using a custom TiddlySpace install, these themes may not be present.//)</pre>
</div>

<div title="谁会是你灵魂的摆渡人">
<pre>如果存在，那是需要，谁会是你灵魂的摆渡人</pre>
</div>

<div title="close.svg">
<pre>&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;
&lt;!-- Created with Inkscape (http://www.inkscape.org/) --&gt;

&lt;svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:xlink="http://www.w3.org/1999/xlink"
   version="1.1"
   width="14pt"
   height="14pt"
   viewBox="918 510 14 14"
   id="svg3070"&gt;
  &lt;metadata
     id="metadata3089"&gt;
    &lt;rdf:RDF&gt;
      &lt;cc:Work
         rdf:about=""&gt;
        &lt;dc:format&gt;image/svg+xml&lt;/dc:format&gt;
        &lt;dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" /&gt;
        &lt;dc:title&gt;&lt;/dc:title&gt;
      &lt;/cc:Work&gt;
    &lt;/rdf:RDF&gt;
  &lt;/metadata&gt;
  &lt;defs
     id="defs3072"&gt;
    &lt;radialGradient
       cx="0"
       cy="0"
       r="1"
       id="Gradient"
       gradientUnits="userSpaceOnUse"&gt;
      &lt;stop
         id="stop3075"
         style="stop-color:#ffffff;stop-opacity:1"
         offset="0" /&gt;
      &lt;stop
         id="stop3077"
         style="stop-color:#2b2b2b;stop-opacity:1"
         offset="1" /&gt;
    &lt;/radialGradient&gt;
    &lt;radialGradient
       id="Obj_Gradient"
       xlink:href="#Gradient"
       gradientTransform="matrix(11.473944,0,0,11.473944,922.3752,513.7837)" /&gt;
  &lt;/defs&gt;
  &lt;g
     id="g3080"
     style="fill:none;stroke:none"&gt;
    &lt;g
       id="g3082"&gt;
      &lt;path
         d="m 929.6952,512.9018 c -2.5384,-2.53843 -6.654,-2.53843 -9.1924,0 -2.5384,2.5384 -2.5384,6.654 0,9.19238 2.5384,2.53839 6.654,2.53839 9.1924,0 2.5384,-2.53838 2.5384,-6.65398 0,-9.19238 m -4.5962,2.8407 2.07733,-2.07734 1.75547,1.75549 -2.0773,2.07735 2.0773,2.07732 -1.75547,1.75548 -2.07733,-2.07732 -2.07733,2.07732 -1.75547,-1.75548 2.0773,-2.07732 -2.0773,-2.07735 1.75547,-1.75549 z"
         id="path3084"
         style="fill:url(#Obj_Gradient)" /&gt;
      &lt;path
         d="m 927.61447,515.38354 a 4.51205,4.2590378 0 1 1 -9.0241,0 4.51205,4.2590378 0 1 1 9.0241,0 z"
         transform="matrix(1.0218069,0,0,1.0462046,-18.063694,-21.648443)"
         id="path2394"
         style="fill:#000000;fill-opacity:0;fill-rule:evenodd;stroke:none;stroke-width:5;marker:none;visibility:visible;display:inline;overflow:visible;enable-background:accumulate" /&gt;
    &lt;/g&gt;
  &lt;/g&gt;
&lt;/svg&gt;</pre>
</div>

<div title="publicIcon">
<pre>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</pre>
</div>

<div title="backstage.svg">
<pre>&lt;svg xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="100%" width="100%" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 40 40"&gt;&lt;metadata&gt;&lt;rdf:RDF&gt;&lt;cc:Work rdf:about=""&gt;&lt;dc:format&gt;image/svg+xml&lt;/dc:format&gt;&lt;dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/&gt;&lt;dc:title/&gt;&lt;/cc:Work&gt;&lt;/rdf:RDF&gt;&lt;/metadata&gt;&lt;defs&gt;&lt;linearGradient id="lG3826" x1="7.0996" gradientUnits="userSpaceOnUse" y1="18.829" gradientTransform="matrix(1.5858347,0,0,1.8078238,1098.1851,351.13716)" x2="1.5461" y2="-0.95166"&gt;&lt;stop stop-color="#000" offset="0"/&gt;&lt;stop stop-color="#9c9b99" offset="1"/&gt;&lt;/linearGradient&gt;&lt;linearGradient id="lG3828" y2="372.44" gradientUnits="userSpaceOnUse" y1="375.7" x2="1111.7" x1="1097.7"&gt;&lt;stop style="stop-color:#ac9393;" offset="0"/&gt;&lt;stop style="stop-color:#c8b7b7;" offset="1"/&gt;&lt;/linearGradient&gt;&lt;/defs&gt;&lt;g transform="translate(-1080.9375,-357.3329)"&gt;&lt;path style="stroke-width:0;stroke-miterlimit:4;fill:url(#lG3826);" d="m1080.9,357.32,39.996-0.0426-0.01,40.008c-15.507-25.519-15.36-25.95-39.988-39.965z"/&gt;&lt;path style="stroke-dashoffset:0;stroke:#7aa3be;stroke-linecap:round;stroke-miterlimit:4;stroke-width:1.49999988;fill:#c1e6fd;" d="m1091.9,363.55c6.5716-6.4925,16.576-7.3925,23.147-0.90003,6.5717,6.4925,6.5717,17.019,0,23.511-4.4424-8.6113-12.288-15.713-23.147-22.611z"/&gt;&lt;path style="stroke-dashoffset:0;stroke:#ce81b0;stroke-linecap:round;stroke-miterlimit:4;stroke-width:1.5;fill:#f4c4e2;" d="m1110.2,367.62c3.217,3.2168,3.217,8.4323,0,11.649-3.8194-4.2357-8.3307-8.1824-11.649-11.649,3.217-3.2168,8.4325-3.2168,11.649-0.00002z"/&gt;&lt;path style="stroke-linejoin:bevel;stroke:#000000;stroke-linecap:round;stroke-dasharray:none;stroke-miterlimit:4;stroke-width:0.80000001;fill:url(#lG3828);" d="m1081,357.34c18.79,6.4752,32.53,16.56,39.894,39.892-11.19-17.028-14.878-19.19-27.352-14.96,6.2984-12.098,3.9371-13.19-12.542-24.932z"/&gt;&lt;/g&gt;&lt;/svg&gt;</pre>
</div>

<div title="editTiddlerReadOnly">
<pre>&lt;svg xmlns="http://www.w3.org/2000/svg" xmlns:xl="http://www.w3.org/1999/xlink" version="1.1" viewBox="506 234 68 36" width="30" height="30"&gt;&lt;metadata xmlns:dc="http://purl.org/dc/elements/1.1/"&gt;&lt;dc:date&gt;2010-09-16 14:51Z&lt;/dc:date&gt;&lt;!-- Produced by OmniGraffle Professional 5.2.3 --&gt;&lt;/metadata&gt;&lt;defs&gt;&lt;/defs&gt;&lt;g stroke="none" stroke-opacity="1" stroke-dasharray="none" fill="none" fill-opacity="1"&gt;&lt;rect width="1118" height="783"/&gt;&lt;g&gt;&lt;path d="M 538.68195 244.31807 C 540.43927 246.07547 540.43927 248.9247 538.68195 250.68204 C 536.92456 252.4394 534.07532 252.4394 532.318 250.68204 C 530.5606 248.9247 530.5606 246.07547 532.318 244.31807 C 534.07532 242.56075 536.92456 242.56075 538.68195 244.31807 M 511.12607 257.99356 C 511.26108 258.13019 511.39728 258.26608 511.53473 258.40121 C 527.2556 273.86606 552.74414 273.86606 568.46515 258.40121 C 568.60248 258.26617 568.73853 258.13037 568.87354 257.9938 C 568.8736 257.99374 568.8736 257.99371 568.8736 257.99362 C 568.87366 257.99371 568.87366 257.9938 568.87372 257.9939 C 570.72504 256.12051 572.35046 254.11153 573.74994 252 C 573.74994 251.99997 573.74994 251.99994 573.74994 251.99992 C 572.35046 249.8884 570.72504 247.87938 568.87372 246.00606 C 568.87366 246.00613 568.87366 246.00621 568.8736 246.00627 C 568.73865 245.86966 568.60254 245.73383 568.46515 245.5987 C 552.74414 230.13387 527.2556 230.13387 511.53473 245.5987 C 511.39728 245.73383 511.26108 245.86974 511.12613 246.00635 C 511.126 246.00624 511.126 246.00616 511.12595 246.00606 C 509.2748 247.87938 507.64954 249.88837 506.24994 251.9998 L 506.24994 251.99983 C 506.24994 251.9999 506.25 251.99992 506.25 251.99997 C 506.25 252 506.24994 252.00005 506.24994 252.00009 L 506.24994 252.00012 C 507.64954 254.11157 509.2748 256.12051 511.12595 257.9939 C 511.126 257.99377 511.126 257.99365 511.12607 257.99359 Z M 515.44916 252 C 515.8548 251.55469 516.27502 251.11778 516.71014 250.68985 C 522.16632 245.32257 529.06055 242.23206 536.17273 241.41824 C 534.6662 241.96199 533.2525 242.83762 532.04498 244.04512 C 527.65155 248.43852 527.65155 255.56163 532.04498 259.95502 C 533.2522 261.16226 534.6656 262.03778 536.17175 262.58154 C 529.05988 261.76761 522.16608 258.6771 516.71014 253.31009 C 516.2751 252.88219 515.85486 252.44528 515.44922 252 Z M 564.55054 251.99995 C 564.14502 252.44525 563.7248 252.88217 563.28973 253.31009 C 557.83368 258.67712 550.93988 261.76764 543.828 262.58157 C 545.33423 262.03781 546.74756 261.1623 547.9549 259.95502 C 552.34833 255.56163 552.34833 248.43852 547.9549 244.04512 C 546.74744 242.83765 545.33374 241.96202 543.82715 241.41824 C 550.9394 242.23206 557.83356 245.3226 563.28973 250.68985 C 563.7248 251.11775 564.14502 251.55467 564.55054 251.99995 Z M 568.8736 257.99362 C 570.7249 256.12033 572.35028 254.11139 573.74988 252.00002" fill="black" class="glyph"/&gt;&lt;/g&gt;&lt;/g&gt;&lt;/svg&gt;</pre>
</div>

<div title="How to socialise">
<pre>There are a lot of interesting people using ~TiddlySpace that you might like to keep track of and interact with. There are a number of ways of doing this.

If you see a number in the speech bubble in one of your tiddlers, it means that someone is writing about the same thing as you. You can find out what they're saying by clicking on it. Likewise, if you see something interesting in someone else's space, you can respond to it and write up your own thoughts on the subject by clicking "Reply to this tiddler".

Additionally, if you find anyone interesting, or you find an interesting looking space and you'd like to know when it's changed, you can "follow" that space. To do this, simply create a tiddler with the title: {{{@space-name}}} and tag it {{{follow}}}. If you want, you can store some notes about that space in the body of the tiddler.

If you then want to know what happening, simply [[include|How do I include/exclude spaces?]]@docs the @tivity space and then visit your activity stream at [[/activity|/activity]], or just visit the @tapas space directly.

!Not sure who to follow?
Here's a few suggestions:
* @fnd
* @cdent
* @pmario
* @bengillies
* @dickon</pre>
</div>

<div title="TiddlySpaceFollowingPlugin">
<pre>/***
|''Name''|TiddlySpaceFollowingPlugin|
|''Version''|0.7.1|
|''Description''|Provides a following macro|
|''Author''|Jon Robson|
|''Requires''|TiddlySpaceConfig TiddlySpaceTiddlerIconsPlugin ErrorHandler|
|''License''|[[BSD|http://www.opensource.org/licenses/bsd-license.php]]|
!Usage
Tag a tiddler with "follow" to express a list of followers.
Using the {{{&lt;&lt;followTiddlers X&gt;&gt;}}}
will reveal the number of tiddlers with name X in the set of spaces the *current* user viewing your space follows.
{{{&lt;&lt;following jon&gt;&gt;}}} will list all the users following Jon.
{{{&lt;&lt;followers jon&gt;&gt;}}} will list all the followers of jon.
{{{&lt;linkedTiddlers&gt;&gt;}}} will list all tiddlers across TiddlySpace linked to the current tiddler
{{{&lt;linkedTiddlers follow:yes&gt;&gt;}}} will list all tiddlers across TiddlySpace that come from your list of followers
adds spaceLink view type {{{&lt;&lt;view server.bag spaceLink&gt;&gt;}}} creates a link to the space described in server.bag
{{{&lt;&lt;view server.bag spaceLink title&gt;&gt;}}} makes a link to the tiddler with title expressed in the field title in space server.bag
If no name is given eg. {{{&lt;&lt;following&gt;&gt;}}} or {{{&lt;&lt;follow&gt;&gt;}}} it will default the current user.
!StyleSheet
.followTiddlersList li {
    list-style:none;
}

.followButton {
    width: 2em;
}

.followTiddlersList li .siteIcon {
    height:48px;
    width: 48px;
}

#sidebarTabs .followers li a,
.followers .siteIcon,
.followers .siteIcon div {
    display: inline;
}

.followTiddlersList li .externalImage, .followTiddlersList li .image {
    display: inline;
}

.scanResults li {
    list-style: none;
}
!Code
***/
//{{{
(function($) {
var LIMIT_FOLLOWING = 100;

var tweb = config.extensions.tiddlyweb;
var tiddlyspace = config.extensions.tiddlyspace;
var currentSpace = tiddlyspace.currentSpace.name;

var shadows = config.shadowTiddlers;
config.annotations.ScanTemplate = "This tiddler is the default template used in the display of tiddlers founding using the tsScan macro. To access attributes use the view macro e.g. {{{&lt;&lt;view title text&gt;&gt;}}}";
shadows.ScanTemplate = "&lt;&lt;view modifier SiteIcon width:24 height:24 spaceLink:yes label:no&gt;&gt; &lt;&lt;view title link&gt;&gt;";
shadows.FollowersTemplate = "&lt;&lt;view server.bag SiteIcon width:24 height:24 spaceLink:yes label:no&gt;&gt; &lt;&lt;view server.bag spaceLink&gt;&gt;";
shadows.FollowingTemplate = "&lt;&lt;view title SiteIcon width:24 height:24 spaceLink:yes label:no&gt;&gt; &lt;&lt;view title spaceLink&gt;&gt;";
shadows.FollowTiddlersBlackList = "";
shadows.FollowTiddlersHeading = "There are tiddlers in spaces you follow using the follow tag which use the title &lt;&lt;view title text&gt;&gt;";
shadows.FollowTiddlersTemplate = ["* &lt;&lt;view server.space SiteIcon width:24 height:24 spaceLink:yes label:no&gt;&gt; ",
    "&lt;&lt;view server.space spaceLink title external:no&gt;&gt; modified by &lt;&lt;view modifier spaceLink&gt;&gt; ",
    "in the &lt;&lt;view server.space spaceLink&gt;&gt; space (&lt;&lt;view modified date&gt;&gt; @ &lt;&lt;view modified date 0hh:0mm&gt;&gt;).\n"].join("");

var name = "StyleSheetFollowing";
shadows[name] = "/*{{{*/\n%0\n/*}}}*/".
    format(store.getTiddlerText(tiddler.title + "##StyleSheet"));
store.addNotification(name, refreshStyles);

// provide support for sucking in tiddlers from the server
tiddlyspace.displayServerTiddler = function(src, title, workspace, callback) {
    var adaptor = store.getTiddlers()[0].getAdaptor();
    var localTitle = tiddlyspace.getLocalTitle(title, workspace);
    var tiddler = new Tiddler(localTitle);
    tiddler.text = "Please wait while this tiddler is retrieved...";
    tiddler.fields.doNotSave = "true";
    store.addTiddler(tiddler);
    src = story.displayTiddler(src || null, tiddler.title);
    tweb.getStatus(function(status) {
        var context = {
            host: tweb.host, // TODO: inherit from source tiddler?
            workspace: workspace,
            headers: { "X-ControlView": "false" }
        };
        var getCallback = function(context, userParams) {
            var tiddler = context.tiddler;
            tiddler.title = localTitle;
            store.addTiddler(tiddler);
            story.refreshTiddler(localTitle, null, true); // overriding existing allows updating
            if(callback) {
                callback(src, tiddler);
            }
        };
        adaptor.getTiddler(title, context, null, getCallback);
    });
};

tiddlyspace.scroller = {
    runHandler: function(title, top, bottom, height) {
        var i;
        var handlers = tiddlyspace.scroller.handlers;
        var tidEl = story.getTiddler(title);
        if(tidEl) {
            var topEl = $(tidEl).offset().top + 20;
            if(top === false || (topEl &gt; top &amp;&amp; topEl &lt; bottom)) {
                var h = handlers[title];
                for(i = 0; i &lt; h.length; i++) {
                    h[i]();
                }
                tiddlyspace.scroller.clearHandlers(title);
            }
        } else {
            tiddlyspace.scroller.clearHandlers(title);
        }
    },
    clearHandlers: function(title) {
        tiddlyspace.scroller.handlers[title] = [];
    },
    registerIsVisibleEvent: function(title, handler) {
        tiddlyspace.scroller.handlers[title] = tiddlyspace.scroller.handlers[title] || [];
        tiddlyspace.scroller.handlers[title].push(handler);
    },
    init: function() {
        this.handlers = {};
        this.interval = window.setInterval(function() {
            var top = $(window).scrollTop();
            var height = $(window).height();
            var bottom = top + height;
            var title;
            for(title in tiddlyspace.scroller.handlers) {
                if(title) {
                    tiddlyspace.scroller.runHandler(title, top, bottom, height);
                }
            }
        }, 2000); // every 2 seconds check scroll position
    }
};
tiddlyspace.scroller.init();

var followMacro = config.macros.followTiddlers = {
    locale: {
        followListHeader: "Here are tiddlers from spaces you follow using the follow tag which use this title.",
        noTiddlersFromFollowers: "None of the spaces you follow contain a tiddler with this name.",
        errorMessage: "There was a problem retrieving tiddlers from the server. Please try again later."
    },
    init: function() {
        followMacro.lookup = {};
    },
    followTag: "follow",
    getHosts: function(callback) {
        tweb.getStatus(function(status) {
            callback(tweb.host, tiddlyspace.getHost(status.server_host, "%0"));
        });
    },
    getBlacklist: function() {
        return store.getTiddlerText("FollowTiddlersBlackList").split("\n");
    },
    handler: function(place, macroName, params, wikifier, paramString, tiddler) {
        var args = paramString.parseParams("anon")[0];
        var containingTiddler = story.findContainingTiddler(place).getAttribute('tiddler');
        var title = (args.anon &amp;&amp; args.anon[0]) || tiddler.fields["server.title"] || tiddler.title;
        var tid = store.getTiddler(title);
        var user = params[1] || false;
        if(tid) {
            followMacro.makeButton(place, {
                url: "/search?q=title:%22" + encodeURIComponent(title) + "%22",
                containingTiddler: containingTiddler,
                blacklisted: followMacro.getBlacklist(), title: title, user: user,
                consultFollowRelationship: (args.follow &amp;&amp;
                    args.follow[0] === 'false') ? false : true });
        }
    },
    makeButton: function(place, options) { // this is essentially the same code in TiddlySpaceFollowingPlugin
        var title = options.title;
        var blacklisted = options.blacklisted;
        var tiddler = store.getTiddler(title);
        var btn = $('&lt;div class="followButton" /&gt;').addClass("notLoaded").appendTo(place)[0];
        if(blacklisted.contains(title)) {
            $(btn).remove();
            return;
        } else {
            var user = options.user;
            window.setTimeout(function() { // prevent multiple calls due to refresh
                tiddlyspace.scroller.registerIsVisibleEvent(options.containingTiddler, function() {
                    var mkButton = function(followers, ignore) {
                        if(!followers &amp;&amp; !ignore) {
                            $(btn).remove();
                        } else {
                            $("&lt;a /&gt;").appendTo(btn);
                            var scanOptions = { url: options.url,
                                spaceField: options.spaceField || "bag", template: null, sort: "-modified",
                                callback: function(tiddlers) {
                                    $(btn).removeClass("notLoaded");
                                    followMacro.constructInterface(btn, tiddlers);
                                }
                            };
                            if(!ignore) {
                                scanOptions.showBags = followMacro._getFollowerBags(followers);
                            }
                            scanOptions.hideBags = [tiddler.fields["server.bag"]];
                            scanMacro.scan(null, scanOptions, user);
                        }
                    };
                    if(options.consultFollowRelationship) {
                        followMacro.getFollowers(mkButton);
                    } else {
                        mkButton([], true);
                    }
                });
            }, 1000);
        }
    },
    constructInterface: function(container, tiddlers) {
        var txt = tiddlers.length;
        var className = txt &gt; 0 ? "hasReplies" : "noReplies";
        var el = $(story.findContainingTiddler(container));
        $(container).empty().addClass(className);
        var btn = $("&lt;a /&gt;").addClass("followedTiddlers").text(txt).
            click(function(ev) {
                followMacro.followingOnClick(ev);
            }).appendTo('&lt;div class="followedTiddlers" /&gt;').appendTo(container)[0];
        $.data(btn, "tiddlers", tiddlers);
    },
    followingOnClick: function(ev) {
        var target = ev.target;
        var locale = followMacro.locale;
        var el = $('&lt;div class="followTiddlersList" /&gt;')[0];
        var popup = Popup.create(target,"div");
        $(popup).addClass("taggedTiddlerList followList").click(function(ev) { // make it so only clicking on the document outside the popup removes the popup
            if(ev.target.parentNode != document) {
                ev.stopPropagation();
            }
        }).append(el);
        var tiddlers = $.data(target, "tiddlers") || [];
        scanMacro.template(el, tiddlers.slice(0,1), "FollowTiddlersHeading");
        scanMacro.template(el, tiddlers, "FollowTiddlersTemplate");
        if(tiddlers.length === 0) {
            $("&lt;li /&gt;").text(locale.noTiddlersFromFollowers).appendTo(el);
        }
        Popup.show();
        ev.stopPropagation();
        return popup;
    },
    _getFollowerBags: function(followers) { // XXX: private or not?
        return $.map(followers, function(name, i) {
            return name != currentSpace ? "%0_public".format(name) : null;
        });
    },
    getFollowers: function(callback, username) {
        // returns a list of spaces being followed by the existing space
        var followersCallback = function(user) {
            if(!user.anon) {
                scanMacro.scan(null, { 
                    url: "/search?q=bag:%0_public tag:%1 _limit:%2".format(user.name, followMacro.followTag, LIMIT_FOLLOWING),
                    spaceField: "title", template: null, cache: true,
                    callback: function(tiddlers) {
                        var followers = [];
                        for(var i = 0; i &lt; tiddlers.length; i++) {
                            followers.push(tiddlyspace.resolveSpaceName(tiddlers[i].title));
                        }
                        callback(followers);
                    }
                });
            } else {
                callback(false);
            }
        };
        return !username ? tweb.getUserInfo(followersCallback) : followersCallback({ name: username });
    }
};

var scanMacro = config.macros.tsScan = {
    init: function () {
        this.scanned = {};
    },
    _tiddlerfy: function(jsontiddlers, options) {
        var tiddlers = [];
        var spaceField = options.spaceField || "bag"; // TODO: phase out use view types instead
        $.each(jsontiddlers, function(i, t) {
            var use = false;
            if(!options.showBags || (options.showBags &amp;&amp; options.showBags.contains(t.bag))) {
                use = true;
            }
            if(options.hideBags &amp;&amp; options.hideBags.contains(t.bag)) {
                use = false;
            }
            if(use) {
                var spaceName = t[spaceField];
                var tiddler = config.adaptors.tiddlyweb.toTiddler(t, tweb.host);
                tiddler.fields["server.space"] = tiddlyspace.resolveSpaceName(spaceName);
                tiddlers.push(tiddler);
            }
        });
        return tiddlers;
    },
    _scanCallback: function(place, jsontiddlers, options) {
        var locale = followersMacro.locale;
        var tiddlers = scanMacro._tiddlerfy(jsontiddlers, options);
        
        if(options.sort) {
            tiddlers = store.sortTiddlers(tiddlers, options.sort);
        }
        if(options.filter) {
            var _store = new TiddlyWiki();
            config.lastStore = _store;
            for(var i = 0; i &lt; tiddlers.length; i++) {
                var clone = tiddlers[i];
                clone.title = tiddlyspace.getLocalTitle(clone.title, clone.fields['server.workspace']);
                _store.addTiddler(clone);
            }
            tiddlers = _store.filterTiddlers(options.filter);
        }
        if(place) {
            $(place).empty();
            var list = $("&lt;ul /&gt;").appendTo(place)[0];
            scanMacro.template(list, tiddlers, options.template);
            if(tiddlers.length === 0) {
                $("&lt;li /&gt;").text(options.emptyMessage || locale.noone).appendTo(list);
                $(list).addClass("emptyList");
            }
        }
        if(options.callback) {
            options.callback(tiddlers);
        }
    },
    constructSearchUrl: function(host, options) {
        if(options.url) {
            return options.url;
        }
        var inputs = options.searchValues;
        var tag = options.tag;
        var searchField = options.searchField || "title";
        var searchQuery = [];
        for(var i = 0; i &lt; inputs.length; i++) {
            searchQuery.push('%0:"%1"'.format(searchField, inputs[i]));
        }
        var query = searchQuery.join(" OR ");
        query = tag ? "(%0) AND tag:%1".format(query, tag) : query;
        query = options.query ? "%0;%1;".format(query, options.query) : query;
        query = options.fat ? "%0&amp;fat=1".format(query) : query;
        return '%0/search?q=%1'.format(host, query);
    },
    scan: function(place, options) { // TODO: make use of list macro with url filter
        var locale = followersMacro.locale;
        options.template = options.template ? options.template : "ScanTemplate";
        followMacro.getHosts(function(host, tsHost) {
            $(place).text(followersMacro.locale.pleaseWait);
            options = options ? options: {};
            var url = scanMacro.constructSearchUrl(host, options);
            if(options.cache &amp;&amp; scanMacro.scanned[url]) {
                var tiddlers = scanMacro.scanned[url].tiddlers;
                var run = function(tiddlers) {
                    scanMacro._scanCallback(place, tiddlers, options);
                };
                if(tiddlers) {
                    run(tiddlers);
                } else {
                    scanMacro.scanned[url].callbacks.push(run);
                }
            } else {
                var callback = function(tiddlers) {
                    scanMacro._scanCallback(place, tiddlers, options);
                };
                if(scanMacro.scanned[url] &amp;&amp; scanMacro.scanned[url].callbacks) {
                    scanMacro.scanned[url].callbacks.push(callback);
                } else {
                    scanMacro.scanned[url] = {
                        callbacks: [callback]
                    };
                }
                ajaxReq({
                    url: url,
                    dataType: "json",
                    success: function(tiddlers) {
                        scanMacro.scanned[url].tiddlers = tiddlers;
                        var callbacks = scanMacro.scanned[url].callbacks;
                        while(callbacks.length &gt; 0) {
                            callbacks.pop()(tiddlers);
                        }
                    },
                    error: function(xhr) {
                        $(place).empty();
                        $("&lt;span /&gt;").addClass("annotation error").text(locale.error.format(xhr.status)).appendTo(place);
                    }
                });
            }
        });
    },
    template: function(place, tiddlers, template) { // TODO: make use of list macro.
        for(var i = 0; i &lt; tiddlers.length; i++) {
            var tiddler = tiddlers[i];
            var item = $('&lt;li class="spaceName" /&gt;').appendTo(place)[0];
            var spaceName = tiddler.fields["server.space"] || "";
            var templateText = store.getTiddlerText(template).replace(/\$1/mg, spaceName);
            wikify(templateText, item, null, tiddler);
        }
    },
    getOptions: function(paramString, tiddler) {
        var args = paramString.parseParams("name", null, true, false, true)[0];
        var options = { query: false, sort: false, tag: false, template: false, showBags: args.show || false,
            hideBags: args.hide || false, filter: false, spaceField: "bag", searchField: "title", fat: false,
            emptyMessage: false };
        for(var name in args) {
            if(name != "name") {
                if(name == "fat") {
                    options[name] = true;
                } else {
                    options[name] = args[name][0];
                }
            }
        }
        // if user has set searchField to modifier, then use the modifiers value if available otherwise use searchValues.
        var searchField = options.searchField;
        var searchValues = args[searchField] ? args[searchField] : args.searchValues;
        // if neither of those were used use the first parameter
        var defaultValues = tiddler ? [ tiddler.title ] : [];
        options.searchValues = searchValues ? searchValues : ( args.name ? [args.name[0]] : defaultValues);
        return options;
    },
    handler: function(place, macroName, params, wikifier, paramString, tiddler) {
        var container = $("&lt;div /&gt;").addClass("scanResults resultsArea").appendTo(place)[0];
        var options = scanMacro.getOptions(paramString, tiddler);
        scanMacro.scan(container, options);
    }
};

var followersMacro = config.macros.followers = {
    locale: {
        loggedOut: "Please login to see the list of followers",
        noSupport: "We were unable to retrieve followers as your browser does not support following.",
        pleaseWait: "Please wait while we look this up...",
        error: "Error %0 occurred whilst retrieving data from server",
        noone: "None."
    },
    handler: function(place, macroName, params, wikifier, paramString, tiddler) {
        var locale = followersMacro.locale;
        var args = paramString.parseParams("name", null, true, false, true)[0];
        var username = args.name ? args.name[0] : false;
        var container = $('&lt;div class="followers" /&gt;').text(locale.pleaseWait).
            appendTo(place)[0];
        var followersCallback = function(user) {
            if(user.anon) {
                $("&lt;span /&gt;").text(locale.loggedOut).appendTo(container);
            } else {
                var options = scanMacro.getOptions(paramString);
                $.extend(options, {
                    url: "/search?q=title:@%0 OR title:%0 tag:%1 _limit:%2".
                        format(user.name, followMacro.followTag, LIMIT_FOLLOWING),
                    spaceField: "bag",
                    template: options.template ? options.template : "FollowersTemplate"
                });
                scanMacro.scan(container, options);
            }
        };
        return !username ? followersCallback({ name: currentSpace }) : followersCallback({ name: username });
    }
};

var followingMacro = config.macros.following = {
    locale: {
        pleaseWait: followersMacro.locale.pleaseWait,
        loggedOut: "Please login to see who you are following",
        noSupport: followersMacro.locale.noSupport,
        error: followersMacro.locale.error,
        noone: followersMacro.locale.noone
    },
    handler: function(place, macroName, params, wikifier, paramString, tiddler) {
        var locale = followingMacro.locale;
        var args = paramString.parseParams("name", null, true, false, true)[0];
        var fat = args.fat ? true : false;
        var username = args.name ? args.name[0] : false;
        var container = $('&lt;div class="following" /&gt;').text(locale.pleaseWait).
            appendTo(place)[0];
        var followingCallback = function(user) {
            if(user.anon) {
                $("&lt;span /&gt;").text(locale.loggedOut).appendTo(container);
            } else {
                var options = scanMacro.getOptions(paramString);
                $.extend(options, {
                    url: "/search?q=bag:%0_public tag:%1 _limit:%2".format(user.name, followMacro.followTag, LIMIT_FOLLOWING),
                    spaceField: "title",
                    template: options.template ? options.template : "FollowingTemplate"
                });
                scanMacro.scan(container, options);
            }
        };
        return !username ? followingCallback({ name: currentSpace }) : followingCallback({ name: username });
    }
};

var linkedMacro = config.macros.linkedTiddlers = {
    handler: function(place, macroName, params, wikifier, paramString, tiddler) {
        var args = paramString.parseParams("anon")[0];
        var title = params[0] || tiddler.fields["server.title"] || tiddler.title;
        var tid = store.getTiddler(title);
        var containingTiddler = story.findContainingTiddler(place).getAttribute('tiddler');
        if(tid) {
            followMacro.makeButton(place, {
                spaceField: "recipe",
                url: "/bags/%0/tiddlers/%1/backlinks".format(tid.fields['server.bag'],
                    encodeURIComponent(tid.title)),
                blacklisted: followMacro.getBlacklist(),
                title: title,
                containingTiddler: containingTiddler,
                user: params[1] || false,
                consultFollowRelationship: args.follow ? true : false });
        }
    }
};

if(config.options.chkFollowTiddlersIsLinkedTiddlers) {
    merge(config.macros.followTiddlers, config.macros.linkedTiddlers);
    config.shadowTiddlers.FollowTiddlersHeading = "These are the other tiddlers that link to this tiddler.";
}

})(jQuery);
//}}}</pre>
</div>

<div title="SystemSettings">
<pre>chkPrivateMode: false</pre>
</div>

<div title="StyleSheetTiddlySpace">
<pre>/*{{{*/
body {
    font-size: 1em;
    font-family: helvetica, arial, sans-serif;
    background-color: #fff;
    color: [[ColorPalette::Foreground]];
}

body ul { margin: 0; }

#popup {
    background-color: [[ColorPalette::TertiaryPale]];
}

#popup.confirmationPopup, .followList {
    font-size: 0.8em;
    padding: 1em;
    border: solid 1px [[ColorPalette::SecondaryMid]];
    background-color: [[ColorPalette::SecondaryPale]];
}

.followList .listTitle {
    text-decoration: underline;
}

#popup .followTiddlersList a {
    display: inline;
    padding: 0;
}

#popup li a {
    color: [[ColorPalette::PrimaryMid]];
    font-weight: bold;
}

#popup li a:hover {
    color: [[ColorPalette::PrimaryPale]];
    background: [[ColorPalette::PrimaryMid]];
}

#popup li.listTitle {
    border-bottom: 1px solid #000;
    font-weight: bold;
    margin-bottom: 10px;
}

#popup.followList {
    margin-left: 50px;
    margin-top: -30px;
}

.followTiddlersList .label {
    display: block;
    left: 10px;
    top: 0px;
    line-height: 16px;
    position: relative;
}

#popup .followTiddlersList .siteIcon{
    height: auto;
}

#popup .followTiddlersList li{
    clear: both;
    display: block;
    height: 48px;
    margin-bottom: 8px;
    position: relative;
}

#popup .followTiddlersList a{
    display: inline;
}

#displayArea {
    margin: 0;
    top: 0px;
    left: 0px;
    width: 100%;
    position: relative;
}

.revisionCloak {
    position: absolute;
    position: fixed !important;
    height: 100%;
    width: 100%;
    top: 0;
    left: 0;
    border: 0;
    margin: 0;
    padding: 0;
    opacity: 0.5;
    filter: alpha(opacity=50);
    background-color: #000;
}

/* *** Header *** */
.header {
    position: relative;
    background-color: [[ColorPalette::PrimaryMid]];
    _width: 100%; /* ie 6 demands */
}

.headerForeground {
    background-color: [[ColorPalette::PrimaryMid]];
    float: left;
    margin: 24px 16px 0px 72px;
    padding: 0;
    position: relative;
    top: 0;
    _width: 70%; /*ie6: needed for the background to actually be transparent*/
    _background-color: transparent; /*ie6: needed to show the search box*/
}

.clearFloat {
    clear: both;
}

#contentWrapper {
    position: relative;
    padding-top: 1px;
    top: -1px;
}

#tiddlerDisplay {
    _position: relative; /* ie 6*/
}

.siteTitle {
    clear: both;
    display: block;
    font-size: 32px;
    font-weight: bold;
    line-height: 32px;
}

.siteSubtitle {
    display: block;
    font-size: 14px;
    height: 16px;
    margin-bottom: 8px;
}

#sidebarSearch {
    padding: 0;
    position: absolute;
    right: 80px;
    top: 8px;
    width: 176px;
}

#sidebarSearch .txtOptionInput {
    width: 100%;
    margin-top: 5px;
    _color: #bbb; /* ie6 danger */
}

#sidebarSearch .txtOptionInput:focus {
    color: #000;
}

#sidebarSearch .searchButton {
    display: none;
}

/* *** Menu Bar *** */

#mainMenu {
    position: static;
    text-align: left;
    margin-left: 72px;
    float: left;
    width: auto;
    padding: 0;
    font-size: 1em;
    line-height: normal;
}

#mainMenu a {
    color: #fff;
    padding: 8px;
    font-size: 0.9em;
    margin-right: 16px;
}

#mainMenu a:hover {
    background-color: [[ColorPalette::PrimaryMid]];
    color: [[ColorPalette::Background]]
}

#sidebarOptions {
    margin-right: 72px;
    float: right;
    font-size: 1.1em;
    line-height: 1.6em;
    min-height: 1em;
    padding-top: 0;
}

#sidebarOptions a {
    margin-right: 8px;
}

.confirmationPopup .button,
#sidebarOptions .button {
    cursor: pointer;
    line-height: 1.4em;
    text-align: center;
    margin-right: 8px;
    margin-left:-2px;
}

.confirmationPopup .button {
    font-size: 0.9em;
    padding: 2px;
}

#sidebarOptions .button {
    font-size: 0.7em;
    float: left;
    width: 80px;
    padding: 0px;
        color: #fff;
}

.confirmationPopup a.button,
#sidebarOptions a {
    border: none;
    margin: 0 0.2em;
    padding: 0.6em 0.25em;
    display: inline;
    color: #666;
}

.confirmationPopup a.button:hover,
#sidebarOptions a:hover {
    color: #000;
}

.confirmationPopup a.button:active,
#sidebarOptions a:active {
    border: solid 1px [[ColorPalette::PrimaryMid]];
    background-color: #fff;
    background: -webkit-gradient( linear, left bottom, left top, color-stop(0.1,rgb(200,200,200)), color-stop(1, rgb(100,100,100)));
    background: -moz-linear-gradient(center bottom , rgb(200,200,200) 10%,rgb(100,100,100) 100%) repeat scroll 0 0 transparent;
}
/* *** Sidebar *** */

#sidebar .wizard table {
    margin: 0px;
}

.tabContents .listTitle:first-child {
    margin-top: 0px;
}

#menuBar {
    background: [[ColorPalette::PrimaryLight]];
    left: 0;
    right: 0;
    position: relative;
    margin: 0;
    padding: 0.5em 0 0.5em 0;
    min-height: 1em;
    overflow: hidden;
    _width: 100%; /* for ie 6 */
}

#sidebarOptions a.button:hover {
    color: [[ColorPalette::PrimaryPale]];
    background: [[ColorPalette::PrimaryMid]];
}

#tiddlerDisplay, #searchResults {
    margin: 16px 448px 0 72px;
}

#sidebarTabs {
    position: absolute;
    right: 72px;
    width: 352px;
    top: 0;
}

#sidebarTabs .tabsetWrapper .tabset {
    width: 87px;
    border-top: 1px solid [[ColorPalette::PrimaryPale]];
    border-left: 1px solid [[ColorPalette::PrimaryPale]];
    border-bottom: 1px solid [[ColorPalette::PrimaryPale]];
    height: auto;
    float: left;
    word-wrap: break-word;
    top: 0;
    padding: 0;
}

#sidebarTabs .tabsetWrapper .tabContents {
    background-color: [[ColorPalette::PrimaryPale]];
    border: 3px solid [[ColorPalette::PrimaryMid]];
    width: 242px;
    _width: 238px;
    left: -3px;
    _left: -5px;
    position: relative;
    min-height: 34em;
    padding: 8px;
    font-size: 0.8em;
}

/* ---- Side style --- */

#sidebarTabs .tabsetWrapper .tabset .tab {
    font-size: 0.9em;
    padding: 0.7em 8px 0.5em;
    color: #fff;
    background: [[ColorPalette::PrimaryLight]];
    border: none;
    line-height: 16px;
    position: relative;
    display: block;
    margin: 0;
}

#sidebarTabs .tabsetWrapper .tabset .tabSelected {
    color: [[ColorPalette::PrimaryMid]];
    background: [[ColorPalette::PrimaryPale]];
    border-top: 3px solid [[ColorPalette::PrimaryMid]];
    border-bottom: 3px solid [[ColorPalette::PrimaryMid]];
    border-left: 3px solid [[ColorPalette::PrimaryMid]];
    z-index: 10;
    margin-top: -1px;
    font-weight: bold;
}

#sidebarTabs .tabContents li {
    border: none;
    margin-left: 0;
    word-wrap: break-word;
}

.tabContents .timeline {
    background: [[ColorPalette::PrimaryPale]];
    margin-bottom: 8px;
}

#sidebarTabs .timeline li.listTitle {
    color: #132E43;
    margin-left: 8px 0;
    padding: 0.3em 0.11em;
    font-size: 1em;
    border-bottom: none;
}

#sidebarTabs .tabContents li a {
    display: block;
    text-align: left;
    margin: 0 0 1px 0;
    padding: 0.3em 1em;
    background: [[ColorPalette::PrimaryPale]];
}

#sidebarTabs .tabsetWrapper .tabset a:hover,
#sidebarTabs .tabContents li a:hover {
    color: [[ColorPalette::PrimaryPale]];
    background: [[ColorPalette::PrimaryMid]];
}

/* Activity Stream */
#sidebarTabs .tabContents .activityStream .feedItem a {
    display: inline-block;
    padding: 0;
    background: none;
}

/* ---- Tagging box --- */
.tagInfo {
    border: 1px solid #cccccc;
    padding: 10px 15px;
    -moz-box-shadow: 0 2px 2px rgba(0, 0, 0, 0.2);
    box-shadow: 0 2px 2px rgba(0,0,0,0.2);
    color: [[ColorPalette::TertiaryMid]];
    background: -moz-linear-gradient(100% 100% 90deg, #f4f4f4, #e5e5e5);
    background: -webkit-gradient(linear, left top, right top, from(#e5e5e5), to(#f4f4f4));
    margin-top: 1em;
    font-size: 13px;
    margin: 0 0 0 56px;
}

.tagInfo ul {
    list-style: none;
    padding-left: 2.2em;
}

.tagInfo ul li {
    display: inline;
}

.tagInfo ul li.listTitle,
.tagInfo .tagging ul li.listTitle {
    color: [[ColorPalette::PrimaryMid]];
    font-size: 13px;
}

.tagInfo ul li a {
    border: none;
}

.tagInfo .tagging ul li {
    float: none;
    display: inline-block;
}

.tagInfo .tagging {
    padding: 0;
}

.viewRevision .toolbar {
    right: 48px;
    top: 8px;
}

.viewRevision .modifierIcon img,
.viewRevision .modifierIcon svg {
    margin-right: 8px;
}

.viewRevision .toolbar svg {
    width: 32px;
    height: 32px;
}

/* --- IE hacks from lattice --- */

/* ie hacks */
* html #menuBar {
    margin-bottom: 8px;
}
.toolbar .svgIconText {
    *display: inline;
}

div.tiddler .toolbar a {
    cursor: pointer;
    float: left\9;
    display: inline\9;
}

* html .toolbar {
    right: 8px;
}
* html .followButton a {
    margin-top: 0px;
    margin-right: 8px;
}
* html #tiddlerDisplay {
    margin-top: 0px;
}

/* for printing purposes */
@media print {
    #mainMenu,
    #sidebar,
    #messageArea,
    .toolbar,
    .followPlaceHolder,
    #backstageButton,
    #backstageArea,
    #sidebarTabs,
    #sidebarSearch .txtOptionInput,
    #sidebarOptions {
        display: none !important;
    }
    #displayArea {
        margin: 1em 1em 0em;
    }
    noscript {
        display:none; /* Fixes a feature in Firefox 1.5.0.2 where print preview displays the noscript content */
    }
    #tiddlerDisplay {
        margin: 16px 16px;
    }
}

@media all and (max-width: 960px){
    #tiddlerDisplay,
    #searchResults {
        margin: 16px 366px 0 16px;
    }

    #mainMenu {
        margin-left: 16px;
    }

    .headerForeground {
        margin-left: 16px;
    }

    #sidebarSearch {
        right: 16px;
    }

    #sidebarOptions {
        margin-right: 16px;
    }

    #sidebarTabs {
        right: 16px;
        width: 326px;
    }

    #sidebarTabs .tabsetWrapper .tabset {
        font-size: 0.9em;
        width: 77px;
    }

    #sidebarTabs .tabsetWrapper .tabContents {
        width: 226px;
        _width: 222px;
    }

    #sidebarTabs .tabContents li a {
        font-size: 0.9em;
    }
}
/*}}}*/
[[StyleSheetTiddler]]</pre>
</div>

<div title="ischools中两所大学的对比">
<pre>新加坡管理大学

一、学校简介：新加坡管理大学(简称新大,SMU)创建于2000年1月12日，是新加坡政府投资创办的第三所公立大学，是以世界级水平研究和卓越教学著称的亚洲顶尖学府。其中信息系统学院（SIS）是一个在国际上关于信息系统技术、信息系统管理及相关技术与管理交集问题教学上获得认可的学院。它是除北美国家外第一个被ischools所认可学校，它拥有深厚的技术研究及创造能力，在教学战略上选择的领域是信息技术、系统及应用程序。
二、在校人员及学院划分：新大目前学生规模为8000多名，其中本科生7000多名，分布于六个学院会计学院、李光前商学院、经济学院、信息系统学院、法律学院以及社会科学学院。
三、主要研究方向：
（1）本科生研究教学方向：集成业务及技术、IT体系结构、设计和开发技能、项目管理、企业信息系统的应变技能
（2）硕士生研究教学方向：集成技术及对特定服务行业操作的集成技术在数据为中心的视角上为服务行业提高服务、强调在服务交付过程、数据操作、数据分析、解决方案和企业IT体系结构之间的联系、
（3）博士生研究教学方向：网络完全、数据管理与分析、信息系统与管理、智能系统与决策分析、软件及Cyber-physical系统



加利福利亚大学伯克利分校

学校简介：加利福尼亚大学伯克利分校(University of California-Berkeley，简称UC Berkeley、Berkeley或Cal 加州大学伯克利分校，伯克利加州大学)是美国顶尖公立研究型大学，也是世界上最富盛名且最顶尖的公立大学。加州大学伯克利分校是加利福尼亚大学中最老的一所，也是美国大学协会(Association of American Universities)创始会员之一，其中加州大学伯克利分校信息学院的最新的和最小的学校。位于校园的中心,该校是一个主要致力于研究扩大获取信息,提高其可用性、可靠性和可信度同时保护安全和隐私。
在校人员及学院分布：加州大学伯克利分校以传统的多学科综合为主，以新兴学科和专业学院为辅。全校共有14个学院，涵盖170个系所。
主要研究教学方向：
（1）信息管理和系统硕士学位研究教学方向：是一个计划为期两年的全职项目,旨在培养学生成功获取信息的专业技能。需要计算机科学、认知科学、心理学和社会学,经济学,商业,法律,图书馆及信息研究和通讯多学课综合教学。
（2）信息和数据科学硕士（MIDS）研究教学方向：处理大规模数据需要独特的新技能和工具。MIDS程序具有广泛的学科广度;但其他项目仅关注高等数学和建模,MIDS程序从社会科学和政策研究提供了在统计,计算机科学和工程帮助。
（3）信息管理和系统博士学位研究教学方向：旨在提供的资源,支持有想象力的学者们追求新思想,开展他们自己的研究,进化世界各地的信息。


</pre>
</div>

<div title="TiddlySpaceCSRF">
<pre>(function() {
var getCSRFToken = function(window) {
    // XXX: should not use RegEx - cf.
    // http://www.quirksmode.org/js/cookies.html
    // https://github.com/TiddlySpace/tiddlyspace/commit/5f4adbe009ed4bda3ce39058a3fb07de1420358d
    var regex = /^(?:.*; )?csrf_token=([^(;|$)]*)(?:;|$)/;
    var match = regex.exec(document.cookie);
    var csrf_token = null;
    if (match &amp;&amp; (match.length === 2)) {
        csrf_token = match[1];
    }

    return csrf_token;
};

if (typeof config !== 'undefined' &amp;&amp; config.extensions &amp;&amp;
        config.extensions.tiddlyspace &amp;&amp;
        config.extensions.tiddlyspace.getCSRFToken === null) {
    config.extensions.tiddlyspace.getCSRFToken = getCSRFToken;
} else {
    window.getCSRFToken = getCSRFToken;
}
})(window);</pre>
</div>

<div title="moreCommand">
<pre>&lt;svg xmlns="http://www.w3.org/2000/svg" xmlns:xl="http://www.w3.org/1999/xlink" version="1.1" viewBox="434 218 68 68"
width="30" height="30"&gt;
&lt;g stroke="none" stroke-opacity="1" stroke-dasharray="none" fill="none" fill-opacity="1"&gt;
    &lt;g&gt;
        &lt;path d="M 478.39694 232.53705 L 478.39694 232.53705 
        C 477.1145 231.85132 475.77875 231.30147 474.41058 230.88734 L 474.41058 218.24994 L 461.58942 218.24994 
        L 461.58942 230.88734 C 460.22125 231.30147 458.8855 231.85132 457.60306 232.53705 L 448.66824 223.60214 
        L 439.6022 232.66814 L 448.53717 241.60304 C 447.8515 242.8854 447.30157 244.22116 446.88745 245.58936 
        L 434.25 245.58936 L 434.25 258.41052 L 446.88745 258.41052 
        C 447.30157 259.77869 447.8515 261.11447 448.53717 262.39688 L 439.6022 271.33173 L 448.66824 280.3978 
        L 457.60306 271.46283 C 458.8855 272.14862 460.22125 272.69846 461.58942 273.11252 L 461.58942 285.74988 
        L 474.41058 285.74988 L 474.41058 273.11252 C 475.77875 272.69846 477.1145 272.14862 478.39694 271.46283 
        L 487.33176 280.3978 L 496.39767 271.33173 L 487.46286 262.39688 
        C 488.14853 261.11447 488.69836 259.77869 489.11255 258.41052 L 501.74988 258.41052 L 501.74988 245.58936 
        L 489.11255 245.58936 C 488.69836 244.22116 488.14853 242.8854 487.46286 241.60304 L 496.39767 232.66814 
        L 487.33176 223.60214 Z M 475.3328 244.66714 C 479.3825 248.71698 479.3825 255.2829 475.3328 259.33273 
        C 471.28296 263.3826 464.71704 263.3826 460.66724 259.33273 
        C 456.61737 255.2829 456.61737 248.71698 460.66724 244.66714 
        C 464.71704 240.61734 471.28296 240.61734 475.3328 244.66714" fill="#111"
        class="glyph"/&gt;
    &lt;/g&gt;
&lt;/g&gt;
&lt;/svg&gt;</pre>
</div>

<div title="个人翻译部分">
<pre>关于信息污染的定义是稀少的，因此它是值得去探寻一些相关的概念，第一个被讨论的相关概念是信息质量，由于信息系统的传播和万维网的普及，在最近几年的关注中，信息质量取得了一些研究。低质量的信息被认为是信息污染，因为它将不能被使用并且被认为是没有必要的。信息质量被普遍地定义是使用信息的适用度（Bizer&amp;Cyganiak,2009）。因此，这也意味着信息质量是取决于任务本身，并且信息质量是客观的。取决于任务本身这一解释是被Arary&amp;Kopak支持的，他们说明质量的价值判断是取决于一个特定的目标和应用，其他重要的信息质量因素可能被看做是一些多方面的思考，一些可使用的特定属性的定义在信息质量研究中被发现。Tayloy定义了五种信息属性：精确度，综合性，流通性，可靠性和有效性。在近几年一系列属性的不同在信息质量架构中广泛地被接受并且定义了一份包含20种信息质量属性的丰富的表单。Davis&amp;Olson记录了在做决策的认知方面的信息质量有重要的三个因素：信息的多用性，信息确定性，信息的错误和偏见。从它提供了关于信息本身的因素和使用者的认知后，它确实成为一种很有用的理论。
目录：项目管理ERD数据模型应用MS-VISIO OKM
表格：数据表格成分和有关联的</pre>
</div>

<div title="ColorPalette [draft]">
<pre>/*{{{*/
Background: #e0dcf8
Foreground: #090622
PrimaryPale: #fbfafe
PrimaryLight: #c9c4ed
PrimaryMid: #5548b6
PrimaryDark: #4b4a53
SecondaryPale: #fdfefa
SecondaryLight: #e1edc4
SecondaryMid: #97b648
SecondaryDark: #51534a
TertiaryPale: #fefdfa
TertiaryLight: #edeac4
TertiaryMid: #b6b048
TertiaryDark: #53534a
Error: #f88
ColorPaletteParameters: HSL([247|10], [0.67|0.53|0.43|0.06],[0.31|0.5|0.85|0.99])
/*}}}*/</pre>
</div>

<div title="小组作业">
<pre>                                                              对信息垃圾的理解
因为信息垃圾是（信息）属性领域里的一种新发现，存在定义缺乏。对信息垃圾的观念将会被解构（通过）一种工具来理解这个话题。第一种成分被定义为信息。Himma在 2007年给了一种哲学上的解释。看得见得信息遵循着：信息，我们通常用这个称呼，它和“收集数据”这个动作有关联或者是这个处于已经被收集了这种状态下的数据，和因此采出来的一种正确的命题内容。例如：内容的价值是真或者假。(Floridi 在2005年)广义上来说，对信息的简单定义是“有用的数据”或者“有用的回答”。（Hornsby在2003年）“垃圾”在另一种方面，本质有在英语上有两个解释：1、那些被用完就丢走的不想要的事情或者其他任何材料。2、那些你只需要取其其中小数量价值的。（F Wijnhoven et al. 2012)“信息垃圾”因此被人们定义为不需要或者是没有价值的数据，是通过判断这个数据能否被我们拿到然后利用。第二种观点来自 Hicks(2007),描述信息垃圾作为一种补充的行为和增加的任何不作为的（数据），因为信息使用者不会立即提供通道（给你）机会，精确（数据），下载信息。
关于信息污染的定义是稀少的，因此它是值得去探寻一些相关的概念，第一个被讨论的相关概念是信息质量，由于信息系统的传播和万维网的普及，在最近几年的关注中，信息质量取得了一些研究。低质量的信息被认为是信息污染，因为它将不能被使用并且被认为是没有必要的。信息质量被普遍地定义是使用信息的适用度（Bizer&amp;Cyganiak,2009）。因此，这也意味着信息质量是取决于任务本身，并且信息质量是客观的。取决于任务本身这一解释是被Arary&amp;Kopak支持的，他们说明质量的价值判断是取决于一个特定的目标和应用，其他重要的信息质量因素可能被看做是一些多方面的思考，一些可使用的特定属性的定义在信息质量研究中被发现。Tayloy定义了五种信息属性：精确度，综合性，流通性，可靠性和有效性。在近几年一系列属性的不同在信息质量架构中广泛地被接受并且定义了一份包含20种信息质量属性的丰富的表单。Davis&amp;Olson记录了在做决策的认知方面的信息质量有重要的三个因素：信息的多用性，信息确定性，信息的错误和偏见。从它提供了关于信息本身的因素和使用者的认知后，它确实成为一种很有用的理论。
在英特网上一种极为普遍的信息浪费形式是众所周知的垃圾网页，Araujo和Martinez-Romo所陈述的“网页垃圾或垃圾索引，包括所有的技术使用有目的的去得到一个不正当的高等级。”正如一个巨大的正在持续增加的这部分交通对于网页位置来源于搜索引擎方式。得到一个高等级是很重要的通过他们的目标受众去发现网页位置。也有许多符合伦理道德的方式去助推一个网页的等级，通过提高整个内容的外观，也可以更加容易制作为网络爬虫检索内容。此外，制作这个网页对潜在的参观者是有利的，也能够提高一个网页的搜索引擎排名。不幸的是工艺页面对于这个基本用途的增加，搜索引擎的等级并没有提高这个页面的效用，这已经成了普遍的训练。最普遍的网页垃圾技术包括人工生成的内容或者关键字以及覆盖、重定向垃圾邮件和链接农场。网页垃圾严重的污染了搜索引擎，使得相关结果减少，对于所有者和搜索引擎使用者的位置是一个关键的问题，因为错误的和无意义的网页获得了高网页排名。
</pre>
</div>

<div title="SideBarOptions">
<pre>&lt;&lt;closeAll&gt;&gt;&lt;&lt;permaview&gt;&gt;&lt;&lt;newTiddler&gt;&gt;</pre>
</div>

<div title="shadowIcon">
<pre>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</pre>
</div>

<div title="ViewTemplate">
<pre>&lt;!--{{{--&gt;
&lt;div class='toolbar'
    macro='toolbar [[ToolbarCommands::ViewToolbar]] icons:yes height:16 width:16 more:popup'&gt;
&lt;/div&gt;
&lt;div class='heading'&gt;
    &lt;span class='spaceSiteIcon'
        macro='tiddlerOrigin label:no spaceLink:yes height:48 width:48 preserveAspectRatio:yes'&gt;
    &lt;/span&gt;
    &lt;span class="titleBar"&gt;
        &lt;div class='title' macro='view title text'&gt;&lt;/div&gt;
        &lt;span class="subtitle" macro='viewRevisions page:5'&gt;
            last modified on
            &lt;span macro="view modified date"&gt;&lt;/span&gt;
        &lt;/span&gt;
        &lt;div macro="view title replyLink"&gt;&lt;/div&gt;
    &lt;/span&gt;
    &lt;span class='followPlaceHolder' macro='followTiddlers'&gt;&lt;/span&gt;
    &lt;span class='modifierIcon'
        macro='view modifier SiteIcon label:no spaceLink:yes height:48 width:48 preserveAspectRatio:yes'&gt;
    &lt;/span&gt;
    &lt;div class='tagClear'&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class='content'&gt;
    &lt;div class='viewer' macro='view text wikified'&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class='tagInfo'&gt;
    &lt;div class='tidTags' macro='tags'&gt;&lt;/div&gt;
    &lt;div class='tagging' macro='tagging'&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!--}}}--&gt;</pre>
</div>

<div title="作业">
<pre>作业
&lt;html&gt;
&lt;head&gt;
      &lt;title&gt;第一个HTML代码&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div align="center"&gt;
&lt;img src="http://img.taopic.com/uploads/allimg/130929/235042-13092ZJ11945.jpg" hight="500" width="500" &gt;&lt;br/&gt;
&lt;/div&gt;
&lt;hr width="800" color="pink" size"10"/&gt;

&lt;/body&gt;
&lt;/html&gt;</pre>
</div>

<div title="MainMenu">
<pre>[[首页]] [[图片]] [[文件]] [[作业]] [[日志]]</pre>
</div>

<div title="editTiddler">
<pre>&lt;svg xmlns="http://www.w3.org/2000/svg" xmlns:xl="http://www.w3.org/1999/xlink" version="1.1" viewBox="301 225 48 52"
width="30" height="30"&gt;
&lt;g stroke="none" stroke-opacity="1" stroke-dasharray="none" fill="none" fill-opacity="1"&gt;
    &lt;g&gt;
        &lt;path d="M 333.00003 234 L 306 258.75003 L 301.5 270 L 312.75 265.50003 L 339.75 240.74998 Z M 337.5 229.50002 
        L 335.24988 231.75008 L 341.99997 238.50003 L 344.24997 236.24995 Z M 342 225.00003 L 339.74988 227.25009 
        L 346.5 234.00005 L 348.75 231.75003 Z M 301.5 273.9719 C 301.5 273.9719 309.59888 277.99927 317.70013 273.97183 
        C 325.80066 269.94437 341.99997 276.65686 341.99997 276.65686 L 341.99997 273.97195 
        C 341.99997 273.97195 325.80014 267.2594 317.70013 271.28687 C 309.6 275.31451 301.5 271.28683 301.5 271.28683 Z" 
        fill="#101010" class="glyph"/&gt;
    &lt;/g&gt;
&lt;/g&gt;
&lt;/svg&gt;</pre>
</div>

<div title="chrjs">
<pre>/***
https://raw.github.com/tiddlyweb/chrjs/master/main.js
***/
//{{{
// TiddlyWeb adaptor
// v0.14.3

/*jslint vars: true, unparam: true, nomen: true, white: true */
/*global jQuery */

var tiddlyweb = (function($) {

"use strict";

var tw = {
    routes: {
        // host is the TiddlyWeb instance's URI (including server_prefix)
        // placeholders "_type" &amp; "name" refer to the respective bag/recipe
        root     : "{host}/",
        bags     : "{host}/bags",
        bag      : "{host}/bags/{name}",
        recipes  : "{host}/recipes",
        recipe   : "{host}/recipes/{name}",
        tiddlers : "{host}/{_type}s/{name}/tiddlers",
        tiddler  : "{host}/{_type}s/{name}/tiddlers/{title}",
        revisions: "{host}/{_type}s/{name}/tiddlers/{title}/revisions",
        revision : "{host}/{_type}s/{name}/tiddlers/{title}/revisions/{revision}",
        search   : "{host}/search?q={query}"
    }
};

var convertTimestamp, supplant;

// host (optional) is the URI of the originating TiddlyWeb instance
tw.Resource = function(type, host) {
    if(arguments.length) { // initialization
        this._type = type;
        if(host !== false) {
            this.host = host !== undefined ? host.replace(/\/$/, "") : null;
        }
    }
};
$.extend(tw.Resource.prototype, {
    // retrieves resource from server
    // callback is passed resource, status, XHR (cf. jQuery.ajax success)
    // errback is passed XHR, error, exception, resource (cf. jQuery.ajax error)
    // filters is an optional filter string (e.g. "select=tag:foo;limit=5")
    get: function(callback, errback, filters) {
        var uri = this.route();
        if(filters) {
            var separator = uri.indexOf("?") === -1 ? "?" : ";";
            uri += separator + filters;
        }
        var self = this;
        return $.ajax({
            url: uri,
            type: "GET",
            dataType: "json",
            success: function(data, status, xhr) {
                var resource = self.parse(data);
                resource.etag = xhr.getResponseHeader("Etag");
                callback(resource, status, xhr);
            },
            error: function(xhr, error, exc) {
                errback(xhr, error, exc, self);
            }
        });
    },
    // sends resource to server
    // callback is passed data, status, XHR (cf. jQuery.ajax success)
    // errback is passed XHR, error, exception, resource (cf. jQuery.ajax error)
    put: function(callback, errback) {
        var self = this;
        var options = {
            url: this.route(),
            type: "PUT",
            contentType: "application/json",
            data: JSON.stringify(this.baseData()),
            success: function(data, status, xhr) {
                callback(self, status, xhr);
            },
            error: function(xhr, error, exc) {
                errback(xhr, error, exc, self);
            }
        };
        if(this.ajaxSetup) {
            this.ajaxSetup(options);
        }
        return $.ajax(options);
    },
    // deletes resource on server
    // callback is passed data, status, XHR (cf. jQuery.ajax success)
    // errback is passed XHR, error, exception, resource (cf. jQuery.ajax error)
    "delete": function(callback, errback) {
        var self = this;
        var options = {
            url: this.route(),
            type: "DELETE",
            success: function(data, status, xhr) {
                callback(self, status, xhr);
            },
            error: function(xhr, error, exc) {
                errback(xhr, error, exc, self);
            }
        };
        if(this.ajaxSetup) {
            this.ajaxSetup(options);
        }
        return $.ajax(options);
    },
    // returns an object carrying only the essential information of the resource
    baseData: function() {
        var data = {},
            self = this;
        $.each(this.data, function(i, item) {
            var value = self[item];
            if(value !== undefined) {
                data[item] = value;
            }
        });
        return data;
    },
    // returns corresponding instance from a raw object (if applicable)
    parse: function(data) {
        return data;
    },
    // list of accepted keys in serialization
    data: [],
    // returns resource's URI
    route: function() {
        return supplant(tw.routes[this._type], this);
    }
});

var Container = function(type, name, host) {
    if(arguments.length) { // initialization
        tw.Resource.apply(this, [type, host]);
        this.name = name;
        this.desc = "";
        this.policy = new tw.Policy({});
    }
};
Container.prototype = new tw.Resource();
$.extend(Container.prototype, {
    tiddlers: function() {
        return new tw.TiddlerCollection(this);
    },
    parse: function(data) {
        var type = tw._capitalize(this._type),
            container = new tw[type](this.name, this.host);
        data.policy = new tw.Policy(data.policy);
        return $.extend(container, data);
    },
    data: ["desc", "policy"]
});

// attribs is an object whose members are merged into the instance (e.g. query)
tw.Collection = function(type, host, attribs) {
    if(arguments.length) { // initialization
        tw.Resource.apply(this, [type, host]);
        $.extend(this, attribs);
    }
};
tw.Collection.prototype = new tw.Resource();

tw.TiddlerCollection = function(container, tiddler) {
    if(arguments.length) { // initialization
        tw.Collection.apply(this, [tiddler ? "revisions" : "tiddlers"]);
        this.container = container || null;
        this.tiddler = tiddler || null;
    }
};
tw.TiddlerCollection.prototype = new tw.Collection();
$.extend(tw.TiddlerCollection.prototype, {
    parse: function(data) {
        var container = this.container;
        return $.map(data, function(item, i) {
            var tiddler = new tw.Tiddler(item.title, container),
                bag = item.bag;
            tiddler = tw.Tiddler.prototype.parse.apply(tiddler, [item]);
            if(!tiddler.bag &amp;&amp; bag) { // XXX: bag always present!?
                tiddler.bag = new tw.Bag(bag, container.host);
            }
            if(!tiddler.recipe &amp;&amp; item.recipe) {
                tiddler.recipe = new tw.Recipe(item.recipe, container.host);
            }
            delete item.recipe;
            return $.extend(tiddler, item);
        });
    },
    route: function() {
        var params = this.container;
        if(this.tiddler) {
            var container = this.tiddler.bag || this.tiddler.recipe;
            params = {
                _type: container._type,
                host: container.host,
                name: container.name,
                title: this.tiddler.title
            };
        }
        return supplant(tw.routes[this._type], params);
    }
});

tw.Search = function(query, host) {
    tw.Collection.apply(this, ["search", host]);
    this.query = query;
};
tw.Search.prototype = new tw.Collection();
$.extend(tw.Search.prototype, {
    parse: function(data) {
        this.container = { // XXX: hacky
            _type: "bag",
            host: this.host
        };
        var tiddlers = tw.TiddlerCollection.prototype.parse.apply(this, arguments);
        delete this.container;
        return tiddlers;
    }
});

// title is the name of the tiddler
// container (optional) is an instance of either Bag or Recipe
// optionally accepts a single object representing tiddler attributes
tw.Tiddler = function(title, container) {
    tw.Resource.apply(this, ["tiddler", false]);
    this.title = title;
    this.bag = container &amp;&amp; container._type === "bag" ? container : null;
    this.recipe = container &amp;&amp; container._type === "recipe" ? container : null;
    var self = this;
    $.each(this.data, function(i, item) {
        self[item] = undefined; // exposes list of standard attributes for inspectability
    });
    if(title &amp;&amp; title.title) { // title is an object of tiddler attributes
        $.extend(this, title);
    }
};
tw.Tiddler.prototype = new tw.Resource();
$.extend(tw.Tiddler.prototype, {
    revisions: function() {
        return new tw.TiddlerCollection(this.bag || this.recipe, this);
    },
    route: function() {
        var container = this.bag || this.recipe;
        var params = $.extend({}, this, {
            host: container ? container.host : null,
            _type: this.bag ? "bag" : (this.recipe ? "recipe" : null),
            name: container ? container.name : null
        });
        return supplant(tw.routes[this._type], params);
    },
    parse: function(data) {
        var tiddler = new tw.Tiddler(this.title),
            container = this.bag || this.recipe;
        if(data.bag) {
            tiddler.bag = new tw.Bag(data.bag, container.host);
            delete data.bag;
        }
        delete data.recipe;
        tiddler.created = data.created ? convertTimestamp(data.created) : new Date();
        delete data.created;
        tiddler.modified = data.modified ? convertTimestamp(data.modified) : new Date();
        delete data.modified;
        if(this.recipe) {
            tiddler.recipe = this.recipe;
        }
        return $.extend(tiddler, data);
    },
    data: ["created", "creator", "modifier", "modified", "tags", "type", "text",
            "fields"],
    ajaxSetup: function(options) {
        var self = this;
        if(this.etag &amp;&amp; (options.type === "PUT" || options.type === "DELETE")) {
            options.beforeSend = function(xhr) {
                xhr.setRequestHeader("If-Match", self.etag);
            };
        }
        if(options.type === "PUT") {
            var callback = options.success;
            options.success = function(data, status, xhr) {
                var loc = xhr.getResponseHeader("Location"),
                    etag = xhr.getResponseHeader("Etag");
                if(loc &amp;&amp; etag) {
                    self.etag = etag;
                    if(!self.bag) {
                        var bag = loc.split("/bags/").pop().split("/")[0];
                        self.bag = new tw.Bag(bag, self.recipe.host);
                    }
                    callback(self, status, xhr);
                } else { // IE
                    self.get(callback, options.error);
                }
            };
        }
    }
});

tw.Revision = function(id, tiddler) {
    var container = tiddler.bag || tiddler.recipe;
    tw.Tiddler.apply(this, [tiddler.title, container]);
    this._type = "revision";
    this.revision = id;
};
tw.Revision.prototype = new tw.Tiddler();
$.extend(tw.Revision.prototype, {
    revisions: false,
    data: false,
    put: false,
    "delete": false
});

tw.Bag = function(name, host) {
    Container.apply(this, ["bag", name, host]);
};
tw.Bag.prototype = new Container();

tw.Recipe = function(name, host) {
    Container.apply(this, ["recipe", name, host]);
    this.recipe = [];
};
tw.Recipe.prototype = new Container();
$.extend(tw.Recipe.prototype, {
    data: ["recipe"].concat(Container.prototype.data)
});

tw.Policy = function(constraints) { // TODO: validation?
    var self = this;
    $.each(this.constraints, function(i, item) {
        self[item] = constraints[item];
    });
};
tw.Policy.prototype.constraints = ["read", "write", "create", "delete",
    "manage", "accept", "owner"];

/*
 * utilities
 */

tw._capitalize = function(str) {
    return str.charAt(0).toUpperCase() + str.slice(1);
};

// convert YYYYMMDDhhmmss timestamp to Date instance
convertTimestamp = function(t) {
    if (t.match(/^\d{12,17}$/)) {
        return new Date(Date.UTC(
            parseInt(t.substr(0, 4), 10),
            parseInt(t.substr(4, 2), 10) - 1,
            parseInt(t.substr(6, 2), 10),
            parseInt(t.substr(8, 2), 10),
            parseInt(t.substr(10, 2), 10),
            parseInt(t.substr(12, 2) || "0", 10),
            parseInt(t.substr(14, 3) || "0", 10)
        ));
    } else {
        return new Date(Date.parse(t));
    }
};

// adapted from Crockford (http://javascript.crockford.com/remedial.html)
supplant = function(str, obj) {
    return str.replace(/{([^{}]*)}/g, function (a, b) {
        var r = obj[b];
        r = typeof r === "string" || typeof r === "number" ? r : a;
        return $.inArray(b, ["host", "query"]) !== -1 ? r : encodeURIComponent(r); // XXX: special-casing
    });
};

return tw;

}(jQuery));
//}}}</pre>
</div>

<div title="favicon.ico">
<pre>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AP8zZgAAAGYA//8zAADMMwD/mTMAAGYzAP8zMwAAADMAzP8AAADMAADMmQAAAGYAAMwzAAAAAADuzAAA3QAAALvMAACqAAAAiMwAAHcAAABVmQAARAAAACKZAAARAADuAJkA3QAAALsAmQCqAAAAiACZAHcAAABVAJkARAAAACIAZgARAADuAABm3QAAALsAAGaqAAAAiAAAZncAAABVAABmRAAAACIAAGYRAAAA7u7uM93d3QC7u7szqqqqAIiIiDN3d3cAVVVVM0RERAAiIiIzERERAAAAADMBAQEBAQEBAQEBpXl5eXl5eXl5eXmlAQEBAQEBAQEBAQEBAQEBAQEBgHl5eXl5eXl5eXl5eXl5gAEBAQEBAQEBAQEBAQEB/Xp5eXlVT04qKioqTk9VeXl5ev0BAQEBAQEBAQEBAaV5eXlPKioqKioqKioqKioqT3l5eaUBAQEBAQEBAQGAeXlVTioqKioqKioqKioqKioqTlV5eYABAQEBAQEBgHl5VSoqKioqKioqKioqKioqKioqKlV5eYABAQEBAaV5eVUqKioqKioqKioqKioqKioqKioqKlV5eaUBAQEBeXlVKioqKioqKioqKioqKioqKioqKioqKlV5eQEBAXl5eU4qKioqKioqKjExMTExMSoqKioqKioqTnl5eQEBeXlPKioqKioqKjEyMjIyMjIyMjEqKioqKioqT3l5AXp5eSoqKioqKioxMjIxBwcHBzEyMjEqKioqKioqeXl6eXlVKioqKioqMTIxBwcHBwcHBwcxMjEqKioqKipVeXl5eU8qKioqKioyMgcHBwcHBwcHBwcyMioqKioqKk95eXl5TioqKioqMTIxBwcHBwcHBwcHBzEyMSoqKioqTnl5eXkqKioqKioxMgcHBwcHBwcHBwcHBzIxKioqKioqeXl5eSoqKioqKjEyBwcHBwcHBwcHBwcHMjEqKioqKip5eXl5KioqKioqMTIHBwcHBwcHBwcHBwcyMSoqKioqKnl5eXkqKioqKioxMgcHBwcHBwcHBwcHBzIxKioqKioqeXl5eU4qKioqKjEyMQcHBwcHBwcHBwcxMjEqKioqKk55eXl5TyoqKioqKjIyBwcHBwcHBwcHBzIyKioqKioqT3l5eXlVKioqKioqMTIxBwcHBwcHBwcxMjEqKioqKipVeXl6eXkqKioqKioqMTIyMQcHBwcxMjIxKioqKioqKnl5egF5eU8qKioqKioqMTIyMjIyMjIyMSoqKioqKipPeXkBAXl5eU4qKioqKioqKjExMTExMSoqKioqKioqTnl5eQEBAXl5VSoqKioqKioqKioqKioqKioqKioqKipVeXkBAQEB+nl5VSoqKioqKioqKioqKioqKioqKioqVXl5+gEBAQEBenl5VSoqKioqKioqKioqKioqKioqKlV5eXoBAQEBAQEBeXl5VU4qKioqKioqKioqKioqKk5VeXl5AQEBAQEBAQEBenl5eU8qKioqKioqKioqKipPeXl5egEBAQEBAQEBAQEB+nl5eXlVT04qKioqTk9VeXl5efoBAQEBAQEBAQEBAQEBAXl5eXl5eXl5eXl5eXl5eXkBAQEBAQEBAQEBAQEBAQEBAQF6eXl5eXl5eXl5eXoBAQEBAQEBAQEB/+AH//+AAf/+AAB//AAAP/gAAB/wAAAP4AAAB8AAAAPAAAADgAAAAYAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAYAAAAHAAAADwAAAA+AAAAfwAAAP+AAAH/wAAD/+AAB//4AB///gB/8oAAAAIAAAAEAAAAABACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAACAAAAAwAAAAMAAAADAAAABG1bSA61m3JXuqB4mbuhd8m9o3jqvaF4+b2hePm9o3jqu6F3ybqgeJm1m3JXbVtIDgAAAAQAAAADAAAAAwAAAAMAAAACAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAACAAAAAwAAAAUAAAAGAAAACI98Wye0nXWavKF4876kev++pHr/vqR6/76kev++pHr/vqR6/76kev++pHr/vqR6/76kev+8oXjztJ11mo98WycAAAAIAAAABgAAAAUAAAADAAAAAgAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAQAAAAHAAAAChwcHBKulnGJvaN5+L6kev++pHr/y7GJ/9/Fnv/s1K7/9t25//rivv/64r7/9t25/+zUrv/fxZ7/y7GJ/76kev++pHr/vaN5+K6WcYkcHBwSAAAACgAAAAcAAAAEAAAAAgAAAAEAAAAAAAAAAAAAAAEAAAADAAAABwAAAAtuYkUst552z76kev++pHr+1LuS//Latf/85cD//OXA//zlwP/85cD//OXA//zlwP/85cD//OXA//zlwP/85cD/8tq1/9S7kv++pHr+vqR6/7eeds9uYkUsAAAACwAAAAcAAAADAAAAAQAAAAAAAAABAAAAAgAAAAQAAAAIi3hbNbqgd+a+pHr/xayD/+3Vr//85cD//OXA//zlwP/85cD//OXA//zlwP/85cD//OXA//zlwP/85cD//OXA//zlwP/85cD//OXA/+3Vr//FrIP/vqR6/7qgd+aJdVg0AAAACAAAAAQAAAACAAAAAQAAAAEAAAACAAAABIl8WSW8oXjlvqR6/8yyiv/54Lz//OXA//zlwP/85cD//OXA//zlwP/85cD//OXA//zlwP/85cD//OXA//zlwP/85cD//OXA//zlwP/85cD//OXA//ngvP/Msor/vqR6/7yheOWJfFklAAAABAAAAAIAAAABAAAAAAAAAAFfXz8Iu6F4zL6kev/Msor/+uK+//zlwP/85cD//OXA//zlwP/85cD//OXA//zlwP/85cD//OXA//zlwP/85cD//OXA//zlwP/85cD//OXA//zlwP/85cD//OXA//rivv/Msor/vqR6/7uheMxfXz8IAAAAAQAAAAAAAAAAAAAAAbqid4K+pHr/xayD//ngvP/85cD//OXA//zlwP/85cD//OXA//zlwP/85cD//OXA//zlwP/85cD//OXA//zlwP/85cD//OXA//zlwP/85cD//OXA//zlwP/85cD//OXA//fgvP/FrIP/vqR6/7qid4IAAAABAAAAAAAAAAC3l28gvaN5+L6kev7t1a///OXA//zlwP/85cD//OXA//zlwP/85cD//OXA/+/Twv/Qq8f/u5HK/7OGzP+zhsz/u5HK/9Crx//v08L//OXA//zlwP/85cD//OXA//zlwP/85cD//OXA/+3Vr/++pHr+vaN5+LeXbyAAAAAAAAAAALuheJa+pHr/1LuS//zlwP/85cD//OXA//zlwP/85cD//OXA//riwP/Pq8f/r4HM/6+Bzf+vgc3/r4HN/6+Bzf+vgc3/r4HN/6+BzP/Pq8f/+uLA//zlwP/85cD//OXA//zlwP/85cD//OXA/9S5kv++pHr/u6F4lgAAAACii3MLvKF4876kev/y2rX//OXA//zlwP/85cD//OXA//zlwP/64sD/w5vJ/6+Bzf+vg83/w5vc/9W06v/dwPD/3cDw/9W06v/Dm9z/r4PN/6+Bzf/Dm8n/+uLA//zlwP/85cD//OXA//zlwP/85cD/8tq1/76kev+8oXjzootzC72feFW+pHr/y7GJ//zlwP/85cD//OXA//zlwP/85cD//OXA/8+rx/+vgc3/tIfQ/9a16//hw/P/4cPz/+HD8//hw/P/4cPz/+HD8//Wtev/tIfQ/6+Bzf/Pq8f//OXA//zlwP/85cD//OXA//zlwP/85cD/y7GJ/76kev+9n3hVvaF4mL6kev/fxZ7//OXA//zlwP/85cD//OXA//zlwP/v08L/r4HM/6+Dzf/Wtev/4cPz/+HD8//hw/P/4cPz/+HD8//hw/P/4cPz/+HD8//Wtev/r4PN/6+BzP/v08L//OXA//zlwP/85cD//OXA//zlwP/fxZ7/vqR6/72heJi8oXfIvqR6/+zUrv/85cD//OXA//zlwP/85cD//OXA/9Crx/+vgc3/w5vc/+HD8//hw/P/4cPz/+HD8//hw/P/4cPz/+HD8//hw/P/4cPz/+HD8//Dm9z/r4HN/9Crx//85cD//OXA//zlwP/85cD//OXA/+zUrv++pHr/vKF3yL2jeOq+pHr/9t25//zlwP/85cD//OXA//zlwP/85cD/u5HK/6+Bzf/VtOr/4cPz/+HD8//hw/P/4cPz/+HD8//hw/P/4cPz/+HD8//hw/P/4cPz/9W06v+vgc3/u5HK//zlwP/85cD//OXA//zlwP/85cD/9t25/76kev+9o3jqvaF4+b6kev/64r7//OXA//zlwP/85cD//OXA//zlwP+zhsz/r4HN/93A8P/hw/P/4cPz/+HD8//hw/P/4cPz/+HD8//hw/P/4cPz/+HD8//hw/P/3cDw/6+Bzf+zhsz//OXA//zlwP/85cD//OXA//zlwP/64r7/vqR6/72hePm9oXj5vqR6//rivv/85cD//OXA//zlwP/85cD//OXA/7OGzP+vgc3/3cDw/+HD8//hw/P/4cPz/+HD8//hw/P/4cPz/+HD8//hw/P/4cPz/+HD8//dwPD/r4HN/7OGzP/85cD//OXA//zlwP/85cD//OXA//rivv++pHr/vaF4+b2jeOq+pHr/9t25//zlwP/85cD//OXA//zlwP/85cD/u5HK/6+Bzf/VtOr/4cPz/+HD8//hw/P/4cPz/+HD8//hw/P/4cPz/+HD8//hw/P/4cPz/9W06v+vgc3/u5HK//zlwP/85cD//OXA//zlwP/85cD/9t25/76kev+9o3jqvKF3yL6kev/s1K7//OXA//zlwP/85cD//OXA//zlwP/Qq8f/r4HN/8Ob3P/hw/P/4cPz/+HD8//hw/P/4cPz/+HD8//hw/P/4cPz/+HD8//hw/P/w5vc/6+Bzf/Qq8f//OXA//zlwP/85cD//OXA//zlwP/s1K7/vqR6/7yhd8i9oXiYvqR6/9/Fnv/85cD//OXA//zlwP/85cD//OXA/+/Twv+vgcz/r4PN/9a16//hw/P/4cPz/+HD8//hw/P/4cPz/+HD8//hw/P/4cPz/9a16/+vg83/r4HM/+/Twv/85cD//OXA//zlwP/85cD//OXA/9/Fnv++pHr/vaF4mL2feFW+pHr/y7GJ//zlwP/85cD//OXA//zlwP/85cD//OXA/8+rx/+vgc3/tIfQ/9a16//hw/P/4cPz/+HD8//hw/P/4cPz/+HD8//Wtev/tIfQ/6+Bzf/Pq8f//OXA//zlwP/85cD//OXA//zlwP/85cD/y7GJ/76kev+9n3hVootzC7yhePO+pHr/8tq1//zlwP/85cD//OXA//zlwP/85cD/+uLA/8Obyf+vgc3/r4PN/8Ob3P/VtOr/3cDw/93A8P/VtOr/w5vc/6+Dzf+vgc3/w5vJ//riwP/85cD//OXA//zlwP/85cD//OXA//Latf++pHr/vKF486KLcwsAAAAAu6N3l76kev/Uu5L//OXA//zlwP/85cD//OXA//zlwP/85cD/+uLA/8+rx/+vgcz/r4HN/6+Bzf+vgc3/r4HN/6+Bzf+vgc3/r4HM/8+rx//64sD//OXA//zlwP/85cD//OXA//zlwP/85cD/1LmS/76kev+7oXiWAAAAAAAAAAC3l28gvaN5+L6kev7t1a///OXA//zlwP/85cD//OXA//zlwP/85cD//OXA/+/Twv/Qq8f/u5HK/7OGzP+zhsz/u5HK/9Crx//v08L//OXA//zlwP/85cD//OXA//zlwP/85cD//OXA/+3Vr/++pHr+vaN5+LeXbyAAAAAAAAAAAAAAAAC6oneCvqR6/8Wsg//54Lz//OXA//zlwP/85cD//OXA//zlwP/85cD//OXA//zlwP/85cD//OXA//zlwP/85cD//OXA//zlwP/85cD//OXA//zlwP/85cD//OXA//zlwP/34Lz/xayD/76kev+6oneCAAAAAAAAAAAAAAAAAAAAAH9/VQa8oHjLvqR6/8yyiv/64r7//OXA//zlwP/85cD//OXA//zlwP/85cD//OXA//zlwP/85cD//OXA//zlwP/85cD//OXA//zlwP/85cD//OXA//zlwP/85cD/+uK+/8yyiv++pHr/vKB4y39/VQYAAAAAAAAAAAAAAAAAAAAAAAAAALKhbh67o3nkvqR6/8yyiv/54Lz//OXA//zlwP/85cD//OXA//zlwP/85cD//OXA//zlwP/85cD//OXA//zlwP/85cD//OXA//zlwP/85cD//OXA//ngvP/Msor/vqR6/7ujeeSyoW4eAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALqbdim7o3nkvqR6/8Wsg//t1a///OXA//zlwP/85cD//OXA//zlwP/85cD//OXA//zlwP/85cD//OXA//zlwP/85cD//OXA//zlwP/t1a//xayD/76kev+7o3nkupt2KQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALKhbh68oHjLvqR6/76kev7Uu5L/8tq1//zlwP/85cD//OXA//zlwP/85cD//OXA//zlwP/85cD//OXA//zlwP/y2rX/1LmS/76kev6+pHr/vKB4y7Khbh4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAH9/VQa6oneCvaN5+L6kev++pHr/y7GJ/9/Fnv/s1K7/9t25//rivv/64r7/9t25/+zUrv/fxZ7/y7GJ/76kev++pHr/vaN5+Lqid4J/f1UGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC3l28gu6F4lryhePO+pHr/vqR6/76kev++pHr/vqR6/76kev++pHr/vqR6/76kev++pHr/vKF487uheJa3l28gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAootzC72feFW9oXiYvKF3yL2jeOq9oXj5vaF4+b2jeOq8oXfIvaF4mL2feFWii3MLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/gB///gAH//gAAf/wAAD/4AAAf8AAAD+AAAAfAAAADwAAAA4AAAAGAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAGAAAABwAAAA8AAAAPgAAAH8AAAD/gAAB/8AAA//gAAf/+AAf//4Af/</pre>
</div>

<div title="BinaryUploadPlugin">
<pre>/***
|''Name''|BinaryUploadPlugin|
|''Version''|0.3.16|
|''Author''|Ben Gillies and Jon Robson|
|''Type''|plugin|
|''Source''|http://github.com/TiddlySpace/tiddlyspace/raw/master/src/plugins/BinaryUploadPlugin.js|
|''Description''|Upload a binary file to TiddlyWeb|
|''CoreVersion''|2.6.1|
|''Requires''|TiddlySpaceConfig TiddlyWebConfig|
!Usage
{{{
&lt;&lt;binaryUpload bag:&lt;name&gt; edit:tags edit:title tags:&lt;default tags&gt; title:&lt;title&gt; &gt;&gt;
}}}
* {{{bag:&lt;name&gt;}}}: optional; if left out, the file will be saved to the current workspace
* {{{edit:tags}}}: specifies that you want to tag the file being uploaded
* {{{edit:title}}}: specifies that you want to set the title to something other than the filename
* {{{tags:&lt;default tags&gt;}}}: specifies a default set of tags to apply to the file (requires {{{edit:tags}}} to be set)
* {{{title:&lt;title&gt;}}}: predefines the title of the binary tiddler
!Requires
TiddlyWeb
tiddlywebplugins.form
!Code
***/
//{{{
(function($) {

var tiddlyspace = config.extensions.tiddlyspace;

var macro = config.macros.binaryUpload = {
    locale: {
        titleDefaultValue: "Please enter a title...",
        tagsDefaultValue: "Please enter some tags...",
        titlePrefix: "title: ",
        tagsPrefix: "tags: ",
        loadSuccess: 'Tiddler %0 successfully uploaded',
        loadError: "An error occurred when uploading the tiddler %0",
        uploadInProgress: "Please wait while the file is uploaded...",
        membersOnly: "Only members can upload."
    },
    renderInputFields: function(container, options) {
        var locale = macro.locale;
        var editableFields = options.edit;
        var includeFields = {
            tags:  editableFields &amp;&amp; editableFields.contains("tags") ? true : false,
            title: editableFields &amp;&amp; editableFields.contains("title") ? true : false
        };
        var fields = ["title", "tags"];
        for(var i = 0; i &lt; fields.length; i++) {
            var fieldName = fields[i];
            var userDefault = options[fieldName];
            var defaultValue = userDefault ? userDefault[0] : false;
            if(includeFields[fieldName] || defaultValue) {
                var localeDefault = locale["%0DefaultValue".format(fieldName)];
                var className = defaultValue ? "userInput" : "userInput notEdited";
                var inputEl;
                var val = defaultValue || localeDefault || "";
                var iContainer = $("&lt;div /&gt;").addClass("binaryUpload%0".format(fieldName)).
                    appendTo(container);
                if(defaultValue &amp;&amp; !includeFields[fieldName]) {
                    var label = locale["%0Prefix".format(fieldName)];
                    $("&lt;span /&gt;").text(label).appendTo(iContainer);
                    $("&lt;span /&gt;").addClass("disabledInput").text(val).appendTo(iContainer);
                    inputEl = $("&lt;input /&gt;").attr("type", "hidden");
                } else {
                    inputEl = $("&lt;input /&gt;").attr("type", "text");
                }
                inputEl.attr("name", fieldName).
                    addClass("%0Edit".format(fieldName)).
                    val(val).addClass(className).appendTo(iContainer);
            }
        }
    },
    getTiddlerName: function(fileName) {
        var fStart = fileName.lastIndexOf("\\");
        var fStart2 = fileName.lastIndexOf("/");
        fStart = fStart &lt; fStart2 ? fStart2 : fStart;
        fileName = fileName.substr(fStart+1);
        return fileName;
    },
    errorHandler: function(fileName) {
        displayMessage("upload of file %0 failed".format(fileName));
    },
    uploadFile: function(place, baseURL, workspace, options) {
        var pleaseWait = $(".uploadProgress", place);
        var iframeName = options.target;
        var form = $("form", place);
        var existingVal = $("input[name=title]", form).val();
        var fileName = existingVal || $('input:file', form).val();
        if(!fileName) {
            return false; // the user hasn't selected a file yet
        }
        fileName = macro.getTiddlerName(fileName);
        $("input[name=title]", place).val(fileName);
        // we need to go somewhere afterwards to ensure the onload event triggers
        var redirectTo = "/%0/tiddlers.txt?select=title:%1".
            format(workspace, fileName);
        var token = tiddlyspace ? tiddlyspace.getCSRFToken() : "";
        var action = "%0?csrf_token=%1&amp;redirect=%2"
            .format(baseURL, token, redirectTo);
        form[0].action = action; // dont use jquery to work with ie
        form[0].target = iframeName;
        // do not refactor following line... won't work in IE6 otherwise
        $(place).append($('&lt;iframe name="' + iframeName + '" id="' + iframeName + '"/&gt;').css('display','none'));
        macro.iFrameLoader(iframeName, function() {
            var content = document.getElementById(iframeName).contentWindow.document.documentElement;
            if($(content).text().indexOf(fileName) &gt; -1) {
                options.callback(place, fileName, workspace, baseURL);
            } else {
                macro.errorHandler(fileName);
            }
            form.show(1000);
            pleaseWait.hide(1000);
        });
        form.hide(1000);
        pleaseWait.show(1000);
        return true;
    },
    createUploadForm: function(place, options) {
        var locale = macro.locale;
        if(readOnly) {
            $('&lt;div class="annotation" /&gt;').text(locale.membersOnly).
                appendTo(place);
            return;
        }
        var bag = options.bag;
        options.callback = options.callback ? options.callback :
            function(place, fileName, workspace, baseurl) {
                macro.displayFile(place, fileName, workspace);
                displayMessage(locale.loadSuccess.format(fileName));
                $("input[type=text]", place).val("");
            };
        var defaults = config.defaultCustomFields;
        place = $("&lt;div /&gt;").addClass("container").appendTo(place)[0];
        var workspace = bag ? "bags/%0".format(bag) : config.defaultCustomFields["server.workspace"];
        var baseURL = defaults["server.host"];
        baseURL += (baseURL[baseURL.length - 1] !== "/") ? "/" : "";
        baseURL = "%0%1/tiddlers".format(baseURL, workspace);
        //create the upload form, complete with invisible iframe
        var iframeName = "binaryUploadiframe%0".format(Math.random());
        // do not refactor following line of code to work in IE6.
        var form = $('&lt;form action="%0" method="POST" enctype="multipart/form-data" /&gt;'.
                    format(baseURL)).addClass("binaryUploadForm").
            appendTo(place)[0];
        macro.renderInputFields(form, options);
        $(form).
            append('&lt;div class="binaryUploadFile"&gt;&lt;input type="file" name="file" /&gt;&lt;/div&gt;').
            append('&lt;div class="binaryUploadSubmit"&gt;&lt;input type="submit" value="Upload" disabled /&gt;&lt;/div&gt;').
            submit(function(ev) {
                this.target = iframeName;
                options.target = iframeName;
                macro.uploadFile(place, baseURL, workspace, options);
            })
            .find('[type="file"]').bind('change', function() {
                $(form).find('[type="submit"]').prop('disabled', false);
            }).end();
        $('&lt;div /&gt;').addClass("uploadProgress").text(locale.uploadInProgress).hide().appendTo(place);
        $("input[name=file]", place).change(function(ev) {
            var target = $(ev.target);
            var fileName = target.val();
            var title = $("input[type=text][name=title]", place);
            if(!title.val()) {
                title.val(fileName);
            }
        });
    },
    handler: function(place, macroName, params, wikifier, paramString, tiddler) {
        params = paramString.parseParams(null, null, true);
        macro.createUploadForm(place, params[0]);
    },
    iFrameLoader: function(iframeName, callback) {
        var iframe = document.getElementById(iframeName); //jQuery doesn't seem to want to do this!?
        var locale = macro.locale;
        $(".userInput").addClass("notEdited"); // reset editing
        var finishedLoading = function() {
            callback();
        };
        var iFrameLoadHandler = function() {
            finishedLoading.apply();
            return;
        };

        iframe.onload = iFrameLoadHandler;
        //IE
        completeReadyStateChanges = 0;
        iframe.onreadystatechange = function() {
            if (++(completeReadyStateChanges) == 3) {
                iFrameLoadHandler();
            }
        };
    },
    displayFile: function(place, title, workspace) {
        var adaptor = store.getTiddlers()[0].getAdaptor();
        var context = {
            workspace: workspace,
            host: config.defaultCustomFields['server.host']
        };
        adaptor.getTiddler(title, context, null, function(context) {
            if(context.status) {
                store.addTiddler(context.tiddler);
                story.displayTiddler(place, title);
                var image = config.macros.image;
                if(image &amp;&amp; image.refreshImage) {
                    image.refreshImage("/%0/tiddlers/%1".format(workspace, title));
                    image.refreshImage(title);
                    image.refreshImage("/%0".format(title));
                    image.refreshImage("%0/%1/tiddlers/%2".format(config.extensions.tiddlyweb.host, workspace, title));
                }
            } else {
                displayMessage(macro.locale.loadError.format(title));
            }
        });
    }
};

if(tiddlyspace) {
    config.macros.binaryUploadPublic = {
        handler: function(place, macroName, params, wikifier, paramString, tiddler) {
            var options = paramString.parseParams(null, null, true)[0];
            var bag = tiddlyspace.getCurrentBag("public");
            options.bag = bag;
            macro.createUploadForm(place, options);
        }
    };
    config.messages.privacySetting = config.options.chkPrivateMode ?
        "private" : "public";
    config.macros.binaryUpload.defaultWorkspace = tiddlyspace.
        getCurrentWorkspace(config.messages.privacySetting);
}

})(jQuery);
//}}}</pre>
</div>

<div title="apps">
<pre>&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="utf-8"/&gt;
    &lt;title&gt;TiddlySpace Apps&lt;/title&gt;
    &lt;link rel="stylesheet" href="/bags/common/tiddlers/reset.css" /&gt;
    &lt;link rel="stylesheet" href="/bags/common/tiddlers/appspage.css" /&gt;
    &lt;!--[if lt IE 7 ]&gt;
    &lt;link rel="stylesheet" href="/bags/common/tiddlers/appspageie6.css" /&gt;
    &lt;![endif]--&gt;
&lt;/head&gt;
&lt;body&gt;
    
    &lt;div id="wrapper"&gt;
        &lt;div id="TSbar"&gt;&lt;/div&gt;
        &lt;div id="main-content"&gt;
            &lt;div id="space-details"&gt;
                &lt;a href="/_space"&gt;&lt;img class="siteicon"&gt;&lt;/a&gt;
                &lt;div id="title-subtitle"&gt;
                    &lt;h1 class="spaceaddress"&gt;
                        &lt;span class="spaceName"&gt;&lt;/span&gt;&lt;span class="hostName"&gt;&lt;/span&gt;
                    &lt;/h1&gt;
                    &lt;p class="tagline"&gt;&lt;span class="subTitle"&gt;&lt;/span&gt;&lt;a class="managespaces" href="/_space"&gt;manage space&lt;/a&gt;&lt;/p&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            &lt;div id="holder"&gt;
                &lt;div id="appswitcher-wrapper"&gt;
                    &lt;div id="appswitcher"&gt;
                        &lt;h2&gt;Your Apps&lt;/h2&gt;
                        &lt;ul id="app-list"&gt;
                            &lt;li class="htmlserialisation"&gt;
                                &lt;a href="/tiddlers.html?select=tag:!excludeLists;sort=-modified"&gt;
                                    &lt;img src="/bags/common/tiddlers/browse_read_blue.png" alt="Icon for the HTML Serialisation" class="app-img" /&gt;
                                    BROWSE
                                &lt;/a&gt;
                            &lt;/li&gt;
                            &lt;li class="tiddlywiki"&gt;
                                &lt;a href="/tiddlers.wiki"&gt;
                                    &lt;img src="/bags/common/tiddlers/tiddlywiki2_blue.png" alt="Icon for TiddlyWiki" class="app-img" /&gt;
                                    TIDDLYWIKI
                                &lt;/a&gt;
                            &lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;div id="addapp"&gt;
                            &lt;button class="inactive"&gt;Add More!&lt;/button&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                    &lt;div id="app-desc"&gt;
                        &lt;ul&gt;
                            &lt;li class="htmlserialisationdesc"&gt;&lt;p&gt;an easy to understand HTML representation of your content.&lt;/p&gt;&lt;/li&gt;
                            &lt;li class="tiddlywikidesc"&gt;&lt;p&gt;use TiddlyWiki to create, edit and organise your content.&lt;/p&gt;&lt;/li&gt;
                        &lt;/ul&gt;
                    &lt;/div&gt;
                    &lt;div style="clear: both;"&gt;&lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
        &lt;div id="footer"&gt;&lt;!-- ie doesn't support footer tag --&gt;
            &lt;div id="footer-content"&gt;
                &lt;div class="links"&gt;
                    &lt;a href="http://blog.tiddlyspace.com"&gt;blog&lt;/a&gt;
                    &lt;a href="http://featured.tiddlyspace.com"&gt;featured&lt;/a&gt;
                    &lt;a href="http://docs.tiddlyspace.com"&gt;documentation&lt;/a&gt;
                    &lt;a href="https://github.com/TiddlySpace/tiddlyspace"&gt;source&lt;/a&gt;
                &lt;/div&gt;
                &lt;p&gt;TiddlySpace 2011, created by &lt;a href="http://osmosoft.com"&gt;Osmosoft&lt;/a&gt;&lt;/p&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    
    &lt;script type="text/javascript" src="/bags/common/tiddlers/backstage.js"&gt;&lt;/script&gt;
    &lt;script type="text/javascript" src="/bags/common/tiddlers/jquery.js"&gt;&lt;/script&gt;
    &lt;script type="text/javascript" src="/bags/tiddlyspace/tiddlers/chrjs"&gt;&lt;/script&gt;
    &lt;script type="text/javascript" src="/bags/common/tiddlers/chrjs-store.js"&gt;&lt;/script&gt;
    &lt;script type="text/javascript" src="/bags/common/tiddlers/jquery-json.js"&gt;&lt;/script&gt;
    &lt;script type="text/javascript" src="/bags/common/tiddlers/appspage.js"&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
</div>

<div title="PageTemplate">
<pre>&lt;!--{{{--&gt;
&lt;div class='header'&gt;
    &lt;div id='sidebarSearch'&gt;
        &lt;span macro='search'&gt;&lt;/span&gt;
    &lt;/div&gt;
    &lt;div class='headerForeground'&gt;
        &lt;span class='siteTitle' refresh='content' tiddler='SiteTitle'&gt;&lt;/span&gt;
        &lt;span class='siteSubtitle' refresh='content' tiddler='SiteSubtitle'&gt;&lt;/span&gt;
    &lt;/div&gt;
    &lt;div class='clearFloat'&gt;&lt;/div&gt;
&lt;/div&gt;

&lt;div id='menuBar'&gt;
    &lt;div id='mainMenu' refresh='content' tiddler='MainMenu'&gt;&lt;/div&gt;
    &lt;div id='sidebarOptions' refresh='content' tiddler='SideBarOptions'&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div id='displayArea'&gt;
    &lt;div id='messageArea'&gt;&lt;/div&gt;
    &lt;div id='tiddlerDisplay'&gt;&lt;/div&gt;
    &lt;div id='sidebarTabs' refresh='content' force='true' tiddler='SideBarTabs'&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!--}}}--&gt;</pre>
</div>

<div title="pearl">
<pre>[[pearl prince]]</pre>
</div>

<div title="首页">
<pre>&lt;html&gt;
&lt;head&gt;
      &lt;title&gt;第一个HTML代码&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div align="center"&gt;
&lt;img src="http://zw.shangxueba.com/uploadfile/20150901/201509011346492814.jpg" hight="500" width="500" &gt;&lt;br/&gt;

&lt;/div&gt;

&lt;/body&gt;
&lt;/html&gt;
</pre>
</div>

<div title="TiddlySpaceInit">
<pre>/***
|''Name''|TiddlySpaceInitialization|
|''Version''|0.7.3|
|''Description''|Initializes new TiddlySpaces the first time they are created|
|''Status''|@@beta@@|
|''Source''|http://github.com/TiddlySpace/tiddlyspace/blob/master/src/plugins/TiddlySpaceInit.js|
|''CoreVersion''|2.6.1|
|''Requires''|TiddlySpaceConfig RandomColorPalettePlugin chrjs ImageMacroPlugin|
!TODO
* robust error notification and recovery
!MarkupPreHead
&lt;!--{{{--&gt;
&lt;link href="/bags/%0_public/tiddlers.atom" rel="alternate"
    type="application/atom+xml" title="%0's public feed" /&gt;
&lt;link rel="canonical" href="%1/" /&gt;
&lt;!--}}}--&gt;
!Code
***/
//{{{
(function($) {

var versionField = "tiddlyspaceinit_version";
var markupPreHead = store.getTiddlerText(tiddler.title + "##MarkupPreHead", "");
var tiddlyspace = config.extensions.tiddlyspace;
var currentSpace = tiddlyspace.currentSpace;
var tweb = config.extensions.tiddlyweb;

var plugin = config.extensions.TiddlySpaceInit = {
    version: "0.6",
    SiteTitle: "%0",
    SiteSubtitle: "a TiddlySpace",
    flagTitle: "%0SetupFlag",
    flagWarning: "Please do not modify this tiddler; it was created " +
        "automatically upon space creation.",

    dispatch: function(ev) {
        var title = plugin.flagTitle.format([currentSpace.name]);
        config.annotations[title] = plugin.flagWarning;
        if(currentSpace.type != "private") {
            return;
        }
        var tiddlers = [];
        var tid = store.getTiddler(title);
        if(tid) {
            curVersion = parseFloat(tid.fields[versionField]);
            reqVersion = parseFloat(plugin.version);
            if(curVersion &lt; reqVersion) {
                plugin.update(curVersion, tid);
                tid.fields[versionField] = plugin.version;
                tid.incChangeCount();
                tid = store.saveTiddler(tid);
                tiddlers.push(tid);
            }
        } else { // first run
            tid = new Tiddler(title);
            tid.tags = ["excludeLists", "excludeSearch", "excludePublisher"];
            tid.fields = $.extend({}, config.defaultCustomFields);
            tid.fields[versionField] = plugin.version;
            tid.text = "@@%0@@".format([plugin.flagWarning]);
            tid = store.saveTiddler(tid);
            tiddlers = tiddlers.concat(plugin.firstRun(), tid);
        }
        autoSaveChanges(null, tiddlers);
    },
    update: function(curVersion, flagTiddler) {
        if(curVersion &lt; 0.2) {
            this.createAvatar();
        }
        if(curVersion &lt; 0.3) {
            flagTiddler.tags.pushUnique("excludePublisher"); // XXX: never persisted
        }
        if(curVersion &lt; 0.5) { // v0.4 was faulty
            this.setupMarkupPreHead();
        }
        if(curVersion &lt; 0.6) {
            this.purgeSystemSettings();
        }
    },
    pubTid: {
        tags: ["excludeLists", "excludeSearch"],
        fields: $.extend({}, config.defaultCustomFields, {
            "server.workspace": tiddlyspace.getCurrentWorkspace("public")
        })
    },
    makeTiddlerIfNot: function(tiddler) {
        if (!store.tiddlerExists(tiddler.title)) {
            $.extend(true, tiddler, plugin.pubTid);
            return [store.saveTiddler(tiddler)];
        } else {
            return [];
        }
    },
    firstRun: function() {
        var tiddlers = [];
        // generate Site*itle
        $.each(["SiteTitle", "SiteSubtitle"], function(i, item) {
            var tid = new Tiddler(item);
            tid.text = plugin[item].format([currentSpace.name]);
            tiddlers.push.apply(tiddlers,
                plugin.makeTiddlerIfNot(tid));
        });
        // generate public ColorPalette
        var tid = new Tiddler("ColorPalette");
        tid.text = config.macros.RandomColorPalette.generatePalette({
            saturation_pale: 0.67, saturation_light: 0.53,
            saturation_mid: 0.43, saturation_dark: 0.06,
            pale: 0.99, light: 0.85, mid: 0.5, dark: 0.31
        },
            false);
        tiddlers.push.apply(tiddlers, plugin.makeTiddlerIfNot(tid));
        this.createAvatar();
        this.setupMarkupPreHead();
        return tiddlers;
    },
    // remove _cookie slices (TiddlyWiki 2.6.2 beta 6 remnants)
    purgeSystemSettings: function() {
        var ss = store.getTiddler("SystemSettings");
        if(ss) {
            var lines = ss.text.split("\n");
            var persistentOptions = $.grep(lines, function(line, i) {
                return line.indexOf("_cookie:") == -1;
            });
            ss.text = persistentOptions.join("\n");
            ss = store.saveTiddler(ss);
            autoSaveChanges(null, [ss]);
        }
    },
    createAvatar: function() {
        var avatar = "SiteIcon";
        var host = tweb.host;
        var notify = function(xhr, error, exc) {
            displayMessage("ERROR: could not create avatar - " + // TODO: i18n
                "%0: %1".format([xhr.statusText, xhr.responseText]));
            // TODO: resolve!?
        };

        var pubBag = tiddlyspace.getCurrentBag("public");
        var tid = new tiddlyweb.Tiddler(avatar);
        tid.bag = new tiddlyweb.Bag(pubBag, host);

        var callback = function(data, status, xhr) {}; // avatar already exists; do nothing
        var errback = function(xhr, error, exc) {
            if(xhr.status != 404) {
                return;
            }
            // copy default avatar
            var _notify = function(tid, status, xhr) {
                displayMessage("created avatar"); // TODO: i18n
                var image = config.macros.image;
                if(image &amp;&amp; image.refreshImage) {
                    var uri = "/%0/tiddlers/SiteIcon".
                        format(tiddlyspace.getCurrentWorkspace("public"));
                    image.refreshImage(uri);
                    image.refreshImage("SiteIcon");
                }
            };
            var _callback = function(tid, status, xhr) {
                tid.title = avatar;
                tid.bag.name = pubBag;
                delete tid.etag;
                tid.put(_notify, notify); // TODO: add to current session document (via adaptor?)
            };
            tweb.getUserInfo(function(user) {
                var avatarTitle = currentSpace.name == user.name ?
                    "defaultUserIcon" : "defaultSiteIcon";
                var tid = new tiddlyweb.Tiddler(avatarTitle);
                tid.bag = new tiddlyweb.Bag("common", host);
                tid.get(_callback, notify);
            });
        };
        tid.get(callback, errback);
    },
    savePublicTiddlerText: function(title, text, pubWorkspace) {
        var tid = new Tiddler(title);
        tid.text = text;
        tid.tags = ["excludeLists"];
        tid.fields = $.extend({}, config.defaultCustomFields);
        tid.fields["server.workspace"] = pubWorkspace;
        tid.fields["server.page.revision"] = "false";
        tid = store.saveTiddler(tid);
        autoSaveChanges(null, [tid]);
    },
    setupMarkupPreHead: function() {
        var pubWorkspace = tiddlyspace.getCurrentWorkspace("public");
        var existing = store.getTiddler("MarkupPreHead");
        if(!existing || existing.fields["server.workspace"] != pubWorkspace) {
            var context = this;
            tweb.getStatus(function(status) {
                var text = markupPreHead.format(currentSpace.name,
                    tiddlyspace.getHost(status.server_host, currentSpace.name));
                context.savePublicTiddlerText("MarkupPreHead", text,
                    pubWorkspace);
            });
        }
        // also set up DefaultTiddlers
        var title = "DefaultTiddlers";
        existing = store.getTiddler(title) || new Tiddler(title);
        if(existing.fields["server.workspace"] != pubWorkspace) {
            var text = existing.text || store.getShadowTiddlerText(title);
            this.savePublicTiddlerText(title, text, pubWorkspace);
        }
    }
};

$(document).bind("startup", plugin.dispatch);

})(jQuery);
//}}}</pre>
</div>

<div title="privateNotPublicIcon">
<pre>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</pre>
</div>

<div title="图片">
<pre> '图片'
&lt;html&gt;
&lt;head&gt;
      &lt;title&gt;第一个HTML代码&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div align="center"&gt;
&lt;img src="http://dl.bizhi.sogou.com/images/1600x900/2014/04/30/596243.jpg" hight="500" width="500" &gt;&lt;br/&gt;
&lt;/div&gt;
&lt;hr width="800" color="pink" size"10"/&gt;

&lt;/body&gt;
&lt;/html&gt;</pre>
</div>

<div title="ImportTiddlers">
<pre>&lt;&lt;importTiddlers&gt;&gt;
</pre>
</div>

<div title="TiddlySpaceLinkPlugin">
<pre>/***
|''Name:''|TiddlySpaceLinkPlugin|
|''Description:''|Formatter to reference other spaces from wikitext |
|''Author:''|PaulDowney (psd (at) osmosoft (dot) com) |
|''Source:''|http://github.com/TiddlySpace/tiddlyspace/raw/master/src/plugins/TiddlySpaceLinkPlugin.js|
|''Version:''|1.4.2|
|''License:''|[[BSD License|http://www.opensource.org/licenses/bsd-license.php]] |
|''Comments:''|Please make comments at http://groups.google.co.uk/group/TiddlyWikiDev |
|''~CoreVersion:''|2.4|
!!Documentation
This plugin provides wikitext formatters for referencing another [[space|Space]] on the same TiddlySpace server, as in the following examples:
&lt;&lt;&lt;
  {{{@space}}} -- @space 
  {{{~@space}}} -- ~@space 
  {{{Tiddler@space}}} -- Tiddler@space
  {{{[[Tiddler Title]]@space}}} -- [[Tiddler Title]]@space 
  {{{[[Link text|Tiddler Title]]@space}}} -- [[Link text|Tiddler Title]]@space
&lt;&lt;&lt;
Links to tiddlers with a title begining with an "@" remain as tiddlyLinks:
&lt;&lt;&lt;
  {{{[[@tiddler]]}}} -- [[@tiddler]]
&lt;&lt;&lt;
and these may be changed into a space link using {{{@@}}}:
&lt;&lt;&lt;
  {{{[[@@space]]}}} -- [[@@space]]
  {{{[[Link to an another space|@@space]]}}} -- [[Link to another space|@@space]]
  {{{[[@space|@@space]]}}} -- [[@space|@@space]]
&lt;&lt;&lt;
TiddlySpace includes the [[TiddlySpaceLinkPlugin]] which provides WikiText markup for linking to other spaces on the same server. For example @glossary is a link to the {{{glossary}}} space and [[Small Trusted Group]]@glossary a link to an individual tiddler in the @glossary space. Prefixing the link with a tilde escapes the link, for example {{{~@space}}}.
Email addresses, for example joe.bloggs@example.com and mary@had.a.little.lamb.org should be unaffected.
!!Features
The plugin provides external links decorated so that other plugins may be included to add features such as the ability to dynamically pull externally linked tiddlers into the current TiddlyWiki.
Wikitext linking to a space on another server, for example from a tiddler in a space on tiddlyspace.com to a tiddler or a space on example.com, isn't currently supported. 
!!Code
***/
//{{{
/*jslint onevar: false nomen: false plusplus: false */
/*global jQuery config createTiddlyText createExternalLink createTiddlyLink */

function createSpaceLink(place, spaceName, title, alt, isBag) {
    var link, a, currentSpaceName, label;
    try {
        if (spaceName === config.extensions.tiddlyspace.currentSpace.name) {
            title = title || spaceName;
            a = createTiddlyLink(place, title, false);
            jQuery(a).text(alt || title);
            return a;
        }
    } catch (ex1) {
        currentSpaceName = false;
    }

    a = jQuery("&lt;a /&gt;").addClass('tiddlySpaceLink externalLink').appendTo(place)[0];
    if(title) {
        jQuery(a).attr('tiddler', title);
    }
    if(isBag) {
        jQuery(a).attr('bag', spaceName);
    } else {
        jQuery(a).attr('tiddlyspace', spaceName);
    }

    config.extensions.tiddlyweb.getStatus(function(status) {
        link = status.server_host.url;
        if (title) {
            label = alt || title;
            link = link + "/" + encodeURIComponent(title);
        } else {
            label = alt || spaceName;
        }
        // assumes a http URI without user:pass@ prefix
        if(!isBag) {
            link = link.replace("http://", "http://" + spaceName.toLowerCase() + ".");
        } else {
            link += "/bags/" + spaceName + "/tiddlers.wiki";
        }
        jQuery(a).attr("href", link).text(label);
    });
    return a;
}

(function ($) {

    config.textPrimitives.spaceName = "[a-zA-Z][a-zA-Z0-9-]*[a-zA-Z0-9]";
    config.textPrimitives.spaceNameStrict = "[a-z][a-z0-9-]*";
    config.textPrimitives.bareTiddlerLetter = config.textPrimitives.anyLetterStrict;

    config.formatters.splice(0, 0, {
        name: "spacenameLink",
        match: config.textPrimitives.unWikiLink + "?" + config.textPrimitives.bareTiddlerLetter + "*@" + config.textPrimitives.spaceName + "\\.?.?",
        lookaheadRegExp: new RegExp(config.textPrimitives.unWikiLink + "?(" + config.textPrimitives.bareTiddlerLetter + "*)@(" + config.textPrimitives.spaceName + ")", "mg"),
        handler: function (w) {
            if (w.matchText.substr(w.matchText.length - 2, 1) === '.' &amp;&amp; w.matchText.substr(w.matchText.length - 1, 1).match(/[a-zA-Z]/)) {
                w.outputText(w.output, w.matchStart, w.nextMatch);
                return;
            }
            if (w.matchText.substr(0, 1) === config.textPrimitives.unWikiLink) {
                w.outputText(w.output, w.matchStart + 1, w.nextMatch);
                return;
            }
            this.lookaheadRegExp.lastIndex = w.matchStart;
            var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
            if (lookaheadMatch &amp;&amp; lookaheadMatch.index === w.matchStart) {
                createSpaceLink(w.output, lookaheadMatch[2], lookaheadMatch[1]);
                w.nextMatch = this.lookaheadRegExp.lastIndex;
            }
        }
    },
    {
        name: "tiddlySpaceLink",
        match: "\\[\\[[^\\|\\]]*\\|*@@" + config.textPrimitives.spaceName + "\\]",
        lookaheadRegExp: new RegExp("\\[\\[(.*?)(?:\\|@@(.*?))?\\]\\]", "mg"),
        handler: function (w) {
            this.lookaheadRegExp.lastIndex = w.matchStart;
            var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
            if (lookaheadMatch &amp;&amp; lookaheadMatch.index === w.matchStart) {
                var alt = lookaheadMatch[2] ? lookaheadMatch[1] : lookaheadMatch[1].replace(/^@@/, "");
                var space = lookaheadMatch[2] || alt;
                createSpaceLink(w.output, space, "", alt);
                w.nextMatch = this.lookaheadRegExp.lastIndex;
            }
        }
    },
    {
        name: "tiddlyLinkSpacenameLink",
        match: "\\[\\[[^\\[]*\\]\\]@",
        lookaheadRegExp: new RegExp("\\[\\[(.*?)(?:\\|(.*?))?\\]\\]@(" + config.textPrimitives.spaceName + ")", "mg"),
        handler: function (w) {
            this.lookaheadRegExp.lastIndex = w.matchStart;
            var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
            if (lookaheadMatch &amp;&amp; lookaheadMatch.index === w.matchStart) {
                var title = lookaheadMatch[2] || lookaheadMatch[1];
                var alt = lookaheadMatch[1] || lookaheadMatch[2];
                createSpaceLink(w.output, lookaheadMatch[3], title, alt);
                w.nextMatch = this.lookaheadRegExp.lastIndex;
            }
        }
    });

    // ensure space links don't appear as missing links
    config.textPrimitives.brackettedLink = "\\[\\[([^\\]][^@\\]][^\\]]*)\\]\\](?=[^@])";
    config.textPrimitives.titledBrackettedLink = "\\[\\[([^\\[\\]\\|]+)\\|([^\\[\\]\\|]+)\\]\\](?=[^@])";

    // reevaluate derrived expressions ..
    config.textPrimitives.tiddlerForcedLinkRegExp = new RegExp("(?:" + config.textPrimitives.titledBrackettedLink + ")|(?:" +
        config.textPrimitives.brackettedLink + ")|(?:" +
        config.textPrimitives.urlPattern + ")","mg");
    config.textPrimitives.tiddlerAnyLinkRegExp = new RegExp("("+ config.textPrimitives.wikiLink + ")|(?:" +
        config.textPrimitives.titledBrackettedLink + ")|(?:" +
        config.textPrimitives.brackettedLink + ")|(?:" +
        config.textPrimitives.urlPattern + ")","mg");

    // treat space links in titledBracketedLink as external links
    var missingTiddlySpaceLink = new RegExp("^@@" + config.textPrimitives.spaceName + "$", "");
    var isExternalLink = config.formatterHelpers.isExternalLink;
    config.formatterHelpers.isExternalLink = function(link) {
        return missingTiddlySpaceLink.test(link) || isExternalLink(link);
    };

}(jQuery));
//}}}</pre>
</div>

<div title="ToolbarCommands">
<pre>|~ViewToolbar|+editTiddler +cloneTiddler &gt; fields refreshTiddler changeToPublic changeToPrivate revisions syncing permalink references jump closeOthers &lt; closeTiddler|
|~EditToolbar|+saveTiddler saveDraft -cancelTiddler deleteTiddler|
|~RevisionToolbar|&gt; fields revert|</pre>
</div>

<div title="unsyncedIcon">
<pre>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</pre>
</div>

<div title="课文翻译（修改版）">
<pre>方法和目的：
     这本书的目的是为了给大家提供一个关于信息管理更全面的认知，依据我们对于David kolb论述的充分理解，知识可以划分为两个基本的维度：（抽象对具体，思索对实验），并且研究是一个在这些维度之间渐进循环的过程。
     1.抽象的认知：这就意味着一些基本的术语是能够被解释的，在每一个章节中，他们通过对信息和情报的见解的不同看法进行解释，为了一种信息管理的方法进行一次关于它的主要的哲学思想和含义的讨论。
    2.实验：我们向读者发起挑战，通过提供给他们信息管理的方法和技术与描述，去应用信息管理的概念。
    3.具体的经验：我们通过抽象的哲学观点和有关信息管理的方法和技术去解决日常问题来论证它的实用性。在这本书通过读者提供自己需要去使用工具去分析具体问题的一些实际的例子与任务进行学习。
    4.反思：我们向读者发起挑战，用一种批判性的方法思考他们在任务中读到和审判了什么，我们邀请他们去发现他们未来的学习生涯中的挑战，一个好的方法是通过团队的影响，当然一个适当的方法是建立一个提供情报的平台去讨论他们所读和所做的事情，这个很容易去做，第一步是学习理解提供情报的挑战，也就是避免错误的和无意义的情报，而是通过电子技术的方法来获得实际的知识。谷歌就提供了一些好的机会（看这章的末尾）。

读完这本书，读者将会：
    1.理解和分辨对信息管理的不同方法，它们的优势和劣势，并且提供独特的方法。
    2.学习构建简单的经验和管理之间的关系的模型，说明信息需要经营管理和公共政策的共同执行。
    3.理解一个主要的问题，就是转变抽象的信息需要具体的信息收集、处理和规程表示法。
    4.理解一些在组织上复杂的信息管理，和在组织上用信息系统的挑战，可能是全部中最重要的。
    5.形成思考和分析的能力去论证信息、情报、信息管理和信息技术的用法。这个能力会对你的整个职业生涯有帮助，并且使你能够精密的去判断和获得未来的新信息的机会。比如说我的目标在于讨论信息管理像是与生俱来的人类本能，而不是靠技术的支持。

这些课程、洞察力和技巧是经营管理、公共管理、社会科学和经济学的大学生的基本能力，但是这本书同样也适合于每个对信息和情报的基本原来感兴趣的人。
</pre>
</div>

<div title="SiteSubtitle">
<pre>如果命运是条孤独的河流，谁会是你灵魂的摆渡者</pre>
</div>

<div title="TiddlySpaceRevisionView">
<pre>/***
|''Name''|TiddlySpaceRevisionView|
|''Description''|Show tiddler revisions in a stack of cards view|
|''Author''|BenGillies|
|''Version''|0.2.0|
|''Status''|beta|
|''Source''|http://github.com/TiddlySpace/tiddlyspace|
|''CodeRepository''|http://github.com/TiddlySpace/tiddlyspace|
|''License''|[[BSD|http://www.opensource.org/licenses/bsd-license.php]]|
|''CoreVersion''|2.6.0|
|''Requires''|TiddlyWebAdaptor|
!Usage
The viewRevisions macro can be attached to any element, which should be passed
in as a parameter.

For example:

&amp;lt;&amp;lt;viewRevisions page:10 link:"&lt;&lt;view modified date&gt;&gt;"&amp;gt;&amp;gt;

would show the revisions "stack of cards" view, 10 at a time, when the modified
date is clicked.
!Code
***/
//{{{
(function($) {

var me = config.macros.viewRevisions = {
    revisionTemplate: "RevisionTemplate",
    revSuffix: " [rev. #%0]", // text to append to each tiddler title
    defaultPageSize: 5, // default number of revisions to show
    defaultLinkText: "View Revisions", // when there's nothing else to use
    offsetTop: 30, // in px
    offsetLeft: 10, // in px
    shiftDownDelay: 50, // in ms
    visibleSlideAmount: 20, // amount of revisions to show on left hand edge after sliding
    zIndex: 100, // default z-index
    handler: function(place, macroName, params, wikifier, paramString, tiddler) {
        params = paramString.parseParams(null, null, true)[0];
        var tiddlerElem = story.findContainingTiddler(place);

        var revButton;
        var pageSize = parseInt(params.page[0], 10) || me.defaultPageSize;
        var linkObj = params.link ? params.link[0] || me.defaultLinkText : false;
        if(linkObj) {
            revButton = $('&lt;span class="button openRevisions" /&gt;')
                .appendTo(place);
            wikify(linkObj, revButton[0], null, tiddler);
        } else {
            revButton = place;
        }

        $(revButton).click(function() {
            if (!$(tiddlerElem).hasClass("revisions")) {
                me.showRevisions(tiddlerElem, tiddler, pageSize);
            } else {
                me.closeRevisions(tiddlerElem);
            }
        });
    },

    // initialisation for revision view
    showRevisions: function(tiddlerElem, tiddler, pageSize) {
        var context = {
            host: tiddler.fields["server.host"],
            workspace: tiddler.fields["server.workspace"]
        };
        $(tiddlerElem).addClass("revisions").attr("revName", tiddler.title);
        // ensure toolbar commands deactivate RevisionsView
        $("a", ".toolbar", tiddlerElem).each(function(index, btn) {
            var _onclick = btn.onclick;
            btn.onclick = function(e) {
                me.closeRevisions(tiddlerElem);
                _onclick.apply(this, arguments);
            };
        });
        // ensure default action deactivates RevisionsView
        var _ondblclick = tiddlerElem.ondblclick;
        tiddlerElem.ondblclick = function(e) {
            me.closeRevisions(tiddlerElem);
            _ondblclick.apply(this, arguments);
        };
        var type = tiddler.fields["server.type"];
        var adaptor = new config.adaptors[type]();
        var userParams = {
            tiddlerElem: tiddlerElem,
            pageSize: pageSize,
            title: tiddler.title
        };
        me.createCloak(tiddlerElem);
        adaptor.getTiddlerRevisionList(tiddler.title, null, context, userParams,
                function(context, userParams) {
                    // strip the current revision
                    context.revisions.shift();
                    me.expandStack(context, userParams);
                });
    },

    // fetch the actual revision and put it in the tiddler div
    showRevision: function(place, revision, callback) {
        var context = {
            host: revision.fields["server.host"],
            workspace: revision.fields["server.workspace"]
        };
        var userParams = {
            revElem: place
        };
        var type = revision.fields["server.type"];
        var adaptor = new config.adaptors[type]();
        var revNo = revision.fields["server.page.revision"];
        adaptor.getTiddlerRevision(revision.title, revNo, context, userParams,
            function(context, userParams) {
                var tiddler = context.tiddler;
                tiddler.title += me.revSuffix
                    .format([$(place).attr("revision")]);
                tiddler.fields.doNotSave = true;
                if (store.getTiddler(tiddler.title)) {
                    store.deleteTiddler(tiddler.title);
                }
                store.addTiddler(tiddler);

                //now, populate the existing div
                var revElem = userParams.revElem;
                $(revElem).attr("id", story.tiddlerId(tiddler.title));
                $(revElem).attr("refresh", "tiddler");
                var getTemplate = function() {
                    var themeName = config.options.txtTheme;
                    if (themeName) {
                        return store.getTiddlerSlice(themeName,
                            me.revisionTemplate) || me.revisionTemplate ||
                            "ViewTemplate";
                    } else {
                        return (store.getTiddler(me.revisionTemplate)) ?
                            me.revisionTemplate : "ViewTemplate";
                    }
                };
                var template = getTemplate();
                story.refreshTiddler(tiddler.title, template, true);
                callback(tiddler);
            });
    },

    createCloak: function(promoteElem) {
        var el = $(promoteElem);
        // cache styles for resetting later
        el.data({
            top: el.css("top"),
            left: el.css("left"),
            zIndex: el.css("z-index")
        });

        $('&lt;div class="revisionCloak" /&gt;').css("z-index", me.zIndex)
            .click(function() {
                me.closeRevisions(promoteElem);
            })
            .appendTo(document.body);

        el.css("z-index", me.zIndex + 1);
    },

    // clean up, removing all evidence of revision view
    closeRevisions: function(promoteElem) {
        var el = $(promoteElem);
        // revert the original tiddler back to its previous state
        el.removeAttr("revName").removeClass("revisions").css({
            top: el.data("top"),
            left: el.data("left"),
            zIndex: el.data("zIndex")
        });

        // remove any revisions still in the store
        var revisions = $(".revisions");
        revisions.each(function(index, revision) {
            var revAttributes = revision.attributes;
            if ((revAttributes.revname) &amp;&amp;
                    (revAttributes.revision)) {
                var revName = revAttributes.revname.value;
                var revNo = revAttributes.revision.value;
                var title = revName + me.revSuffix.format([revNo]);

                if (store.getTiddler(title)) {
                    store.deleteTiddler(title);
                }
            }
        });

        // delete the previous revisions
        revisions.remove();

        // remove the cloak
        $(".revisionCloak").remove();
    },

    // calback from getting list of revisions
    expandStack: function(context, userParams) {
        var pageSize = userParams.pageSize;

        var from = userParams.from || 0;
        var tiddlerElem = userParams.tiddlerElem;

        userParams.defaultHeight = $(tiddlerElem).height();
        userParams.defaultWidth = $(tiddlerElem).width();
        if (from &lt; context.revisions.length) {
            me.displayNextRevision(tiddlerElem, userParams, context, from,
                from + pageSize - 1);
        }
    },

    // place the next div above and behind the previous one
    displayNextRevision: function(tiddlerElem, userParams, context, from, to) {
        var revision = context.revisions[from];
        var callback = function() {
            var revText = revBtn.getRevisionText(tiddlerElem, revision);
            tiddlerElem = me.createRevisionObject(tiddlerElem, context,
                userParams, revText);
            $(tiddlerElem)
                .attr("revision", (context.revisions.length - from));
            if ((from &lt; to) &amp;&amp; ((from + 1) &lt; context.revisions.length)){
                me.displayNextRevision(tiddlerElem, userParams, context,
                    from + 1, to);
            } else if ((context.revisions.length - 1) &gt; to) {
                me.showMoreButton(tiddlerElem, context, userParams, to + 1);
            }
        };
        me.shiftVisibleDown(userParams.title, callback);
    },

    createRevisionObject: function(tiddlerElem, context, userParams, text) {
        var newPosition = me.calculatePosition(tiddlerElem, context);
        return $('&lt;div class="revisions tiddler" /&gt;')
            .css({
                position: "absolute",
                top: newPosition.top,
                left: newPosition.left,
                "z-index": me.zIndex + 1,
                height: userParams.defaultHeight,
                width: userParams.defaultWidth
            })
            .attr("revName", userParams.title)
            .append(text)
            .insertBefore(tiddlerElem);
    },

    // move the already present revisions down by 1 to fit the next one in
    shiftVisibleDown: function(title, callback) {
        var revisions = $("[revName='%0'].revisions".format([title]));
        var revisionCount = revisions.length;

        $(revisions).animate({top: "+=" + me.offsetTop},
                me.shiftDownDelay, function() {
                    revisionCount -= 1;
                    if ((callback) &amp;&amp; (!revisionCount)) {
                        callback();
                    }
                });
    },

    // where we put the new revision
    calculatePosition: function(elem, context) {
        var offset = $(elem).offset();
        var currentPosition = $(elem).position();
        var newPosition = {
            top: currentPosition.top - me.offsetTop
        };
        if ((context.restrictLeft) ||
                ((offset.left - me.offsetLeft) &lt;
                $("#contentWrapper").offset().left)) {
            newPosition.left = $(elem).position().left;
            context.restrictLeft = true;
        } else {
            newPosition.left = currentPosition.left - me.offsetLeft;
        }
        return newPosition;
    },

    // equivalent of displayNextRevision, but for the more button
    showMoreButton: function(tiddlerElem, context, userParams, moreIndex) {
        userParams.from = moreIndex + 1;
        me.shiftVisibleDown(userParams.title, function() {
            var btn = me.createRevisionObject(tiddlerElem, context, userParams,
                "");

            var more = createTiddlyButton(btn[0], "more...", "show more revisions",
                function() {
                    if ($(".viewRevision").length) {
                        return;
                    }
                    userParams.tiddlerElem = btn[0];
                    $(btn).text("")
                        .append(revBtn
                            .getRevisionText(btn[0], context.revisions[moreIndex]))
                        .attr("revision", context.revisions.length - moreIndex);
                    me.expandStack(context, userParams);
                });
            $(more).css("float", "right");
        });
    },

    stripRevFromTitle: function(revisionTitle) {
        return revisionTitle.split(/ ?\[rev\. #[0-9]+\]$/)[0];
    },

    onClickRevision: function(revElem, revision, callback) {
        // don't do anything if we are still loading
        if ($(".revisions").hasClass("loading")) {
            return null;
        }

        var origTitle = me.stripRevFromTitle(revision.title);
        if ($(revElem).hasClass("viewRevision")) {
            $(".revisions").addClass("loading");
            me.slideIn(revElem, revision, origTitle, function() {
                store.deleteTiddler(revision.title);
                revision.title = origTitle;
                $(revElem).text("").append(revBtn.getRevisionText(revElem,
                        revision))
                    .removeAttr("tags").removeAttr("tiddler")
                    .removeAttr("refresh").removeAttr("template")
                    .removeAttr("id");
                $(".revisions").removeClass("loading");
                if (callback) {
                    callback();
                }
            });
            $(revElem).removeAttr("prevPos").removeClass("viewRevision");
        } else {
            var viewRevision = function() {
                var prevPos = $(revElem).position().left;
                $(revElem).addClass("viewRevision").attr("prevPos", prevPos);
                $(".revisions").addClass("loading");
                me.showRevision(revElem, revision, function(rev) {
                    me.slideOut(revElem, rev, origTitle, function() {
                        $(".revisions").removeClass("loading");
                    });
                });
            };
            // make sure another revision isn't already out
            if ($(".viewRevision").length) {
                var newRevElem = $(".viewRevision")[0];
                var newRevision = store.getTiddler($(newRevElem)
                    .attr("tiddler"));
                me.onClickRevision(newRevElem, newRevision, viewRevision);
            } else {
                viewRevision();
            }
        }
    },

    slideOut: function(revElem, revision, title, callback) {
        var leftMostPos = $("[revName='%0'].revisions".format([title]))
            .offset().left;
        var width = $(revElem).width();
        var originalLeftPos = $(story.getTiddler(title))
            .position().left;

        var slideAmount = leftMostPos + width - me.visibleSlideAmount;
        $("[revName='%0'].revisions:not(.viewRevision)".format([title]))
            .animate({left: "-=" + slideAmount}, 1000);
        $(revElem)
            .attr("baseHeight", $(revElem).css("height"))
            .css("height", "auto")
            .animate({left: originalLeftPos}, 1000, callback);
    },

    slideIn: function(revElem, revision, title, callback) {
        var slideAmount = $(revElem).offset().left -
            $(story.getTiddler(title)).offset().left;
        var origRevPos = $(revElem).attr("prevPos");

        $("[revName='%0'].revisions:not(.viewRevision)".format([title]))
            .animate({left: "+=" + slideAmount}, 1000);
        $(revElem).animate({left: origRevPos}, 1000, function() {
            $(revElem)
                .css("height", $(revElem).attr("baseHeight"))
                .removeAttr("baseHeight");
            callback();
        });
    }
};

var revBtn;
config.macros.slideRevision = revBtn = {
    btnText: "created by %0 at %1 on %2",
    handler: function(place, macroName, params, wikifier, paramString, tiddler) {
        var btn = revBtn.getRevisionText(place, tiddler);
        $(place).append(btn);
    },

    getRevisionText: function(place, revision) {
        var text = revBtn.btnText.format([revision.modifier,
            revision.modified.formatString("0hh:0mm"),
            revision.modified.formatString("0DD MMM YYYY")]);
        var btn = $('&lt;a href="javascript:;" class="button revButton" /&gt;')
            .text(text)
            .click(function() {
                var revElem = story.findContainingTiddler(this);
                me.onClickRevision(revElem, revision);
            });
        return btn;
    }
};

})(jQuery);
//}}}</pre>
</div>

<div title="StyleSheet">
<pre>[[StyleSheetTiddlySpace]]</pre>
</div>

<div title="SiteTitle">
<pre>迪伦</pre>
</div>

<div title="TiddlySpaceToolbar">
<pre>/***
|''Name''|TiddlySpaceToolbar|
|''Description''|augments tiddler toolbar commands with SVG icons|
|''Author''|Osmosoft|
|''Version''|0.6.6|
|''Status''|@@beta@@|
|''Source''|http://github.com/TiddlySpace/tiddlyspace/raw/master/src/plugins/TiddlySpaceToolbar.js|
|''CodeRepository''|http://github.com/TiddlySpace/tiddlyspace|
|''License''|[[BSD|http://www.opensource.org/licenses/bsd-license.php]]|
|''CoreVersion''|2.5.0|
|''Requires''|ImageMacroPlugin|
|''Keywords''|toolbar icons SVG|
!Description
replaces tiddler toolbar commands with SVG icons if available
!Notes
requires [[ImageMacroPlugin|http://svn.tiddlywiki.org/Trunk/contributors/JonRobson/plugins/ImageMacroPlugin/plugins/ImageMacroPlugin.tid]]

SVG icons are drawn from tiddlers titled {{{&lt;command&gt;.svg}}}
In readonly mode a tiddler called {{{&lt;command&gt;ReadOnly.svg}}} will be used if it exists.
!TODO
* rename (IconToolbarPlugin?)
* support more than one more popup menu in the toolbar.
!Code
***/
//{{{
(function($) {

if(!config.macros.image) {
    throw "Missing dependency: ImageMacroPlugin";
}

var macro = config.macros.toolbar;

macro.icons = {
    cloneTiddler: "editTiddler"
};

var _handler = macro.handler;
macro.handler = function(place, macroName, params, wikifier,
        paramString, tiddler) {
    var toolbar = $(place);
    toolbar.attr({
        refresh: "macro",
        macroName: macroName
    }).data("args", arguments);
    var status = _handler.apply(this, arguments);
    if(tiddler.isReadOnly()) {
        toolbar.addClass("toolbarReadOnly");
    } else {
        toolbar.removeClass("toolbarReadOnly");
    }
    var parsedParams = paramString.parseParams("name")[0];
    if(parsedParams.icons &amp;&amp; parsedParams.icons == "yes") {
        this.augmentCommandButtons(place);
    }
    if(parsedParams.more &amp;&amp; parsedParams.more == "popup") {
        // note we must override the onclick event like in createTiddlyButton
        // otherwise the click event is the popup AND the slider
        $(".moreCommand", place).each(function(i, el) {
            el.onclick = macro.onClickMorePopUp;
        });
        // buttons that are after a less command should not be in more menu.
        $(".lessCommand ~ .button", place).appendTo(place);
        $(".lessCommand", place).remove();
    }
    return status;
};

macro.refresh = function(place, params) {
    var args = $(place).empty().data("args");
    this.handler.apply(this, args);
};

var imageMacro = config.macros.image;
macro.augmentCommandButtons = function(toolbar) {
    $(".button", toolbar).each(function(i, el) {
        var cmd = $(el).attr("commandname");
        cmd = cmd ? cmd : "moreCommand"; // XXX: special-casing of moreCommand due to ticket #1234
        var icon = store.tiddlerExists(cmd) ? cmd : macro.icons[cmd];
        var text = $(el).text();
        if(readOnly) {
            var readOnlyAlternative = "%0ReadOnly".format([icon]);
            if(store.tiddlerExists(readOnlyAlternative)) {
                icon = readOnlyAlternative;
            }
        }
        if(store.tiddlerExists(icon)) {
            $(el).css({display: "inline-block"}).empty();
            imageMacro.renderImage(el, icon, { alt: text });
        }
    });
};

// provide onClickMore to provide extra commands in a popup
macro.onClickMorePopUp = function(ev) {
    ev = ev || window.event;
    var sibling = this.nextSibling;
    if(sibling) {
        var commands = sibling.childNodes;
        var popup = Popup.create(this);
        $(popup).addClass("taggedTiddlerList");
        for(var i = 0; i &lt; commands.length; i++) {
            var li = createTiddlyElement(popup, "li", null);
            var oldCommand = commands[i];
            var command = oldCommand.cloneNode(true);
            command.onclick = oldCommand.onclick;
            li.appendChild(command);
        }
        Popup.show();
    }
    ev.cancelBubble = true;
    if(ev.stopPropagation) {
        ev.stopPropagation();
    }
    return false;
};

})(jQuery);
//}}}</pre>
</div>

<div title="TiddlySpaceSearcher">
<pre>/***
|''Name''|TiddlySpaceSearcher|
|''Version''|0.2.5|
|''Requires''|TiddlySpaceConfig TiddlySpaceFollowingPlugin|
***/
//{{{
(function($) {
var tiddlyspace = config.extensions.tiddlyspace;
var tsScan = config.macros.tsScan;

config.shadowTiddlers.SearchTemplate = "&lt;&lt;view server.bag SiteIcon label:no width:24 height:24 preserveAspectRatio:yes&gt;&gt; &lt;&lt;view server.bag spaceLink title external:no&gt;&gt; in space &lt;&lt;view server.bag spaceLink&gt;&gt;";
config.shadowTiddlers.StyleSheetSearch = [".resultsArea .siteIcon { display: inline; }",
    ".searchForm {text-align: left;}"].join("\n");
store.addNotification("StyleSheetSearch", refreshStyles);

var search = config.macros.tsSearch = {
    locale: {
        advanced: "Advanced Options",
        header: "Search",
        resultsHeader: "Results (%0)",
        find: "find",
        noResults: "No tiddlers matched your search query",
        query: "QUERY: ",
        error: "please provide a search query or a tag, modifier or title!",
        titleAdvanced: "where the title is",
        modifierAdvanced: "where the last modifier is",
        spaceAdvanced: "only in the space: ",
        notspaceAdvanced: "but not in the spaces: ",
        tagsAdvanced: "with the tags: "
    },
    andConstructor: function(container, label, fieldname, negationMode) {
        var tags = $("&lt;div /&gt;").appendTo(container);
        $('&lt;span /&gt;').text(label).appendTo(tags);
        var id = "area" + Math.random();
        container = $("&lt;span /&gt;").attr("id", id).appendTo(tags)[0];
        function add(container) {
            var el = $('&lt;input type="text" /&gt;').attr("field", fieldname).appendTo(container);
            if(negationMode) {
                el.attr("negation", "true");
            }
        }
        add(container);
        var el = $("&lt;button /&gt;").text("AND").click(function(ev) {
            add($(ev.target).data("container"));
            ev.preventDefault();
        }).appendTo(tags);
        $(el).data("container", container);
    },
    fieldConstructor: function(container, label, field) {
        container = $("&lt;div /&gt;").appendTo(container)[0];
        $("&lt;span /&gt;").text(label).appendTo(container);
        $("&lt;input /&gt;").attr("text", "input").attr("field", field).appendTo(container);
    },
    advancedOptions: function(form) {
        var locale = search.locale;
        var container = $("&lt;div /&gt;").addClass("tsAdvancedOptions").appendTo(form)[0];
        $("&lt;h2/ &gt;").text(search.locale.advanced).appendTo(container);
        $("&lt;div /&gt;").addClass("separator").appendTo(container);
        search.fieldConstructor(container, locale.titleAdvanced, "title");
        search.fieldConstructor(container, locale.modifierAdvanced, "modifier");
        search.fieldConstructor(container, locale.spaceAdvanced, "space");
        search.andConstructor(container, locale.notspaceAdvanced, "space", true);
        search.andConstructor(container, locale.tagsAdvanced, "tag");
    },
    constructSearchQuery: function(form) {
        var data = [], select = [];
        var query = $("[name=q]", form).val();
        if(query) {
            data.push("q=%0".format(query));
        }

        // add tags, fields etc..
        $("[field]", form).each(function(i, el) {
            var val = $(el).val();
            var name = $(el).attr("field");
            var negate = $(el).attr("negation") == "true";
            if(val &amp;&amp; name) {
                val = encodeURIComponent(val);
                val = negate ? "!" + val : val;
                if(name == "space") {
                    val += "_public";
                    name = "bag";
                }
                if(negate) {
                    select.push("select=%0:%1".format(name,val));
                } else {
                    var prefix = data.length === 0 ? "q=" : "";
                    data.push('%0%1:"%2"'.format(prefix, name, val));
                }
            }
        });
        var dataString = data.join(" ");
        if(dataString.length === 0 &amp;&amp; !query) {
            return false;
        }
        var selectStatement = select.join("&amp;");
        if(dataString.length &gt; 0 &amp;&amp; selectStatement.length &gt; 0) {
            dataString += "&amp;";
        }
        dataString += selectStatement;
        return "/search?%0".format(dataString);
    },
    constructForm: function(place) {
        var locale = search.locale;
        $("&lt;h1 /&gt;").text(locale.header).appendTo(place);
        var form = $("&lt;form /&gt;").appendTo(place)[0];
        $('&lt;input type="text" name="q" /&gt;').appendTo(form);
        $('&lt;input type="submit" /&gt;').val(locale.find).appendTo(form);
        search.advancedOptions(form);
        var query = $('&lt;h2 class="query"/&gt;').appendTo(place)[0];
        var results = $("&lt;div /&gt;").appendTo(place).addClass("resultsArea")[0];
        var lookup = function(url) {
            if(!url) {
                results.empty().addClass("error").text(locale.error);
                return;
            }
            config.extensions.tiddlyweb.getStatus(function(status) {
                $(query).text(locale.query);
                var href = status.server_host.url + url;
                $("&lt;a /&gt;").attr("href", href).text(href).appendTo(query);
                tsScan.scan(results, { url: url, emptyMessage: search.locale.noResults, cache: true,
                    template: "SearchTemplate", sort: "title", callback: function(tiddlers) {
                        $("&lt;h2 /&gt;").text(locale.resultsHeader.format(tiddlers.length)).prependTo(results);
                    }
                });
            });
        };
        $(form).submit(function(ev) {
            ev.preventDefault();
            var url = search.constructSearchQuery(form);
            config.macros.tsSearch.lastSearch = url;
            lookup(url);
        });
        if(search.lastSearch) {
            lookup(search.lastSearch);
        }
        return form;
    },
    handler: function(place) {
        var container = $("&lt;div /&gt;").addClass("searchForm").appendTo(place)[0];
        search.constructForm(container);
    }
};

})(jQuery);
//}}}</pre>
</div>

<div title="Start writing">
<pre>Click the "new tiddler" button towards the top right of the screen to write something in your space. You'll need to give it a title, some content and, optionally, some tags that will help you identify it later.

!Stuck for ideas?
Not sure what to write about? Not sure what to keep in your space? Other people use ~TiddlySpace for almost anything. How about some of the following:

* [[Save interesting sites|http://bookmarks.tiddlyspace.com]], images or articles from around the web so that you can refer back to them.
* [[Record your family tree|http://familytree.tiddlyspace.com]], store notes on long lost relatives or ancestors and map their relationship to you.
* [[Make up a pocketbook|http://pocketbook.tiddlyspace.com]] to store some useful information in, then print it out, [[fold it up|http://www.pocketmod.com/]], and take it with you.
* [[Plan your holiday|http://the-web-is-your-oyster.tiddlyspace.com/]], record where you're planning to go, note down places of interest and refer back to it later.
* [[Create a mindmap|http://mindmaps.tiddlyspace.com/]] to visualise your inner thoughts and see how they relate to each other.
* [[Set up a questionnaire|http://questionnaire.tiddlyspace.com/]] and get all your friends to answer it.

If you don't like any of those ideas, you can still use this space directly to keep notes and link them together, make a todo list and keep track of everything you're doing, or any one of a hundred million other things.

Still stuck? Check out the @featured space for more suggestions.

You can also [[socialise with others|How to socialise]].</pre>
</div>

<div title="EditTemplate">
<pre>&lt;!--{{{--&gt;
&lt;div class='toolbar'
    macro='toolbar [[ToolbarCommands::EditToolbar]] icons:yes'&gt;
&lt;/div&gt;
&lt;div class='heading editorHeading'&gt;
    &lt;div class='editor title' macro='edit title'&gt;&lt;/div&gt;
    &lt;div class='tagClear'&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class='annotationsBox' macro='annotations'&gt;
    &lt;div class='editSpaceSiteIcon'
        macro='tiddlerOrigin height:16 width:16 label:no interactive:no'&gt;
    &lt;/div&gt;
    &lt;div class="privacyEdit" macro='setPrivacy label:no interactive:no'&gt;&lt;/div&gt;
    &lt;div class='tagClear'&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class='editor' macro='edit text'&gt;&lt;/div&gt;
&lt;div class='editorFooter'&gt;
    &lt;div class='tagTitle'&gt;tags&lt;/div&gt;
    &lt;div class='editor' macro='edit tags'&gt;&lt;/div&gt;
    &lt;div class='tagAnnotation'&gt;
        &lt;span macro='message views.editor.tagPrompt'&gt;&lt;/span&gt;
        &lt;span macro='tagChooser excludeLists'&gt;&lt;/span&gt;
    &lt;/div&gt;
&lt;/div&gt;
&lt;!--}}}--&gt;</pre>
</div>

<div title="TiddlySpaceFilters">
<pre>/***
|''Name''|TiddlySpaceFilters|
|''Description''|provide TiddlySpace-specific filter extensions|
|''Author''|Jon Robson|
|''Version''|0.6.1|
|''Status''|@@beta@@|
|''CoreVersion''|2.6.2|
|''Requires''|TiddlySpaceConfig|
|''License''|[[BSD|http://www.opensource.org/licenses/bsd-license.php]]|
!Usage
{{{
&lt;&lt;tsList Private&gt;&gt;
&lt;&lt;tsList Public&gt;&gt;
&lt;&lt;tsList Draft&gt;&gt;
}}}
!Code
***/
//{{{
(function($) {

var tiddlyspace = config.extensions.tiddlyspace;
var privateBag = tiddlyspace.getCurrentBag("private");
var publicBag = tiddlyspace.getCurrentBag("public");

config.filterHelpers = {
    is: {
        "private": function(tiddler) {
            var bag = tiddler.fields["server.bag"];
            return bag == privateBag;
        },
        "public": function(tiddler) {
            var bag = tiddler.fields["server.bag"];
            return bag == publicBag;
        },
        draft: function(tiddler) {
            var fields = tiddler.fields;
            var bag = fields["server.bag"];
            return (privateBag == bag &amp;&amp; fields["publish.name"]) ? true : false;
        },
        local: function(tiddler) {
            return config.filterHelpers.is["public"](tiddler) ||
                config.filterHelpers.is["private"](tiddler);
        },
        unsynced: function(tiddler) {
            return tiddler ? tiddler.isTouched() : false;
        }
    }
};

config.filters.is = function(results, match) {
    var candidates = store.getTiddlers("title");
    var type = match[3];
    for (var i = 0; i &lt; candidates.length; i++) {
        var tiddler = candidates[i];
        var helper = config.filterHelpers.is[type];
        if(helper &amp;&amp; helper(tiddler)) {
            results.pushUnique(tiddler);
        }
    }
    return results;
};

})(jQuery);
//}}}</pre>
</div>

<div title="deleteTiddler">
<pre>&lt;svg xmlns="http://www.w3.org/2000/svg" xmlns:xl="http://www.w3.org/1999/xlink" version="1.1" viewBox="450 366 38 57"
width="30" height="30"&gt;
    &lt;g stroke="none" stroke-opacity="1" stroke-dasharray="none" fill="none" fill-opacity="1"&gt;
        &lt;g&gt;
            &lt;path d="M 452.1094 421.2422 L 450 421.2422 L 450 423 L 487.9688 423 L 487.9688 421.2422 L 485.8595 421.2422 
            L 485.8595 377.29688 L 487.9688 377.29688 L 487.9688 375.53906 L 485.8595 375.53906 
            C 485.8595 375.53906 481.12463 371.59341 473.02023 370.52802 C 472.6824 368.9689 471.72098 366.75 468.9844 366.75 
            C 466.24783 366.75 465.28638 368.9689 464.94864 370.52802 
            C 456.84418 371.59341 452.1094 375.53906 452.1094 375.53906 L 450 375.53906 L 450 377.29688 L 452.1094 377.29688 
            Z M 467.12247 370.32086 L 467.12247 370.32086 C 467.3805 369.42395 467.90762 368.50781 468.9844 368.50781 
            C 470.0612 368.50781 470.5883 369.42395 470.84634 370.32086 
            C 470.24136 370.2848 469.62054 370.26562 468.9844 370.26562 
            C 468.34827 370.26562 467.72748 370.2848 467.12247 370.32086 Z M 454.21875 420.92804 L 454.21875 420.92804 
            C 455.46762 420.42087 456.32816 419.35281 456.32816 418.11716 L 456.32816 377.29688 L 458.4375 377.29688 
            L 458.4375 421.2422 L 454.21875 421.2422 Z M 460.5469 420.92804 L 460.5469 420.92804 
            C 461.79578 420.42087 462.65625 419.35281 462.65625 418.11716 L 462.65625 377.29688 L 464.76566 377.29688 
            L 464.76566 421.2422 L 460.5469 421.2422 Z M 466.87503 420.92804 L 466.87503 420.92804 
            C 468.1239 420.42087 468.9844 419.35281 468.9844 418.11716 L 468.9844 377.29688 L 471.09378 377.29688 
            L 471.09378 421.2422 L 466.87503 421.2422 Z M 473.2032 420.92804 L 473.2032 420.92804 
            C 474.45203 420.42087 475.31256 419.35281 475.31256 418.11716 L 475.31256 377.29688 L 477.4219 377.29688 
            L 477.4219 421.2422 L 473.2032 421.2422 Z M 479.5313 420.92804 L 479.5313 420.92804 
            C 480.78018 420.42087 481.64066 419.35281 481.64066 418.11716 L 481.64066 377.29688 L 483.75006 377.29688 
            L 483.75006 421.2422 L 479.5313 421.2422 Z" fill="black" class="glyph"/&gt;
        &lt;/g&gt;
    &lt;/g&gt;
&lt;/svg&gt;</pre>
</div>

<div title="RandomColorPalettePlugin">
<pre>/***
|''Name''|RandomColorPalettePlugin|
|''Description''|Adds a random color palette to TiddlyWiki|
|''Author''|Jon Robson|
|''Version''|1.4.0|
|''Status''|stable|
|''Source''|https://github.com/jdlrobson/TiddlyWikiPlugins/raw/master/plugins/RandomColorPalettePlugin/RandomColorPalettePlugin.js|
|''License''|[[BSD|http://www.opensource.org/licenses/bsd-license.php]]|
!Usage
{{{
&lt;&lt;RandomColorPalette&gt;&gt;
}}}
Sets and saves a random color palette on execution

{{{
&lt;&lt;RandomColorPaletteButton&gt;&gt;
}}}
Creates a button, which when clicked will change the color palette
More information at http://macros.tiddlyspace.com/#%5B%5BRandomColorPaletteButton%20macro%5D%5D
!Code
***/
//{{{
RGB.prototype.toRGBString = function() {
    return "rgb(%0,%1,%2)".format(parseInt(this.r * 255, 10),
        parseInt(this.g * 255, 10), parseInt(this.b * 255, 10))
}
function HSL_TO_RGB(h, s, l) { // h (hue) between 0 and 360, s (saturation) &amp; l (lightness) between 0 and 1
    var c = l &lt;= 0.5 ? 2 * l * s : ( 2 - (2 * l)) * s;
    var h1 = h / 60;
    var x = c * (1 - Math.abs((h1 % 2) - 1)); 
    var r, g, b;
    if(typeof(h) == 'undefined') {
        r = 0;
        g = 0;
        b = 0;
    } else if(0 &lt;= h1 &amp;&amp; h1 &lt; 1) {
        r = c;
        g = x;
        b = 0;
    } else if(1 &lt;= h1 &amp;&amp; h1 &lt; 2) {
        r = x;
        g = c;
        b = 0;
    } else if(2 &lt;= h1 &amp;&amp; h1 &lt; 3) {
        r = 0;
        g = c;
        b = x;
    } else if(3 &lt;= h1 &amp;&amp; h1 &lt; 4) {
        r = 0;
        g = x;
        b = c;
    } else if(4 &lt;= h1 &amp;&amp; h1 &lt; 5) {
        r = x;
        g = 0;
        b = c;
    } else if(5 &lt;= h1 &amp;&amp; h1 &lt; 6) {
        r = c;
        g = 0;
        b = x;
    }
    m = l - (0.5 * c);
    return new RGB(r + m, g + m, b + m);
}

(function($){
    var macro = config.macros.RandomColorPalette = {
        messagesOn: false, 
        changedPaletteText: "We have assigned you a random theme by adjusting the [[ColorPalette]] tiddler.\nDon't like it? Click &lt;&lt;RandomColorPalette&gt;&gt; for another one.", 
        handler: function(place, macroName, params, wikifier, paramString, tiddler) {
            paramString = paramString || "";
            var options = macro.getOptions(paramString);
            macro.generatePalette(options, true);
        },
        optionTypes: {
            floats: ["hue", "saturation", "darkest", "lightness", "huevariance", "dark", "pale", "light", "mid",
                "saturation_light", "saturation_pale", "saturation_mid", "saturation_dark"
            ]
        },
        getOptions: function(paramString) {
            var args = paramString.parseParams("name", null, true, false, true)[0];
            var options = {};
            var numbers = macro.optionTypes.floats;
            for(var i in args) {
                options[i] = numbers.indexOf(i) &gt; -1 ? parseFloat(args[i][0], 10) : args[i][0];
            }
            return options;
        },
        generateRandomNumber: function(min, max, info) {
            var num = (Math.random() * 1);
            info = !info ? { attempts:0 } : info;
            info.attempts += 1;
            var good = true;
            if(min == max) {
                return max;
            }
            if(min &amp;&amp; num &lt; min) {
                good = false;
            } else if(max &amp;&amp; num &gt; max) {
                good = false;
            }
            if(!good) {
                if(info.attempts &lt; 5) {
                    return macro.generateRandomNumber(min, max, info);
                } else {
                    if(max) {
                        return max;
                    } else if(min) {
                        return min;
                    } else {
                        return 1;
                    }
                }
            }
            return num;
        },
        getExistingPalette: function(asJSON) {
            var title = "ColorPalette";
            var tiddlerText;
            if(store.tiddlerExists(title)) {
                tiddlerText = store.getTiddlerText(title);
            } else if(store.isShadowTiddler(title)){
                tiddlerText = config.shadowTiddlers[title];
            }
            if(asJSON) {
                var json = {};
                if(tiddlerText) {
                    var lines = tiddlerText.split("\n");
                    for(var i = 0; i &lt; lines.length; i++) {
                        var definition = lines[i].split(":");
                        if(definition.length == 2) {
                            var name = definition[0].trim();
                            var value = definition[1].trim();
                            json[name] = value;
                        }
                    }
                }
                return json;
            } else {
                return tiddlerText;
            }
        },
        generatePalette: function(options, save) {
            var outputRGB = options.rgb;
            var palette = macro.getExistingPalette(true);
            var hue = options.hue || Math.floor(Math.random() * 359);
            var saturation = options.saturation || macro.generateRandomNumber(0.3, 0.7);
            var dark = options.dark || options.darkest || macro.generateRandomNumber(0, 0.10);
            var pale = options.pale || options.lightness || macro.generateRandomNumber(0.90, 1);
            var delta = ( ( pale - dark ) / 3 );
            var mid = options.mid || dark + delta;
            var light = options.light || dark + (delta * 2);
            var lightness_values = {Dark: dark, Mid: mid, Light: light, Pale: pale};
            var saturation_values = {};
            for(i in lightness_values) {
                if(true) {
                    saturation_values[i] = options["saturation_" + i.toLowerCase()] || saturation;
                }
            }

            var opposite_hue = (hue + 180) % 360;
            var seed = options.huevariance || Math.floor((85 * Math.random()) + 5); // we want it to be at least 5 degrees
            var huetwo = (opposite_hue + seed) % 360;
            var huethree = (opposite_hue - seed) % 360;
            if(huetwo &lt; 0) {
                huetwo = 360 + huetwo;
            }
            if(huethree &lt; 0) {
                huethree = 360 + huethree;
            }
            for(var j in lightness_values) {
                if(true) {
                    var saturation = saturation_values[j];
                    palette["Primary" + j] = HSL_TO_RGB(hue, saturation, lightness_values[j]);
                    palette["Secondary" + j] = HSL_TO_RGB(huetwo, saturation, lightness_values[j]);
                    palette["Tertiary" + j] = HSL_TO_RGB(huethree, saturation, lightness_values[j]);
                }
            }
            palette.Background = HSL_TO_RGB(hue, saturation, 0.92);
            palette.Foreground = HSL_TO_RGB(hue, saturation, 0.08);
            palette.ColorPaletteParameters = ["HSL([", hue, "|", seed, "], [", saturation_values.Pale, "|",
                saturation_values.Light, "|", saturation_values.Mid, "|", saturation_values.Dark, "],",
                "[", dark, "|", mid, "|", light, "|", pale, "])"].join("");
            // construct new ColorPalette
            var text = ["/*{{{*/\n"];
            var colorcode;
            for(var id in palette) {
                if(true) {
                    var color = palette[id];
                    colorcode = outputRGB ? color.toRGBString() : color.toString();
                    text.push("%0: %1\n".format(id, colorcode));
                }
            }
            text.push("/*}}}*/");
            text = text.join("");
            if(save) {
                macro.saveColorPalette(text);
            }
            return text;
        },
        saveColorPalette: function(text) {
            var tid = store.getTiddler("ColorPalette");
            if(!tid) {
                tid = new Tiddler("ColorPalette");
                tid.fields = merge({}, config.defaultCustomFields);
            } // TODO: detect that the ColorPalette in the space comes from outside recipe
            tid.fields["server.page.revision"] = "false"; // edit conflicts dont matter

            // save the color palette in tid
            tid = store.saveTiddler(tid.title, tid.title, text, tid.modifier, tid.modified,
                tid.tags, tid.fields, false, tid.created, tid.creator);
            // an interval is used to cope with users clicking on the palette button quickly.
            if(macro._nextSave) {
                window.clearTimeout(macro._nextSave);
            }
            macro._nextSave = window.setTimeout(function() {
                    autoSaveChanges(null, [tid]);
                }, 2000);
            // temporary workaround for IE.
            $.twStylesheet.remove({ id: "StyleSheetColors" });
            $.twStylesheet.remove({ id: "StyleSheet" });
            refreshAll();
            macro.reportChange();
            return tid;
        },
        reportChange: function() {
            if(macro.messagesOn) { // only display message once..
                var msgPlace = getMessageDiv();
                if(!$(".changedPalette", msgPlace)[0]) {
                    var tempPlace = document.createElement("div");
                    wikify("{{changedPalette{" + macro.changedPaletteText + "}}}", tempPlace);
                    msgPlace.appendChild(tempPlace);
                }
            }
        }
    };
    var btnMacro = config.macros.RandomColorPaletteButton = {
            text: "New ColorPalette",
            tooltip: "Generate a random colour scheme for your TiddlyWiki",
            makeButton: function(place, options) {
                var btnHandler = function(ev) {
                    var t = $(ev.target);
                    var options = t.data("options");
                    macro.generatePalette(options, true);
                    ev.preventDefault();
                    return false;
                };
                var btn = createTiddlyButton(place, this.text, this.tooltip, btnHandler);
                $(btn).data("options", options);
                return btn;
            },
            handler: function(place, macroName, params, wikifier, paramString, tiddler) {
                var options = macro.getOptions(paramString);
                btnMacro.makeButton(place, options);
            }
    };
})(jQuery);
//}}}</pre>
</div>

<div title="closeTiddler">
<pre>&lt;svg xmlns="http://www.w3.org/2000/svg" xmlns:xl="http://www.w3.org/1999/xlink" version="1.1" viewBox="78 222 60 60" 
width="30" height="30"&gt;
&lt;g stroke="none" stroke-opacity="1" stroke-dasharray="none" fill="none" fill-opacity="1"&gt;
    &lt;g&gt;
        &lt;path d="M 107.92718 244.14815 L 86.651474 222.89253 L 78.85206 230.69925 L 100.120415 251.9476 L 78.774 273.27396 
        L 86.57342 281.08075 L 107.927216 259.74707 L 129.39981 281.19946 L 137.19922 273.39267 L 115.73397 251.94763 
        L 137.121155 230.58054 L 129.32175 222.77374 Z" fill="black" class="glyph"/&gt;
    &lt;/g&gt;
&lt;/g&gt;
&lt;/svg&gt;</pre>
</div>

<div title="TiddlyWebConfig">
<pre>/***
|''Name''|TiddlyWebConfig|
|''Description''|configuration settings for TiddlyWebWiki|
|''Author''|FND|
|''Version''|1.3.2|
|''Status''|stable|
|''Source''|http://svn.tiddlywiki.org/Trunk/association/plugins/TiddlyWebConfig.js|
|''License''|[[BSD|http://www.opensource.org/licenses/bsd-license.php]]|
|''Requires''|TiddlyWebAdaptor ServerSideSavingPlugin|
|''Keywords''|serverSide TiddlyWeb|
!Code
***/
//{{{
(function($) {

if(!config.extensions.ServerSideSavingPlugin) {
    throw "Missing dependency: ServerSideSavingPlugin";
}
if(!config.adaptors.tiddlyweb) {
    throw "Missing dependency: TiddlyWebAdaptor";
}

if(window.location.protocol != "file:") {
    config.options.chkAutoSave = true;
}

var adaptor = tiddler.getAdaptor();
var recipe = tiddler.fields["server.recipe"];
var workspace = recipe ? "recipes/" + recipe : "bags/common";

var plugin = config.extensions.tiddlyweb = {
    host: tiddler.fields["server.host"].replace(/\/$/, ""),
    username: null,
    status: {},

    getStatus: null, // assigned later
    getUserInfo: function(callback) {
        this.getStatus(function(status) {
            callback({
                name: plugin.username,
                anon: plugin.username ? plugin.username == "GUEST" : true
            });
        });
    },
    hasPermission: function(type, tiddler) {
        var perms = tiddler.fields["server.permissions"];
        if(perms) {
            return perms.split(", ").contains(type);
        } else {
            return true;
        }
    }
};

config.defaultCustomFields = {
    "server.type": tiddler.getServerType(),
    "server.host": plugin.host,
    "server.workspace": workspace
};

// modify toolbar commands

config.shadowTiddlers.ToolbarCommands = config.shadowTiddlers.ToolbarCommands.
    replace("syncing ", "revisions syncing ");

config.commands.saveTiddler.isEnabled = function(tiddler) {
    return plugin.hasPermission("write", tiddler) &amp;&amp; !tiddler.isReadOnly();
};

config.commands.deleteTiddler.isEnabled = function(tiddler) {
    return !readOnly &amp;&amp; plugin.hasPermission("delete", tiddler);
};

// hijack option macro to disable username editing
var _optionMacro = config.macros.option.handler;
config.macros.option.handler = function(place, macroName, params, wikifier,
        paramString) {
    if(params[0] == "txtUserName") {
        params[0] = "options." + params[0];
        var self = this;
        var args = arguments;
        args[0] = $("&lt;span /&gt;").appendTo(place)[0];
        plugin.getUserInfo(function(user) {
            config.macros.message.handler.apply(self, args);
        });
    } else {
        _optionMacro.apply(this, arguments);
    }
};

// hijack isReadOnly to take into account permissions and content type
var _isReadOnly = Tiddler.prototype.isReadOnly;
Tiddler.prototype.isReadOnly = function() {
    return _isReadOnly.apply(this, arguments) ||
        !plugin.hasPermission("write", this);
};

var getStatus = function(callback) {
    if(plugin.status.version) {
        callback(plugin.status);
    } else {
        var self = getStatus;
        if(self.pending) {
            if(callback) {
                self.queue.push(callback);
            }
        } else {
            self.pending = true;
            self.queue = callback ? [callback] : [];
            var _callback = function(context, userParams) {
                var status = context.serverStatus || {};
                for(var key in status) {
                    if(key == "username") {
                        plugin.username = status[key];
                        config.macros.option.propagateOption("txtUserName",
                            "value", plugin.username, "input");
                    } else {
                        plugin.status[key] = status[key];
                    }
                }
                for(var i = 0; i &lt; self.queue.length; i++) {
                    self.queue[i](plugin.status);
                }
                delete self.queue;
                delete self.pending;
            };
            adaptor.getStatus({ host: plugin.host }, null, _callback);
        }
    }
};
(plugin.getStatus = getStatus)(); // XXX: hacky (arcane combo of assignment plus execution)

})(jQuery);
//}}}</pre>
</div>

<div title="ToggleTiddlerPrivacyPlugin">
<pre>/***
|''Name''|ToggleTiddlerPrivacyPlugin|
|''Version''|0.7.1|
|''Status''|@@beta@@|
|''Description''|Allows you to set the privacy of new tiddlers and external tiddlers within an EditTemplate, and allows you to set a default privacy setting|
|''CoreVersion''|2.6.1|
|''Requires''|TiddlySpaceConfig|
|''Source''|http://github.com/TiddlySpace/tiddlyspace/raw/master/src/plugins/ToggleTiddlerPrivacyPlugin.js|
!Notes
When used in conjunction with TiddlySpaceTiddlerIconsPlugin changing the privacy setting will also interact with any privacy icons.

Currently use of
{{{&lt;&lt;setPrivacy defaultValue:public&gt;&gt;}}} is in conflict with {{{&lt;&lt;newTiddler fields:"server.workspace:x_private"&gt;&gt;}}}

There is an option, found in the tweak tab of the backstage, called txtPrivacyMode. Set this to either ''public'' or ''private'' depending on your security preference. If you choose not to set it then it will default to ''public''.
!Params
defaultValue:[private|public]
Allows you to set the default privacy value (Default is private)

!Code
***/
//{{{
(function($) {

    var tiddlyspace = config.extensions.tiddlyspace,
        macro;
    macro = config.macros.setPrivacy = {
        handler: function(place, macroName, params, wikifier, paramString, tiddler) {
            if(readOnly) {
                return;
            }
            var el = $(story.findContainingTiddler(place)),
                args = paramString.parseParams("name",
                    null, true, false, true)[0],
                container = $("&lt;div /&gt;").
                    addClass("privacySettings").
                    appendTo(place)[0],
                currentSpace = tiddlyspace.currentSpace.name,
                currentBag = tiddler ? tiddler.fields["server.bag"] : false,
                // XXX: is the following reliable?
                isNewTiddler = el.hasClass("missing") || !currentBag,
                tiddlerStatus = tiddlyspace.getTiddlerStatusType(tiddler),
                customFields = el.attr("tiddlyfields"),
                defaultValue = "public",
                options = config.macros.tiddlerOrigin ?
                        config.macros.tiddlerOrigin.getOptions(paramString) :
                        {};
            customFields = customFields ? customFields.decodeHashMap() : {};
            if(isNewTiddler || !["public", "private", "unsyncedPrivate",
                    "unsyncedPublic"].contains(tiddlerStatus)) {
                if(args.defaultValue) {
                    defaultValue = args.defaultValue[0].toLowerCase();
                } else {
                    defaultValue = config.options.chkPrivateMode ?
                            "private" : "public";
                }
                defaultValue = defaultValue ?
                        "%0_%1".format(currentSpace, defaultValue) :
                        customFields["server.bag"];
                this.createRoundel(container, tiddler, currentSpace,
                        defaultValue, options);
            }
        },
        updateEditFields: function(tiddlerEl, bag) {
            var saveBagField = $('[edit="server.bag"]', tiddlerEl),
                saveWorkspaceField = $('[edit="server.workspace"]', tiddlerEl),
                input = $("&lt;input /&gt;").attr("type", "hidden"),
                workspace = "bags/" + bag;
            if(saveBagField.length === 0) {
                input.clone().attr("edit", "server.bag").val(bag).
                    appendTo(tiddlerEl);
            } else {
                saveBagField.val(bag);
            }
            // reset to prevent side effects
            $(tiddlerEl).attr("tiddlyFields", "");
            if(saveWorkspaceField.length === 0) {
                input.clone().attr("edit", "server.workspace").
                    val(workspace).appendTo(tiddlerEl);
            } else {
                saveWorkspaceField.val(workspace);
            }
        },
        setBag: function(tiddlerEl, newBag, options) {
            var bagStatus,
                title = $(tiddlerEl).attr("tiddler"),
                tiddler = store.getTiddler(title),
                originButton = $(".originButton", tiddlerEl)[0],
                refreshIcon,
                newWorkspace = "bags/" + newBag,
                rPrivate = $("input[type=radio].isPrivate", tiddlerEl),
                rPublic = $("input[type=radio].isPublic", tiddlerEl);
            refreshIcon = function(type) {
                var originMacro = config.macros.tiddlerOrigin;
                if(originButton &amp;&amp; originMacro) {
                    options.noclick = true;
                    originMacro.showPrivacyRoundel(tiddler, type,
                            originButton, options);
                }
            };
            macro.updateEditFields(tiddlerEl, newBag);
            if(tiddler) {
                tiddler.fields["server.bag"] = newBag;
                // for external tiddlers
                tiddler.fields["server.workspace"] = newWorkspace;
            }
            if(newBag.indexOf("_public") &gt; -1) {
                rPrivate.attr("checked", false);
                rPublic.attr("checked", true);
                bagStatus = "public";
            } else {
                rPublic.attr("checked", false); // explicitly do this for ie
                rPrivate.attr("checked", true);
                bagStatus = "private";
            }
            refreshIcon(bagStatus);
        },
        createRoundel: function(container, tiddler, currentSpace,
                               defaultValue, options) {
            var privateBag = "%0_private".format(currentSpace),
                publicBag = "%0_public".format(currentSpace),
                rbtn = $("&lt;input /&gt;").attr("type", "radio").
                    attr("name", tiddler.title),
                el = story.findContainingTiddler(container);
            rbtn.clone().val("private").addClass("isPrivate").
                appendTo(container);
            $("&lt;label /&gt;").text("private").appendTo(container); // TODO: i18n
            rbtn.clone().val("public").addClass("isPublic")
                .appendTo(container);
            $("&lt;label /&gt;").text("public").appendTo(container); // TODO: i18n
            $("[type=radio]", container).click(function(ev) {
                var btn = $(ev.target);
                tiddler.fields["server.page.revision"] = "false";
                if(btn.hasClass("isPrivate")) { // private button clicked.
                    $(el).addClass("isPrivate").removeClass("isPublic");
                    macro.setBag(el, privateBag, options);
                } else {
                    $(el).addClass("isPublic").removeClass("isPrivate");
                    macro.setBag(el, publicBag, options);
                }
            });
            window.setTimeout(function() {
                macro.setBag(el, defaultValue, options);
            }, 100);
            // annoyingly this is needed as customFields are added to end of EditTemplate so are not present yet
            // and don't seem to respect any existing customFields.
        }
    };

}(jQuery));
//}}}</pre>
</div>

<div title="对与alphawiki和anwiki的比较">
<pre>一、 对与alphawiki和anwiki的比较
（1）一般特征比较：一般特征中大部分都是较为相同的，主要提出在许可证、编程语言、数据存储，及目标受众上略有差别，前者的编程语言除PHP外，还有javascriph后者只有PHP，数据存储上前者只有文件，后者除此外还有数据库，最后是关于受众群众的区别，前者针对私人用户，后者是基于比较专业内容与架构。
（2）系统需求比较：基本相具有似，不同之处在于前者有根访问，后者没有。
（3）数据存储：前者是用对文本文件进行存储，后者是用数据库进行存储。
（4）安全与反垃圾邮件：基本相似，但后者有验证码功能。
（5）开发与支持：主要差别在于代码存储器。前者有支持论坛，后者没有，后者有问题追踪器、邮件列表，前者没有。
（6）共同特征：两者相似之处是预览、浏览历史、页面索引、插件系统。
（7）特殊功能：除unicode支持相同外，其他的都具有差别，主要体现在界面语言、评论、冲突处理与搜索上。
（8）链接：两者都有的链接有Freelinks、图片链接，后者除此外还有反向链接、windows的股票。
（9）语法功能：相同之处在于HTML标记、内部评论、自定义风格。不同之处在于数学公式、表情符号图像，引用，脚本。
（10）数据统计：前者有最近游客的统计，后者没有
（11）输出：除HTML、CSS样式表、主题和皮肤、AUTO-TOC，原料出口相同外，其他都具有差别。
（12）媒体文件：两者都具有嵌入式闪存、嵌入式视频、，除此外前者还有文件附件、SVG编辑。
以上为alphawiki和anwiki比较论述。



</pre>
</div>

<div title="Backstage">
<pre>!SpaceUnplugged
{{unpluggedSpaceTab{
{{wizard{
&lt;&lt;image unsyncedIcon width:48&gt;&gt; Sync is currently unavailable in ~TiddlyWiki due to security constraints in modern browsers. Research is being done to build a suitable alternative. In the meantime if you have changed content in an offline ~TiddlyWiki, you can get your content back into ~TiddlySpace by using the ''import'' functionality from the backstage of the online wiki.
}}}
}}}

!Menu
&lt;&lt;message messages.memberStatus&gt;&gt; &lt;&lt;homeLink&gt;&gt;
{{unsyncedList{&lt;&lt;message messages.syncListHeading&gt;&gt; &lt;&lt;list filter [is[unsynced]]&gt;&gt;}}}

running TiddlySpace@glossary version &lt;&lt;message extensions.tiddlyweb.status.tiddlyspace_version&gt;&gt;
{{autotable{
&lt;&lt;tiddler Backstage##Resources&gt;&gt;
}}}

!Resources
[[blog|@@blog]] [[documentation|@@docs]] [[featured spaces|@@featured]] 

!ImportExport
&lt;&lt;fileImport&gt;&gt;
You can download this TiddlySpace as an offline TiddlyWiki:

{{chunkyButton{&lt;&lt;exportSpace&gt;&gt;}}}

!BackstageTiddlers
|upload a &lt;&lt;message messages.privacySetting&gt;&gt; file: &lt;&lt;binaryUpload&gt;&gt;|&lt;&lt;closeAll&gt;&gt;&lt;&lt;permaview&gt;&gt;&lt;&lt;newTiddler&gt;&gt;&lt;&lt;newJournal "DD MMM YYYY" "journal"&gt;&gt;&lt;&lt;saveChanges&gt;&gt;|
|&gt;|&lt;&lt;search&gt;&gt;|
|&gt;|&lt;&lt;tiddler Backstage##Tiddlers&gt;&gt;|

!Tiddlers
&lt;&lt;tabs
    txtMainTab
    "Recent" "Recently edited tiddlers" TabTimeline
    "All" "All tiddlers" TabAll
    "Public" "All public tiddlers" [[TiddlySpaceTabs##Public]]
    "Private" "All private tiddlers" [[TiddlySpaceTabs##Private]]
    "Tags" "All tags" TabTags
    "Spaces" "Tiddlers grouped by space" [[TiddlySpaceTabs##Spaces]]
    "Missing" "Missing tiddlers" TabMoreMissing
    "Orphans" "Orphaned tiddlers" TabMoreOrphans
    "Shadows" "Shadowed tiddlers" TabMoreShadowed
&gt;&gt;

!BatchOps
&lt;&lt;tabs
    txtPublisherTab
    "Private" "Move tiddlers from private to public" Backstage##BatchPrivate
    "Public" "Move tiddlers from public to private" Backstage##BatchPublic
&gt;&gt;

!BatchPrivate
&lt;&lt;TiddlySpacePublisher type:private&gt;&gt;

!BatchPublic
&lt;&lt;TiddlySpacePublisher type:public&gt;&gt;

!Plugins
''Note:'' Many of these plugins are core TiddlySpace plugins and cannot be changed unless first cloned.

&lt;&lt;tiddler PluginManager&gt;&gt;

!Tweaks
These options change behavior in TiddlyWiki //only// and may be ineffective in TiddlySpace.

&lt;&lt;tiddler AdvancedOptions&gt;&gt;</pre>
</div>

<div title="TiddlySpaceRevertRevision">
<pre>/***
|''Name''|TiddlySpaceRevertRevision|
|''Description''|Revert to a previous revision|
|''Author''|BenGillies|
|''Version''|0.1|
|''Status''|unstable|
|''Source''|http://github.com/TiddlySpace/tiddlyspace|
|''CodeRepository''|http://github.com/TiddlySpace/tiddlyspace|
|''License''|[[BSD|http://www.opensource.org/licenses/bsd-license.php]]|
|''CoreVersion''|2.6.0|
|''Requires''|TiddlyWebAdaptor TiddlySpaceRevisionView|
!Usage
Add a control button to revert to a particular revision.

The button must be called from within a revision, as generated by TiddlySpaceRevisionView
!Code
***/
//{{{
(function($) {

config.commands.revert = {
    text: "revert",
    tooltip: "make this revision the current one",
    handler: function(ev, src, title) {
        var revElem = story.getTiddler(title);
        var tidToRevert = store.getTiddler($(revElem).attr("revName"));

        var revision = store.getTiddler(title);
        if ((revision) &amp;&amp; (tidToRevert)) {
            tidToRevert.text = revision.text;
            var newFields = merge({}, revision.fields);
            for (var fieldName in newFields) {
                if (fieldName.substr(0, 7) === "server.") {
                    delete newFields[fieldName];
                }
            }
            merge(tidToRevert.fields, newFields);
            tidToRevert.tags = merge([], revision.tags);
            tidToRevert.fields.changecount = 1;
            delete tidToRevert.fields.doNotSave;

            store.saveTiddler(tidToRevert.title, tidToRevert.title,
                tidToRevert.text, null, null, tidToRevert.tags,
                tidToRevert.fields, false, tidToRevert.created, tidToRevert.creator);

            autoSaveChanges(true);
        }
    }
};

})(jQuery);
//}}}</pre>
</div>

<div title="saveTiddler">
<pre>&lt;svg xmlns="http://www.w3.org/2000/svg" xmlns:xl="http://www.w3.org/1999/xlink" version="1.1" viewBox="2 724 68 55" 
width="30" height="30"&gt;
&lt;g stroke="none" stroke-opacity="1" stroke-dasharray="none" fill="none" fill-opacity="1"&gt;
    &lt;g&gt;
        &lt;path d="M 2.25 756 L 11.25 747 L 24.75 760.4994 L 60.750004 724.4994 L 69.75 733.49902 
        L 24.749977 778.49976 Z" fill="#101010" class="glyph"/&gt;
    &lt;/g&gt;
&lt;/g&gt;
&lt;/svg&gt;</pre>
</div>

<div title="日志">
<pre> 日志
&lt;html&gt;
&lt;head&gt;
      &lt;title&gt;第一个HTML代码&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div align="center"&gt;
&lt;img src="http://p0.so.qhmsg.com/t01d02acc2127458705.jpg" hight="300" width="300" &gt;&lt;br/&gt;
&lt;/div&gt;
&lt;hr width="800" color="pink" size"10"/&gt;

&lt;/body&gt;
&lt;/html&gt;
</pre>
</div>

<div title="setDefaultTiddlers">
<pre>Once you have some content then you may choose to determine a tiddler, or set of tiddlers to display each time you load ~TiddlySpace. This is determined by the [[DefaultTiddlers]].</pre>
</div>

<div title="_space">
<pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta http-equiv="Content-Type" content="text/html;charset=utf-8"&gt;
    &lt;title&gt;This Space&lt;/title&gt;
    &lt;link href="/bags/common/tiddlers/profile.css" type='text/css' rel='stylesheet' &gt;
    &lt;link href="/bags/common/tiddlers/admin.css" type='text/css' rel='stylesheet' &gt;
    &lt;!--[if lte IE 8]&gt;
    &lt;script type="text/javascript" src="/bags/common/tiddlers/json2.js"&gt;&lt;/script&gt;
    &lt;script type="text/javascript" src="/bags/common/tiddlers/es5-shim.min.js"&gt;&lt;/script&gt;
    &lt;![endif]--&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div id="container"&gt;
    &lt;div id="text-html" class="main section"&gt;
        &lt;a class="app" href="/"&gt;home&lt;/a&gt;
        &lt;div class="left"&gt;
        &lt;h2&gt;About this space &lt;button class='toggleNext'&gt;&lt;/button&gt;&lt;/h2&gt;
        &lt;div id="siteinfo"&gt;&lt;/div&gt;
        &lt;h2&gt;Site Icon&lt;/h2&gt;
        &lt;div&gt;
            &lt;img id="siteicon" class="siteicon"&gt;
            &lt;form id="upload" method="POST" enctype="multipart/form-data"&gt;
                &lt;input type="hidden" name="title" value="SiteIcon" /&gt;
                &lt;input type="hidden" name="tags" value="excludeLists"&gt;
                &lt;input type="hidden" name="csrf_token" class="csrf" /&gt;
                &lt;input type="file" name="file" accept="image/*" /&gt;
                &lt;input class="btn" type="submit" value="upload" /&gt;
            &lt;/form&gt;
            &lt;div id="dropzone"&gt;Drop file here
                &lt;img class="notloading" src="/bags/common/tiddlers/ajax-loader.gif" alt="submitting SiteIcon" /&gt;
            &lt;/div&gt;
        &lt;/div&gt;
        &lt;h2&gt;Vital Statistics&lt;/h2&gt;
        &lt;div id="info"&gt;please wait while information is loaded about this space...&lt;/div&gt;
        &lt;button class="spacereset"&gt;Reset Space&lt;/button&gt;
        &lt;div class="reset-confirm-wrap messageArea"&gt;
            &lt;button class="close-btn" title="cancel reset"&gt;×&lt;/button&gt;
            &lt;p&gt;Are you sure you want to reset the space? You can't go back! This will remove all the content from the space!&lt;/p&gt;
            &lt;form class="cf"&gt;
                &lt;label for="reset-confirm"&gt;Enter the space name to confirm.&lt;/label&gt;
                &lt;input type="text" name="reset-confirm" class="reset-confirm-input inputBox" /&gt;
                &lt;button type="submit"&gt;Reset Now&lt;/button&gt;
            &lt;/form&gt;
            &lt;div class="reset-message-area"&gt;
                &lt;p class="performing"&gt;Resetting...&lt;/p&gt;
                &lt;p class="finished"&gt;Reset Done!&lt;/p&gt;
                &lt;p class="recipe-error-msg"&gt;Error removing includes. Please remove manually.&lt;/p&gt;
            &lt;/div&gt;
        &lt;/div&gt;
        &lt;/div&gt;
        &lt;div class="right"&gt;
        &lt;div class="ts-membership"&gt;
            &lt;h2&gt;
                Add Member
                &lt;a href="http://docs.tiddlyspace.com/What%20is%20a%20member%3F" title="What is a Member?" class="help"&gt;What is a Member?&lt;/a&gt;
            &lt;/h2&gt;
            &lt;div&gt;
                &lt;p&gt;Add a new member to your space by entering their name below. Enter a space name instead and prefix with @ to add everyone who is already a member of that space.&lt;/p&gt;
                &lt;form class="ts-members"&gt;
                    &lt;input class="inputBox" type="text" name="username"&gt;
                    &lt;input type="submit" value="Add Member" class="btn" /&gt;
                &lt;/form&gt;
            &lt;/div&gt;
            &lt;h2&gt;
                Existing Members &lt;button class='toggleNext'&gt;&lt;/button&gt;
            &lt;/h2&gt;
            &lt;div&gt;
                Your space currently has the following members: 
                &lt;ul class="ts-members"&gt;&lt;/ul&gt;
            &lt;/div&gt;
            &lt;h2&gt;
                Include Space
                &lt;a class="help" href="http://docs.tiddlyspace.com/What%20is%20space%20inclusion%3F" title="What is inclusion?"&gt;What is Inclusion?&lt;/a&gt;
            &lt;/h2&gt;
            &lt;form class="ts-includes"&gt;
                &lt;input class="inputBox" type="text" name="spacename"&gt;
                &lt;input type="submit" value="Include Space" class="btn" /&gt;
            &lt;/form&gt;
        &lt;/div&gt;
        &lt;div&gt;
            &lt;h2&gt;Included Spaces &lt;button class='toggleNext'&gt;&lt;/button&gt;&lt;/h2&gt;
            &lt;div&gt;
            This space includes the following spaces:
            &lt;ul class="ts-includes"&gt;&lt;/ul&gt;
            &lt;/div&gt;
        &lt;/div&gt;
        &lt;/div&gt;
        &lt;div class="clear"&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;
&lt;script src='/bags/common/tiddlers/backstage.js'&gt;&lt;/script&gt;
&lt;script src='/bags/common/tiddlers/jquery.js'&gt;&lt;/script&gt;
&lt;script src='/bags/tiddlyspace/tiddlers/chrjs'&gt;&lt;/script&gt;
&lt;script src='/bags/common/tiddlers/chrjs.space'&gt;&lt;/script&gt;
&lt;script src='/bags/common/tiddlers/chrjs.users'&gt;&lt;/script&gt;
&lt;script src='/bags/common/tiddlers/chrjs.identities'&gt;&lt;/script&gt;
&lt;script src='/bags/tiddlyspace/tiddlers/TiddlySpaceCSRF'&gt;&lt;/script&gt;
&lt;script src='/bags/common/tiddlers/jquery-form.js'&gt;&lt;/script&gt;
&lt;script src="/bags/common/tiddlers/siteiconupload.js"&gt;&lt;/script&gt;
&lt;script src="/bags/common/tiddlers/ts.js"&gt;&lt;/script&gt;
&lt;script src="/status.js"&gt;&lt;/script&gt;
&lt;script src="/bags/common/tiddlers/space.js"&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
</div>

<div title="robots">
<pre>User-agent: *
Disallow: /bags
Disallow: /recipes</pre>
</div>

<div title="ErrorHandler">
<pre>/***
|''Name''|ErrorHandlerPlugin|
|''Version''|0.4.3|
|''Author''|Jon Robson|
|''Description''|Localised tiddler save errors including edit conflict resolution.|
|''CoreVersion''|2.6.1|
|''Requires''|TiddlySpaceConfig|
***/
//{{{
(function($) {

var tiddlyspace = config.extensions.tiddlyspace;
var currentSpace = tiddlyspace.currentSpace.name;
tiddlyspace.getLocalTitle = function(title, workspace, suffix) {
    var endsWith = config.extensions.BinaryTiddlersPlugin.endsWith;
    if(!suffix) {
        var isPublic = endsWith(workspace, "_public");
        suffix = tiddlyspace.resolveSpaceName(workspace);
        if(currentSpace == suffix) {
            suffix = isPublic ? "public" : "private";
        } else {
            suffix = "@%0".format(suffix);
        }
    }
    return "%0 *(%1)*".format(title, suffix);
};

var sssp = config.extensions.ServerSideSavingPlugin;

var msgs = config.messages.editConflict = {
    loading: "Loading..",
    resolve: "[[Edit Conflict]]@glossary: this tiddler may have been changed by someone else.",
    reviewDiff: "review (recommended)",
    reviewDiffTooltip: "review changes made to this tiddler",
    reviewDiffError: "error retrieving revision.",
    save: "overwrite",
    saveTooltip: "make this revision the top revision of this tiddler",
    discard: "cancel",
    discardTooltip: "undo changes to this tiddler and get most recent version",
    diffTitle: "%0",
    diffFieldTitle: "%0 - fields",
    diffTextTitle: "%0 - text",
    updating: "updating your version...",
    diffHeader: ["Review the changes that have been made whilst you were editing this tiddler. ",
        "Fold relevant changes back into your version.\n",
        "{{removed{Red}}} highlight shows content removed. ",
        "{{added{Green}}} highlight shows content added.\n"].join(""),
    diffTextHeader: "View changes in text",
    diffFieldsHeader: "View changes in fields"
};

var plugin = config.extensions.errorHandler = {
    diffTags: ["excludeLists", "excludeMissing", "excludeSearch"],
    displayMessage: function(message, tiddler, context) {
        var desc = context &amp;&amp; context.httpStatus ? context.statusText :
            sssp.locale.connectionError;
        var reportArea = plugin.reportError(tiddler.title);
        var msg = $("&lt;div /&gt;").appendTo(reportArea);
        if(message == "saveConflict") {
            wikify(msgs.resolve, msg[0]);
            var choiceArea = $("&lt;div /&gt;").appendTo(reportArea)[0];
            plugin.editConflictHandler(choiceArea, tiddler);
        } else {
            msg.text(sssp.locale[message].format(tiddler.title, desc));
        }
    },
    editConflictHandler: function(container, tiddler) {
        var title = tiddler.title;
        var myrev = tiddler.fields["server.page.revision"];
        // note user now needs to edit, fix problem and save. 
        // TODO: make sure this gets reset in save callback
        store.getTiddler(title).fields["server.page.revision"] = "false";

        var diffBtn = createTiddlyButton(container, msgs.reviewDiff, msgs.reviewDiffTooltip, function(ev) {
            var title = $(ev.target).data("title");
            plugin.displayDiff(ev.target, store.getTiddler(title), myrev);
        });
        var saveBtn = createTiddlyButton(container, msgs.save, msgs.saveTooltip, function(ev) {
                var title = $(ev.target).data("title");
                var tid = store.saveTiddler(store.getTiddler(title));
                autoSaveChanges(null, [tid]);
            });
        var ignoreBtn = createTiddlyButton(container, msgs.discard, msgs.discardTooltip, function(ev) {
            var title = $(ev.target).text(msgs.updating).data("title");
            plugin.resetToServerVersion(store.getTiddler(title));
        });
        $([diffBtn, ignoreBtn, saveBtn]).data("title", title);
    },
    getDiffTiddlerTexts: function(diffText) {
        var chunks = diffText.split("\n  \n");
        if(chunks.length &lt; 2) {
            return [chunks[0], ""];
        } else {
            var diffFieldsText = "{{diff{\n%0\n}}}".format(chunks[0]);
            diffText = '{{diff{\n%0\n}}}'.format(chunks.splice(1, chunks.length).join("\n"));
            return [diffText, diffFieldsText];
        }
    },
    makeDiffTiddler: function(title, diff) {
        var newTiddler = new Tiddler(title);
        var tags = plugin.diffTags;
        newTiddler.text = msgs.loading;
        newTiddler.fields.doNotSave = true;
        newTiddler.tags = diff ? tags.concat(["diff"]) : tags;
        newTiddler = store.saveTiddler(newTiddler);
        $.extend(store.getTiddler(title).fields,
            config.defaultCustomFields); // allow option to save it
        return newTiddler;
    },
    displayDiff: function(src, tiddler, latestRevision) {
        var adaptor = tiddler.getAdaptor();
        var title = tiddler.title;
        var ts = new Date().formatString("0hh:0mm:0ss");
        var suffix = "edit conflict %0".format(ts);
        var diffTitle = tiddlyspace.getLocalTitle(msgs.diffTitle.format(title), "", suffix);
        var diffTextTitle = tiddlyspace.getLocalTitle(msgs.diffTextTitle.format(title), "", suffix);
        var diffFieldsTitle = tiddlyspace.getLocalTitle(msgs.diffFieldTitle.format(title), "", suffix);
        plugin.makeDiffTiddler(diffTextTitle, true);
        plugin.makeDiffTiddler(diffFieldsTitle, true);
        var newTiddler = plugin.makeDiffTiddler(diffTitle, false);
        newTiddler.text = ['%0\n&lt;&lt;slider chkViewDiffText "%1" "%2"&gt;&gt;\n',
            '&lt;&lt;slider chkViewDiffField "%3" "%4"&gt;&gt;'].join("").
            format(msgs.diffHeader, diffTextTitle, msgs.diffTextHeader,
                diffFieldsTitle, msgs.diffFieldsHeader);
        store.saveTiddler(newTiddler);

        var callback = function(r) {
            var text = plugin.getDiffTiddlerTexts(r);
            store.getTiddler(diffTextTitle).text = text[0];
            store.getTiddler(diffFieldsTitle).text = text[1];
            story.refreshTiddler(diffTitle, null, true);
        };
        var workspace = "bags/%0".format(tiddler.fields["server.bag"]);
        ajaxReq({
            type: "get",
            dataType: "text",
            url: "/diff?format=unified&amp;rev1=%0/%1/%2&amp;rev2=%0/%1".format(workspace, title, latestRevision),
            success: callback,
            error: function() {
                displayMessage(msgs.reviewDiffError);
            }
        });
        story.displayTiddler(src, diffTitle);
    },
    resetToServerVersion: function(tiddler) {
        var adaptor = tiddler.getAdaptor();
        var ctx = { 
            host: tiddler.fields["server.host"],
            workspace: "bags/" + tiddler.fields["server.bag"]
        };
        adaptor.getTiddler(tiddler.title, ctx, null, function(context) {
            store.saveTiddler(context.tiddler);
            story.refreshTiddler(tiddler.title);
            store.setDirty(false);
        });
    },
    reportError: function(title) {
        var el = story.getTiddler(title);
        if(!el) {
            el = story.displayTiddler(null, title);
        }
        return $("&lt;div /&gt;").addClass("error annotation").prependTo(el)[0];
    }
};

sssp.reportFailure = function(message, tiddler, context) {
    config.options.chkViewDiffText = config.options.chkViewDiffText === undefined ?
        true : config.options.chkViewDiffText;
    config.options.chkViewDiffFields = config.options.chkViewDiffFields || false;
    plugin.displayMessage(message, tiddler, context);
};

})(jQuery);
//}}}</pre>
</div>

<div title="写作">
<pre>  

</pre>
</div>

<div title="TiddlySpaceTiddlerIconsPlugin">
<pre>/***
|''Name''|TiddlySpaceTiddlerIconsPlugin|
|''Version''|0.8.10|
|''Status''|@@beta@@|
|''Author''|Jon Robson|
|''Description''|Provides ability to render SiteIcons and icons that correspond to the home location of given tiddlers|
|''Source''|http://github.com/TiddlySpace/tiddlyspace/raw/master/src/plugins/TiddlySpaceTiddlerIconsPlugin.js|
|''Requires''|TiddlySpaceConfig BinaryTiddlersPlugin ImageMacroPlugin TiddlySpacePublishingCommands|
!Notes
{{{&lt;&lt;tiddlerOrigin&gt;&gt;}}} shows the origin of the tiddler it is being run on.
In TiddlySpace terms this means it will determine whether the tiddler is external, public or private.
Where private it will analyse whether a public version exists and distinguish between the different scenarios.
If a tiddler is external, the SiteIcon of that external space will be shown

!Parameters
width / height : define a width or height of the outputted icon
label: if label parameter is set to yes, a label will accompany the icon.
!Code
***/
//{{{
(function($) {

if(!config.macros.image) {
    throw "Missing dependency: ImageMacroPlugin";
}

var imageMacro = config.macros.image;
var tiddlyspace = config.extensions.tiddlyspace;
var tweb = config.extensions.tiddlyweb;
var cmds = config.commands;
var cmd = cmds.publishTiddler;
tiddlyspace.resolveSpaceName = function(value) {
    var endsWith = config.extensions.BinaryTiddlersPlugin.endsWith;
    if(value) {
        value = value.indexOf("bags/") === 0 ? value.substr(5) : value;
        value = value.indexOf("recipes/") === 0 ? value.substr(8) : value;
        if(value.indexOf("@") === 0) {
            value = value.substr(1);
        }
        if(endsWith(value, "_public")) {
            value = value.substr(0, value.length - 7);
        } else if(endsWith(value, "_private")) {
            value = value.substr(0, value.length - 8);
        }
        value = value.toLowerCase();
    }
    return value;
};

tiddlyspace.renderAvatar = function(place, value, options) {
    options = options ? options : {};
    options.labelOptions = options.labelOptions ? options.labelOptions : { include: false, height: 48, width: 48 };
    options.imageOptions = options.imageOptions ? options.imageOptions : {};
    options.imageOptions.altImage = "/bags/common/tiddlers/defaultUserIcon";
    var container = $('&lt;div class="siteIcon" /&gt;').appendTo(place);
    value = tiddlyspace.resolveSpaceName(value);

    tweb.getStatus(function(status) {
        var link, noLabel;
        if(!value || value == config.views.wikified.defaultModifier ||
            value == config.views.wikified.shadowModifier) {
            var icon = config.views.wikified.shadowModifier == value ? "shadowIcon" : "missingIcon";
            if(store.tiddlerExists(icon)) {
                imageMacro.renderImage(container, icon, options.imageOptions);
            } else {
                noLabel = true;
            }
        } else {
            var spaceURI;
            if(value != tiddlyspace.currentSpace.name) {
                spaceURI = options.notSpace ? tiddlyspace.getHost(status.server_host) :
                    tiddlyspace.getHost(status.server_host, value);
            }
            link = spaceURI ? $("&lt;a /&gt;").attr("href", spaceURI) : $("&lt;span /&gt;");
            link.text(value);

            var imageOptions = options.imageOptions;
            if(options.spaceLink &amp;&amp; !imageOptions.link) {
                imageOptions.link = spaceURI;
            }
            var avatar = options.notSpace ? false : value;
            var uri = tiddlyspace.getAvatar(status.server_host, avatar);
            imageMacro.renderImage(container, uri, options.imageOptions);
            if(!value) {
                value = "tiddlyspace";
            }
        }
        if(!noLabel &amp;&amp; options.labelOptions.include) {
            var prefix = $("&lt;span /&gt;").text(options.labelOptions.prefix || "")[0];
            var suffix = $("&lt;span /&gt;").text(options.labelOptions.suffix || "")[0];
            $('&lt;div class="label" /&gt;').append(prefix).append(link).
                append(suffix).appendTo(container);
        }
    });
    if(value) {
        var prefix = options.labelOptions.prefix || "";
        var suffix = options.labelOptions.suffix || "";
        var label = "%0%1%2".format(prefix, value, suffix);
        $(container).attr("title", label);
    }
};

var originMacro = config.macros.tiddlerOrigin = {
    locale: {
        "shadow": "shadow tiddler",
        "missing": "missing tiddler",
        "private": "private",
        "unknown": "unknown state",
        "public": "public",
        "unsyncedPrivate": "unsynced and private",
        "unsyncedPublic": "unsynced and public",
        externalPrefix: "from ",
        externalBagSuffix: " bag",
        externalSuffix: " space",
        publishPrivateDeletePrivate: "Are you sure you want to make this tiddler public?",
        moveToPrivate: "Are you sure you want to make this tiddler private? Only members will be able to see it.",
        pleaseWait: "please wait..",
        keepPublic: "keep public",
        cannotPublishDirtyTiddler: "The current tiddler is unsaved so cannot be published. Please save the tiddler first.",
        keepPrivate: "keep private",
        makePublic: "make public",
        makePrivate: "make private"
    },
    handler: function(place, macroName, params,wikifier, paramString, tiddler){
        var adaptor = tiddler.getAdaptor();
        var btn = $("&lt;div /&gt;").addClass("originButton").attr("params", paramString).
            attr("refresh", "macro").attr("macroName", macroName).appendTo(place)[0];
        $(btn).data("tiddler", tiddler);
        originMacro.refresh(btn);
    },
    refresh: function(btn) {
        $(btn).empty();
        var paramString = $(btn).attr("params");
        var tiddler = $(btn).data("tiddler");
        var options = originMacro.getOptions(paramString);
        var type = tiddlyspace.getTiddlerStatusType(tiddler);
        originMacro.renderIcon(tiddler, type, btn, options);
    },
    getOptions: function(paramString) {
        paramString = "%0 label:no width:48 height:48 spaceLink:yes preserveAspectRatio:yes".format(paramString);
        var parsedParams = paramString.parseParams("name");
        var params = parsedParams[0].name;
        var options = {
            labelOptions: originMacro._getLabelOptions(parsedParams),
            imageOptions: imageMacro.getArguments(paramString, []),
            noclick: parsedParams[0].interactive &amp;&amp;
                parsedParams[0].interactive[0] == "no" ? true : false
        };
        if(!options.noclick) {
            var spaceLink = parsedParams[0].spaceLink;
            options.spaceLink = spaceLink &amp;&amp; spaceLink[0] == "no" ? false : true;
        } else {
            options.spaceLink = false;
        }
        return options;
    },
    _getLabelOptions: function(parsedParams) {
        parsedParams = parsedParams[0];
        var includeLabel = !parsedParams.label || ( parsedParams.label &amp;&amp; parsedParams.label[0] == "yes" );
        var prefix = parsedParams.labelPrefix ? parsedParams.labelPrefix[0] : false;
        var suffix = parsedParams.labelSuffix ? parsedParams.labelSuffix[0] : false;
        return { include: includeLabel, suffix: suffix, prefix: prefix };
    },
    _isSpace: function(value) {
        value = value ? value : "";
        var endsWith = config.extensions.BinaryTiddlersPlugin.endsWith;
        if(endsWith(value, "_private") || endsWith(value, "_public")) {
            return true;
        } else {
            return false;
        }
    },
    renderIcon: function(tiddler, type, button, options) {
        var locale = originMacro.locale;
        originMacro.annotateTiddler(button, type);
        if(type != "external") {
            originMacro.showPrivacyRoundel(tiddler, type, button,
                options);
        } else {
            var prefix = options.labelOptions.prefix, suffix = options.labelOptions.suffix;
            var space = tiddler.fields["server.bag"];
            options.notSpace = !originMacro._isSpace(space);
            options.labelOptions.prefix = prefix ? prefix : locale.externalPrefix;
            options.labelOptions.suffix = suffix ? suffix : (options.notSpace ? locale.externalBagSuffix : locale.externalSuffix);

            tiddlyspace.renderAvatar(button, space, options);
        }
    },
    showPrivacyRoundel: function(thisTiddler, privacyType, button, options) {
        // there is a public tiddler as well as the current tiddler!
        // TODO: not this is not enough.. we also need to check if the public tiddler is the same as..
        // .. the private tiddler to determine whether this is a draft
        // use of hashes would be useful here.
        $(button).empty();
        var icon = "%0Icon".format(privacyType);
        if(privacyType.indexOf("unsynced") === 0 &amp;&amp; !store.tiddlerExists(icon)) {
            icon = "unsyncedIcon";
        }
        if(privacyType == "shadow") {
            if(!store.tiddlerExists(icon)) {
                icon = "bags/tiddlyspace/tiddlers/SiteIcon";
            }
        }
        if(privacyType == "missing" &amp;&amp; !store.tiddlerExists(icon)) {
            return; // the user is not making use of the missingIcon
        } else {
            imageMacro.renderImage(button, icon, options.imageOptions);
            originMacro.showLabel(button, privacyType, options.labelOptions);
            var cmd = originMacro.iconCommands[privacyType];
            if(cmd &amp;&amp; thisTiddler &amp;&amp; !options.noclick) {
                $(button).click(function(ev) {
                    cmd(ev, thisTiddler);
                });
            }
        }
    },
    annotateTiddler: function(place, type) {
        var tidEl = $(story.findContainingTiddler(place));
        tidEl.
            removeClass("private public external privateAndPublic privateNotPublic shadow").
            addClass(type);
    },
    showLabel: function(button, type, options) {
        var locale = originMacro.locale;
        var label = options.label ? options.label : locale[type];
        label = label ? label : locale.unknown;
        if(options &amp;&amp; options.include) {
            $('&lt;div class="roundelLabel" /&gt;').html(label).appendTo(button);
        }
        $(button).attr("title", label);
    },
    confirm: function(ev, msg, onYes, options) {
        options = options ? options : {};
        onYes = onYes ? onYes : function(ev) {};
        var btn = $(".originButton", $(ev.target).parents())[0];
        var popup = Popup.create(btn);
        $(popup).addClass("confirmationPopup");
        $("&lt;div /&gt;").addClass("message").text(msg).appendTo(popup);
        $("&lt;button /&gt;").addClass("button").text(options.yesLabel || "yes").appendTo(popup).click(onYes);
        $("&lt;button /&gt;").addClass("button").text(options.noLabel || "no").click(function(ev) {
            Popup.remove();
        }).appendTo(popup);
        Popup.show();
        ev.stopPropagation();
        return false;
    },
    alert: function(ev, msg) {
        var popup = Popup.create(ev.target);
        $(popup).addClass("confirmationPopup alert");
        $("&lt;div /&gt;").addClass("message").text(msg).appendTo(popup);
        Popup.show();
        ev.stopPropagation();
    },
    reportDirty: function(el) {
        originMacro.alert(el, originMacro.locale.cannotPublishDirtyTiddler);
    },
    iconCommands: {
        "public": function(ev, tiddler) {
            if(!readOnly) {
                var locale = originMacro.locale;
                var msg = locale.moveToPrivate;
                if(story.isDirty(tiddler.title)) {
                    originMacro.reportDirty(ev);
                } else {
                    originMacro.confirm(ev, msg, function(ev) {
                        var target = $(ev.target);
                        var onComplete = function(info) {};
                        var privateBag = cmd.toggleBag(tiddler, "private");
                        cmd.moveTiddler(tiddler, {
                            title: tiddler.title,
                            fields: { "server.bag": privateBag }
                        }, onComplete);
                    }, { yesLabel: locale.makePrivate, noLabel: locale.keepPublic });
                }
            }
        },
        "private": function(ev, tiddler) {
            if(!readOnly) {
                var locale = originMacro.locale;
                var adaptor = tiddler.getAdaptor();
                var publishTo = tiddler.fields["publish.name"] || tiddler.title;
                var workspace = "bags/%0".format(tiddler.fields["server.bag"]);
                tiddler.fields["server.workspace"] = workspace;
                var publicBag = cmd.toggleBag(tiddler, "public");
                var msg;
                msg = locale.publishPrivateDeletePrivate;
                var title = tiddler.title;
                var newTitle = publishTo || tiddler.title;
                tiddler.fields["server.page.revision"] = "false";
                store.addTiddler(tiddler);
                if(story.isDirty(tiddler.title)) {
                    originMacro.reportDirty(ev);
                } else {
                    originMacro.confirm(ev, msg, function(ev) {
                        var onComplete = function(info) {};
                        cmd.moveTiddler(tiddler, {
                            title: newTitle,
                            fields: { "server.bag": publicBag }
                        }, onComplete);
                    }, { yesLabel: locale.makePublic, noLabel: locale.keepPrivate });
                }
            }
        }
    }
};

})(jQuery);
//}}}</pre>
</div>

<div title="ServerSideSavingPlugin">
<pre>/***
|''Name''|ServerSideSavingPlugin|
|''Description''|server-side saving|
|''Author''|FND|
|''Version''|0.6.5|
|''Status''|stable|
|''Source''|http://svn.tiddlywiki.org/Trunk/association/plugins/ServerSideSavingPlugin.js|
|''License''|[[BSD|http://www.opensource.org/licenses/bsd-license.php]]|
|''CoreVersion''|2.5.3|
|''Keywords''|serverSide|
!Notes
This plugin relies on a dedicated adaptor to be present.
The specific nature of this plugin depends on the respective server.
!Revision History
!!v0.1 (2008-11-24)
* initial release
!!v0.2 (2008-12-01)
* added support for local saving
!!v0.3 (2008-12-03)
* added Save to Web macro for manual synchronization
!!v0.4 (2009-01-15)
* removed ServerConfig dependency by detecting server type from the respective tiddlers
!!v0.5 (2009-08-25)
* raised CoreVersion to 2.5.3 to take advantage of core fixes
!!v0.6 (2010-04-21)
* added notification about cross-domain restrictions to ImportTiddlers
!To Do
* conflict detection/resolution
* rename to ServerLinkPlugin?
* document deletion/renaming convention
!Code
***/
//{{{
(function($) {

readOnly = false; //# enable editing over HTTP

var plugin = config.extensions.ServerSideSavingPlugin = {};

plugin.locale = {
    saved: "%0 saved successfully",
    saveError: "Error saving %0: %1",
    saveConflict: "Error saving %0: edit conflict",
    deleted: "Removed %0",
    deleteError: "Error removing %0: %1",
    deleteLocalError: "Error removing %0 locally",
    removedNotice: "This tiddler has been deleted.",
    connectionError: "connection could not be established",
    hostError: "Unable to import from this location due to cross-domain restrictions."
};

plugin.sync = function(tiddlers) {
    tiddlers = tiddlers &amp;&amp; tiddlers[0] ? tiddlers : store.getTiddlers();
    $.each(tiddlers, function(i, tiddler) {
        var changecount = parseInt(tiddler.fields.changecount, 10);
        if(tiddler.fields.deleted === "true" &amp;&amp; changecount === 1) {
            plugin.removeTiddler(tiddler);
        } else if(tiddler.isTouched() &amp;&amp; !tiddler.doNotSave() &amp;&amp;
                tiddler.getServerType() &amp;&amp; tiddler.fields["server.host"]) { // XXX: server.host could be empty string
            delete tiddler.fields.deleted;
            plugin.saveTiddler(tiddler);
        }
    });
};

plugin.saveTiddler = function(tiddler) {
    try {
        var adaptor = this.getTiddlerServerAdaptor(tiddler);
    } catch(ex) {
        return false;
    }
    var context = {
        tiddler: tiddler,
        changecount: tiddler.fields.changecount,
        workspace: tiddler.fields["server.workspace"]
    };
    var serverTitle = tiddler.fields["server.title"]; // indicates renames
    if(!serverTitle) {
        tiddler.fields["server.title"] = tiddler.title;
    } else if(tiddler.title != serverTitle) {
        return adaptor.moveTiddler({ title: serverTitle },
            { title: tiddler.title }, context, null, this.saveTiddlerCallback);
    }
    var req = adaptor.putTiddler(tiddler, context, {}, this.saveTiddlerCallback);
    return req ? tiddler : false;
};

plugin.saveTiddlerCallback = function(context, userParams) {
    var tiddler = context.tiddler;
    if(context.status) {
        if(tiddler.fields.changecount == context.changecount) { //# check for changes since save was triggered
            tiddler.clearChangeCount();
        } else if(tiddler.fields.changecount &gt; 0) {
            tiddler.fields.changecount -= context.changecount;
        }
        plugin.reportSuccess("saved", tiddler);
        store.setDirty(false);
    } else {
        if(context.httpStatus == 412) {
            plugin.reportFailure("saveConflict", tiddler);
        } else {
            plugin.reportFailure("saveError", tiddler, context);
        }
    }
};

plugin.removeTiddler = function(tiddler) {
    try {
        var adaptor = this.getTiddlerServerAdaptor(tiddler);
    } catch(ex) {
        return false;
    }
    var context = {
        host: tiddler.fields["server.host"],
        workspace: tiddler.fields["server.workspace"],
        tiddler: tiddler
    };
    var req = adaptor.deleteTiddler(tiddler, context, {}, this.removeTiddlerCallback);
    return req ? tiddler : false;
};

plugin.removeTiddlerCallback = function(context, userParams) {
    var tiddler = context.tiddler;
    if(context.status) {
        if(tiddler.fields.deleted === "true") {
            store.deleteTiddler(tiddler.title);
        } else {
            plugin.reportFailure("deleteLocalError", tiddler);
        }
        plugin.reportSuccess("deleted", tiddler);
        store.setDirty(false);
    } else {
        plugin.reportFailure("deleteError", tiddler, context);
    }
};

plugin.getTiddlerServerAdaptor = function(tiddler) { // XXX: rename?
    var type = tiddler.fields["server.type"] || config.defaultCustomFields["server.type"];
    return new config.adaptors[type]();
};

plugin.reportSuccess = function(msg, tiddler) {
    displayMessage(plugin.locale[msg].format([tiddler.title]));
};

plugin.reportFailure = function(msg, tiddler, context) {
    var desc = (context &amp;&amp; context.httpStatus) ? context.statusText :
        plugin.locale.connectionError;
    displayMessage(plugin.locale[msg].format([tiddler.title, desc]));
};

config.macros.saveToWeb = { // XXX: hijack existing sync macro?
    locale: { // TODO: merge with plugin.locale?
        btnLabel: "save to web",
        btnTooltip: "synchronize changes",
        btnAccessKey: null
    },

    handler: function(place, macroName, params, wikifier, paramString, tiddler) {
        createTiddlyButton(place, this.locale.btnLabel, this.locale.btnTooltip,
            plugin.sync, null, null, this.locale.btnAccessKey);
    }
};

// hijack saveChanges to trigger remote saving
var _saveChanges = saveChanges;
saveChanges = function(onlyIfDirty, tiddlers) {
    if(window.location.protocol == "file:") {
        _saveChanges.apply(this, arguments);
    } else {
        plugin.sync(tiddlers);
    }
};

// override removeTiddler to flag tiddler as deleted -- XXX: use hijack to preserve compatibility?
TiddlyWiki.prototype.removeTiddler = function(title) { // XXX: should override deleteTiddler instance method?
    var tiddler = this.fetchTiddler(title);
    if(tiddler) {
        tiddler.tags = ["excludeLists", "excludeSearch", "excludeMissing"];
        tiddler.text = plugin.locale.removedNotice;
        tiddler.fields.deleted = "true"; // XXX: rename to removed/tiddlerRemoved?
        tiddler.fields.changecount = "1";
        this.notify(title, true);
        this.setDirty(true);
    }
};

// hijack ImportTiddlers wizard to handle cross-domain restrictions
var _onOpen = config.macros.importTiddlers.onOpen;
config.macros.importTiddlers.onOpen = function(ev) {
    var btn = $(resolveTarget(ev));
    var url = btn.closest(".wizard").find("input[name=txtPath]").val();
    if(window.location.protocol != "file:" &amp;&amp; url.indexOf("://") != -1) {
        var host = url.split("/")[2];
        var macro = config.macros.importTiddlers;
        if(host != window.location.host) {
            btn.text(macro.cancelLabel).attr("title", macro.cancelPrompt);
            btn[0].onclick = macro.onCancel;
            $('&lt;span class="status" /&gt;').text(plugin.locale.hostError).insertAfter(btn);
            return false;
        }
    }
    return _onOpen.apply(this, arguments);
};

})(jQuery);
//}}}</pre>
</div>

<div title="GroupByPlugin">
<pre>/***
|''Name''|GroupByPlugin|
|''Description''|Mimics allTags macro to provide ways of creating lists grouping tiddlers by any field|
|''Version''|0.6.1|
|''Author''|Jon Robson|
|''Status''|beta|
!Usage
{{{&lt;&lt;groupBy tags&gt;&gt;}}}
mimics allTags macro

{{{&lt;&lt;groupBy server.bag&gt;&gt;}}}
groups by the server.bag field (this version contains TiddlySpace specific code for turning a bag into a space name)

{{{groupBy modified dateFormat:"YYYY"}}}
group tiddlers by year.

{{{&lt;&lt;groupBy tags exclude:excludeLists exclude:systemConfig&gt;&gt;}}}
group tiddlers by tag but exclude the tags with values excludeLists and systemConfig

Within that group you can also exclude things by filter
{{{groupBy modifier filter:[tag[film]]}}}
will group tiddlers tagged with film by modifier.
***/
//{{{
(function($) {
var taglocale = config.views.wikified.tag;
var macro = config.macros.groupBy = {
    locale: {
        tooltip: "all tiddlers in group %0",
        noTiddlers: "no tiddlers",
        openAllText: taglocale.openAllText,
        openAllTooltip: taglocale.openAllTooltip,
        openTiddler: "open tiddler with title %0"
    },
    morpher: {
        // TODO: note currently the following 2 morphers are TiddlySpace specific and probably should be in separate plugin
        "server.workspace": function(value, options) {
            return macro.morpher["server.bag"](value.replace("bags/", "").replace("recipes/", ""));
        },
        "server.bag": function(value, options) {
            if(typeof(value) !== "string") {
                return false;
            } else if(value.indexOf("_public") === -1 &amp;&amp; value.indexOf("_private") === -1) {
                value = "*%0".format(value); // add star for non-space bags.
            }
            return value.replace("_public", "").replace("_private", "");
        },
        created: function(value, options) {
            return value.formatString(options.dateFormat || "DD MMM YYYY");
        },
        modified: function(value, options) {
            return macro.morpher.created(value, options);
        }
    },

    handler: function(place, macroName, params, wikifier, paramString) {
        var field = params[0] || "server.workspace";
        var dateFormat = params[1] || "DD MMM YYYY";
        var container = $("&lt;div /&gt;").attr("macroName", macroName).addClass("groupBy").
            attr("refresh", "macro").attr("fieldName", field).
            attr("paramString", paramString).
            attr("dateFormat", dateFormat).appendTo(place)[0];
        macro.refresh(container);
    },
    isTypeArray: function(value) {
        var valueType = typeof value;
        if(valueType === "object" &amp;&amp; typeof value.length === "number" &amp;&amp;
            !(value.propertyIsEnumerable("length")) &amp;&amp;
            typeof value.splice === "function") { //is Array
            return true;
        } else {
            return false;
        }
    },
    _onClickGroup: function(ev, options) {
        var i, target = ev.target, locale = macro.locale;
        var tiddlers = $(target).closest(".templateContainer").data("tiddlers");
        var popup = $(Popup.create(target)).addClass("taggedTiddlerList")[0];
        var value = $(target).attr("value");
        var openAll = createTiddlyButton($("&lt;li /&gt;").appendTo(popup)[0],
            locale.openAllText.format(value), locale.openAllTooltip);
        $(openAll).click(function(ev) {
            story.displayTiddlers(ev.target, tiddlers);
            return false;
        });
        var listBreak = $("&lt;li /&gt;").addClass("listBreak").html("&lt;div /&gt;").appendTo(popup);
        for(i = 0; i &lt; tiddlers.length; i++) {
            var item = $("&lt;li /&gt;").appendTo(popup)[0];
            var template = store.getTiddlerText(options.template) || macro.template;
            wikify(template, item, null, tiddlers[i]);
        }
        listBreak.clone().appendTo(popup);
        $(createTiddlyLink($("&lt;li /&gt;").appendTo(popup)[0], value, false)).
            text(locale.openTiddler.format(value));
        Popup.show();
        ev.stopPropagation();
        return false;
    },
    _refresh: function(container, tiddlers, options) {
        var totalGroups = 0, locale = macro.locale, i, j;
        var excludeValues = options.exclude;
        var values = {}, value_ids = [];
        var field = options.field;
        var morpher = macro.morpher[field] || function(value) {
            return value;
        };
        for(i = 0; i &lt; tiddlers.length; i++) {
            var tiddler = tiddlers[i];
            var value = tiddler[field] || tiddler.fields[field];
            value = macro.isTypeArray(value) ? value : [ value ];
            for(j = 0; j &lt; value.length; j++) {
                var v = morpher(value[j], options);
                if(v &amp;&amp; $.inArray(v, excludeValues) === -1) {
                    totalGroups += 1;
                    if(!values[v]) {
                        values[v] = [];
                    }
                    values[v].push(tiddler);
                    value_ids.pushUnique(v);
                }
            }
        }
        var ul = $("&lt;ul /&gt;").appendTo(container)[0];
        if(totalGroups === 0) {
            $("&lt;li /&gt;").addClass("listTitle").text(locale.noTiddlers);
        }
        value_ids = value_ids.sort();
        var groupTemplate = store.getTiddlerText(options.groupTemplate);
        var onClick = function(ev) {
            macro._onClickGroup(ev, options);
        };
        for(i = 0; i &lt; value_ids.length; i++) {
            var title = value_ids[i];
            var info = getTiddlyLinkInfo(title);
            tiddlers = values[title];
            var btn = createTiddlyButton($("&lt;li /&gt;").appendTo(ul)[0],
                "%0 (%1)".format(title, tiddlers.length), locale.tooltip.format(title), null, info.classes);
            if(groupTemplate) {
                $(btn).empty();
                wikify(groupTemplate, btn, null, tiddlers[0]);
            }
            $(btn).click(onClick).attr("value", title).attr("refresh", "link").attr("tiddlyLink", title);
            $(btn).addClass("templateContainer").data("tiddlers", tiddlers);
        }
    },
    refresh: function(container) {
        container = $(container).empty();
        var paramString = container.attr("paramString");
        var args = paramString.parseParams("name", null, true, false, true)[0];
        var options = { field: container.attr("fieldName"), dateFormat: container.attr("dateFormat"), exclude: args.exclude || [],
            template: args.template ? args.template[0] : false, groupTemplate: args.groupTemplate ? args.groupTemplate[0] : "" };
        var tiddlers = args.filter ? store.filterTiddlers(args.filter[0]) : store.getTiddlers("title");
        macro._refresh(container, tiddlers, options);
    },
    template: "&lt;&lt;view title link&gt;&gt;"
};

}(jQuery));
//}}}</pre>
</div>

<div title="TiddlySpaceViewTypes">
<pre>/***
|''Name''|TiddlySpaceViewTypes|
|''Version''|0.6.0|
|''Status''|@@beta@@|
|''Description''|Provides TiddlySpace specific view types|
|''Author''|Jon Robson|
|''Source''|http://github.com/TiddlySpace/tiddlyspace/raw/master/src/plugins/TiddlySpaceViewTypes.js|
|''Requires''|TiddlySpaceConfig TiddlySpaceTiddlerIconsPlugin|
!Usage
Provides replyLink, spaceLink and SiteIcon view types.
!!SiteIcon view parameters
* labelPrefix / labelSuffix : prefix or suffix the label with additional text. eg. labelPrefix:'modified by '
* spaceLink: if set to "yes" will make any avatars link to the corresponding space. {{{&lt;&lt;originMacro spaceLink:yes&gt;&gt;}}}

!Code
***/
//{{{
(function($) {

var tiddlyspace = config.extensions.tiddlyspace;
var originMacro = config.macros.tiddlerOrigin;
var tweb = config.extensions.tiddlyweb;

config.macros.view.replyLink = {
    locale: {
        label: "Reply to this tiddler"
    }
};

var _replyButtons = [];
var _replyInitialised, _replyScriptLoaded;
config.macros.view.views.replyLink = function(value, place, params, wikifier,
        paramString, tiddler) {
    var valueField = params[0];
    var imported;
    if(valueField == "title") { // special casing for imported tiddlers
        var localTitle = tiddler.title;
        var serverTitle = tiddler.fields["server.title"];
        if(serverTitle &amp;&amp; localTitle != serverTitle) {
            value = serverTitle ? serverTitle : localTitle;
            imported = true;
        }
    } else {
        title = tiddler[valueField] ? tiddler[valueField] : tiddler.fields[valueField];
    }
    var args = paramString.parseParams("anon")[0];
    var label = (args.label) ? args.label : config.macros.view.replyLink.locale.label;
    var space;
    if(tiddler) {
        var bag = tiddler.fields["server.bag"];
        space = tiddlyspace.resolveSpaceName(bag);
    }
    var container = $('&lt;span class="replyLink" /&gt;').appendTo(place)[0];

    tweb.getUserInfo(function(user) {
        if ((!user.anon) &amp;&amp; ((space &amp;&amp; user.name != space &amp;&amp;
                user.name != tiddlyspace.currentSpace.name) || imported)) {
            var link = $("&lt;a /&gt;")
                .text(config.macros.view.replyLink.locale.label)
                .appendTo(container)[0];

            if(typeof(createReplyButton) === "undefined") {
                _replyButtons.push(link);
            }
            if(_replyInitialised) {
                createReplyButton(link);
            } else if(!_replyScriptLoaded) {
                _replyScriptLoaded = true;
                $.getScript("/bags/common/tiddlers/_reply-button.js",
                    function() {
                        _replyInitialised = true;
                        for(var i = 0; i &lt; _replyButtons.length; i++) {
                            createReplyButton(_replyButtons[i]);
                        }
                        _replyButtons = [];
                    });
            }
        }
    });

};

config.macros.view.views.spaceLink = function(value, place, params, wikifier,
        paramString, tiddler) {
        var spaceName = tiddlyspace.resolveSpaceName(value);
        var isBag = params[0] == "server.bag" &amp;&amp; value === spaceName ? true : false;
        var args = paramString.parseParams("anon")[0];
        var titleField = args.anon[2];
        var labelField = args.labelField ? args.labelField[0] : false;
        var label;
        if(labelField) {
            label = tiddler[labelField] ? tiddler[labelField] : tiddler.fields[labelField];
        } else {
            label = args.label ? args.label[0] : false;
        }
        var title = tiddler[titleField] ? tiddler[titleField] : tiddler.fields[titleField];

        var link = createSpaceLink(place, spaceName, title, label, isBag);
        if(args.external &amp;&amp; args.external[0] == "no") {
            $(link).click(function(ev) {
                var el = $(ev.target);
                var title = el.attr("tiddler");
                var bag = el.attr("bag");
                var space = el.attr("tiddlyspace");
                bag = space ? space + "_public" : bag;
                if(title &amp;&amp; bag) {
                    ev.preventDefault();
                    tiddlyspace.displayServerTiddler(el[0], title,
                        "bags/" + bag);
                }
                return false;
            });
        }
};

config.macros.view.views.SiteIcon = function(value, place, params, wikifier,
        paramString, tiddler) {
    var options = originMacro.getOptions(paramString);
    if(!tiddler || value == "None") { // some core tiddlers lack modifier
        value = false;
    }
    var field = params[0];
    if(field == "server.bag") {
        options.notSpace = !originMacro._isSpace(value);
    }
    tiddlyspace.renderAvatar(place, value, options);
};

})(jQuery);
//}}}</pre>
</div>

<div title="DiffFormatter">
<pre>/***
|''Name''|DiffFormatter|
|''Description''|highlighting of text comparisons|
|''Author''|FND|
|''Version''|0.9.0|
|''Status''|beta|
|''Source''|http://svn.tiddlywiki.org/Trunk/contributors/FND/formatters/DiffFormatter.js|
|''CodeRepository''|http://svn.tiddlywiki.org/Trunk/contributors/FND/|
|''License''|[[BSD|http://www.opensource.org/licenses/bsd-license.php]]|
|''Keywords''|formatting|
!Description
Highlights changes in a unified [[diff|http://en.wikipedia.org/wiki/Diff#Unified_format]].
!Notes
Based on Martin Budden's [[DiffFormatterPlugin|http://svn.tiddlywiki.org/Trunk/contributors/MartinBudden/formatters/DiffFormatterPlugin.js]].
!Usage
The formatter is applied to blocks wrapped in &lt;html&gt;&lt;code&gt;{{{diff{..}}}&lt;/code&gt;&lt;/html&gt; within tiddlers tagged with "diff".
!Revision History
!!v0.9 (2010-04-07)
* initial release; fork of DiffFormatterPlugin
!StyleSheet
.diff { white-space: pre; font-family: monospace; }
.diff ins, .diff del { display: block; text-decoration: none; }
.diff ins { background-color: #dfd; }
.diff del { background-color: #fdd; }
.diff .highlight { background-color: [[ColorPalette::SecondaryPale]]; }
!Code
***/
//{{{
(function() {

config.shadowTiddlers.StyleSheetDiffFormatter = store.getTiddlerText(tiddler.title + "##StyleSheet");
store.addNotification("StyleSheetDiffFormatter", refreshStyles);

var formatters = [{
        name: "diffWrapper",
        match: "^\\{\\{diff\\{\n", // XXX: suboptimal
        termRegExp: /(.*\}\}\})$/mg,
        handler: function(w) {
            var el = createTiddlyElement(w.output, "div", null, "diff");
            w.subWikifyTerm(el, this.termRegExp);
        }
    }, {
        name: "diffRange",
        match: "^(?:@@|[+\\-]{3}) ",
        lookaheadRegExp: /^(?:@@|[+\-]{3}) .*\n/mg,
        handler: function(w) {
            createTiddlyElement(w.output, "div", null, "highlight").
                innerHTML = "&amp;#8230;";
            this.lookaheadRegExp.lastIndex = w.matchStart;
            var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
            if(lookaheadMatch &amp;&amp; lookaheadMatch.index == w.matchStart) {
                w.nextMatch = this.lookaheadRegExp.lastIndex;
            }
        }
    }, {
        name: "diffAdded",
        match: "^\\+",
        termRegExp: /(\n)/mg,
        handler: function(w) {
            var el = createTiddlyElement(w.output, "ins", null, "added");
            w.subWikifyTerm(el, this.termRegExp);
        }
    }, {
        name: "diffRemoved",
        match: "^-",
        termRegExp: /(\n)/mg,
        handler: function(w) {
            var el = createTiddlyElement(w.output, "del", null, "removed");
            w.subWikifyTerm(el, this.termRegExp);
        }
    }
];

config.parsers.diffFormatter = new Formatter(formatters);
config.parsers.diffFormatter.format = "diff";
config.parsers.diffFormatter.formatTag = "diff";

})();
//}}}</pre>
</div>

<div title="saveDraft">
<pre>&lt;svg xmlns="http://www.w3.org/2000/svg" xmlns:xl="http://www.w3.org/1999/xlink" version="1.1" viewBox="364 157 64 51" width="30" height="30"&gt;&lt;g stroke="none" stroke-opacity="1" stroke-dasharray="none" fill="none" fill-opacity="1"&gt;&lt;g&gt;&lt;path class="glyph" d="M 364.50006 184.50061 L 386.99985 207.00037 L 396 198.00002 L 373.50003 175.50066 Z M 403.02295 181.97704 C 400.38693 179.34099 396.11307 179.34099 393.47702 181.97704 C 390.841 184.61307 390.841 188.88695 393.47702 191.52298 C 396.11307 194.15903 400.38693 194.15903 403.02295 191.52298 C 405.65906 188.88695 405.65906 184.61307 403.02295 181.97704 M 414.27298 170.72704 C 411.63693 168.091 407.36307 168.091 404.72702 170.72704 C 402.091 173.36308 402.091 177.63693 404.72702 180.27296 C 407.36307 182.90901 411.63693 182.90901 414.27298 180.27296 C 416.90903 177.63693 416.90903 173.36308 414.27298 170.72704 M 425.523 159.47705 C 422.88696 156.841 418.6131 156.841 415.97705 159.47705 C 413.341 162.11308 413.341 166.38695 415.97705 169.02295 C 418.6131 171.65903 422.88696 171.65903 425.523 169.02295 C 428.15906 166.38695 428.15906 162.11308 425.523 159.47705" fill="#020202"/&gt;&lt;/g&gt;&lt;/g&gt;&lt;/svg&gt;</pre>
</div>

<div title="TiddlySpaceCloneCommand">
<pre>/***
|''Name''|TiddlySpaceCloneCommand|
|''Version''|0.5.8|
|''Description''|provides a toolbar command for cloning external tiddlers|
|''Status''|stable|
|''Source''|http://github.com/TiddlySpace/tiddlyspace/raw/master/src/plugins/TiddlySpaceCloneCommand.js|
|''Requires''|TiddlySpaceConfig TiddlySpaceFilters|
!Code
***/
//{{{
(function($) {

var cmd = config.commands;
var tiddlyspace = config.extensions.tiddlyspace;

var fieldsCache = {};

cmd.cloneTiddler = {
    text: cmd.editTiddler.text,
    tooltip: "Create a copy of this tiddler in the current space",
    errorMsg: "Error publishing %0: %1",

    isEnabled: function(tiddler) {
        return !config.filterHelpers.is.local(tiddler) &amp;&amp; !readOnly;
    },
    handler: function(ev, src, title) {
        var tiddler = store.getTiddler(title);
        if(tiddler) {
            fieldsCache[title] = $.extend({}, tiddler.fields);
            tiddler.fields["server.workspace"] = tiddlyspace.getCurrentWorkspace(config.options.chkPrivateMode ?
        "private" : "public");
            tiddler.fields["server.permissions"] = "read, write, create"; // no delete
            delete tiddler.fields["server.page.revision"];
            delete tiddler.fields["server.title"];
            delete tiddler.fields["server.etag"];
            // special handling for pseudo-shadow tiddlers
            if(tiddlyspace.coreBags.contains(tiddler.fields["server.bag"])) {
                tiddler.tags.remove("excludeLists");
            }
        } else { // ensure workspace is the current space
            var el = story.findContainingTiddler(src);
            el = $(el);
            var fields = el.attr("tiddlyfields");
            if(fields) { // inherited via TiddlyLink
                fields = fields.decodeHashMap();
                fields["server.workspace"] = config.
                    defaultCustomFields["server.workspace"];
            } else {
                fields = config.defaultCustomFields;
            }
            fields = String.encodeHashMap(fields);
            el.attr("tiddlyfields", fields);
        }
        cmd.editTiddler.handler.apply(this, arguments);
        if(tiddler) {
            tiddler.fields["server.permissions"] += ", delete";
        }
        return false;
    }
};

cmd.editTiddler.isEnabled = function(tiddler) {
    return !cmd.cloneTiddler.isEnabled.apply(this, arguments);
};

// hijack cancelTiddler to restore original fields
var _cancelHandler = cmd.cancelTiddler.handler;
cmd.cancelTiddler.handler = function(ev, src, title) {
    var tiddler = store.getTiddler(title);
    if(tiddler) {
        tiddler.fields = fieldsCache[title] || tiddler.fields;
        delete fieldsCache[title];
    }
    return _cancelHandler.apply(this, arguments);
};

// hijack saveTiddler to clear unused fields stash
var _saveHandler = cmd.saveTiddler.handler;
cmd.saveTiddler.handler =  function(ev, src, title) {
    delete fieldsCache[title];
    return _saveHandler.apply(this, arguments);
};

})(jQuery);
//}}}</pre>
</div>

<div title="SideBarTabs">
<pre>&lt;&lt;tiddler Backstage##Tiddlers&gt;&gt;</pre>
</div>

<p></p>
</div>





















<p>
</p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
